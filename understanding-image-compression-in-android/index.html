<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title>
   Understanding Image compression in Android
  </title>
  <meta charset="utf-8"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="minimum-scale=1,initial-scale=1,width=device-width,shrink-to-fit=no" name="viewport"/>
  <link href="https://blog.mindorks.com/understanding-image-compression-in-android" rel="canonical"/>
  <meta content="986249072156-dabps0lf90smluddrk5rkqsdjghk3hd3.apps.googleusercontent.com" name="google-signin-client_id"/>
  <meta content="android, learn android app development, android app development courses, android blogs, android tutorial" name="keywords"/>
  <meta content="Understanding Image compression in Android" property="og:title"/>
  <meta content="website" property="og:type"/>
  <meta content="https://blog.mindorks.com/understanding-image-compression-in-android" property="og:url"/>
  <meta content="/images/understanding-image-compression-in-android-banner-2f58a1f66e7aab48.png" property="og:image"/>
  <meta content="In this blog, we will understand how image compression works in Android. We will see the working of PNG, Vector Drawables, JPEG and WebP. So, let's learn image compression in Android." property="og:description"/>
  <meta content="Understanding Image compression in Android" property="twitter:title"/>
  <meta content="In this blog, we will understand how image compression works in Android. We will see the working of PNG, Vector Drawables, JPEG and WebP. So, let's learn image compression in Android." name="twitter:description"/>
  <meta content="/images/understanding-image-compression-in-android-banner-2f58a1f66e7aab48.png" name="twitter:image:src"/>
  <meta content="summary_large_image" name="twitter:card"/>
  <meta content="@MindorksNextGen" name="twitter:site"/>
  <meta content="In this blog, we will understand how image compression works in Android. We will see the working of PNG, Vector Drawables, JPEG and WebP. So, let's learn image compression in Android." name="description"/>
  <meta content="1620001391374687" property="fb:app_id"/>
  <link href="/styles/vendor-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link href="/styles/app-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link as="style" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" onload='this.onload=null,this.rel="stylesheet"' rel="preload"/>
  <noscript>
   <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
  </noscript>
  <script type="text/javascript">
   window.__PRELOADED_STATE__={toastr:{toastrs:[],confirm:null},blogData:{data:{},latestBlogs:null,isFetching:!0,isFetchingLatestBlogs:!1,currentCategory:"",categories:[]},contactData:{formData:{email:"",name:"",phone:"",message:"",isWriting:!1,isNameError:!1,isEmailError:!1,isPhoneError:!1,isMessageError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSending:!1},communityData:{formData:{email:"",isEmailError:!1,isWriting:!1,isSending:!1,dismissMsg:!1},successMessage:null,errorMessage:null},blogPageData:{blogId:366,data:{id:366,title:"Understanding Image compression in Android",description:"In this blog, we will understand how image compression works in Android. We will see the working of PNG, Vector Drawables, JPEG and WebP. So, let's learn image compression in Android.",text:'<h1 class="graf--h1">Understanding Image compression in Android</h1> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/understanding-image-compression-in-android-banner-2f58a1f66e7aab48.png class=\'graf-image\' alt=\'Understanding Image compression in Android\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">Images play an important role in any application. It helps in conveying our message in a better way. But it comes with some cons also. It increases the APK size. You might have noticed that the applications dealing with images(either the local image or downloaded from the internet) are bigger in size and also we know that lesser the application size more the number of downloads. So, if we reduce the size of the images used in the application then eventually the APK size will be reduced.</p><p class="graf--p">This is the topic for today&#x27;s blog. Today, we will understand image compression so that in future if you are planning to use some images in your app then you can just follow this blog and use the most suitable image format to reduce the APK size.</p><p class="graf--p">We will be covering the below points in this blog:</p><ul><li>Why Image Compression?</li><li>PNG image</li><li>Vector image</li><li>JPEG image</li><li>WebP</li><li>Important tip</li><li>Closing notes</li></ul><p class="graf--p">So, let&#x27;s get started.</p><h4 class="graf--h3">Why Image Compression?</h4><p class="graf--p">Images are the best way to convey our message to our users. We can convey the information through images in a much much better way as compared to texts.</p><blockquote class="graf--blockquote"><b class="graf--bold">Images are cool.</b></blockquote><p class="graf--p">But the problem with images is that images can be easily bloated. Images can be too big or can have too many pixels or resolutions and this, in turn, reduce your application&#x27;s performance. For example, if your app is loading an image of 5MB over a 2G network, and it is taking time, then you might end up losing one user of your application. Not only that it will take more data to download the image and also it will drain the battery. So, it is always very important to make sure that the images used in your application are compressed to give a better experience to your users.</p><p class="graf--p">In Android, we generally deal with the below four image types:</p><ol type="1"><li>PNG</li><li>Vector Drawable</li><li>JPG</li><li>WebP</li></ol><p class="graf--p">Let&#x27;s have a look at these image formats and how it works internally.</p><h4 class="graf--h3">PNG</h4><p class="graf--p">PNG or Portable Network  Graphics is the most commonly used image file in Android these days. They provide a nice and high-resolution image format. But due to this, we need to apply some image compression techniques also. PNG compressions are lossless i.e. you can get back your original image from the compressed one i.e. no loss of color is there. Each row of pixels in a PNG image is taken and processed one at a time. The whole PNG compression process can be divided into two processes:</p><ol type="1"><li><b class="graf--bold">Filtering:</b> Here in this process, we will keep the value at each pixel and find the difference of value at one pixel with the value of the next or previous or up or down of a pixel. So, the main idea is to get the minimum difference possible. Less the difference, similar will be the color and larger will be the compression. For example, if an image contains only red color then the compression will be easier because only one color is there. All the pixels have the same color.</li><li><b class="graf--bold">Deflate: </b>The output of the filtering process is put into an encoding system called <b class="graf--bold">deflate</b>. Here, we use two algorithms named <b class="graf--bold"><i class="graf--italic">LZ77</i></b> and <b class="graf--bold"><i class="graf--italic">Huffman encoder</i></b>. LZ77 is a dictionary algorithm that finds the duplicate characters multiple times in a stream of data. The output of this LZ77 is then fed into the Huffman encoder which is almost identical to compressors like PKWARE, GZip, etc. The output of the deflate is then sent to the disk.</li></ol><p class="graf--p">To summarize the above two process, we can say that if the image is having lesser color combinations then more compression can be done because the pixel difference will be around 0. But if the image is having a number of color combinations then compression is difficult.</p><p class="graf--p">In Android, the AAPT tool does the above thing on PNG images for us. But there are demerits of using it also. So, lets first learn what AAPT does for us:</p><ol type="1"><li>It analyses the PNG file to check if the image is having only white and black color i.e. greyscale or the image is having combination of different colors<b class="graf--bold">.</b></li><li>It checks if the image is having some transparency channel or the image is opaque. If your image is opaque then it will remove that channel and as a result of that, your image size will be reduced.</li><li>It finds the total number of colors used in the image. If it is less than or equal to 256, then it decreases the size of image.</li></ol><p class="graf--p">The demerits of AAPT lies in the above three points. Let&#x27;s have one example:</p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/understanding-image-compression-in-android-256-colour-example.jpg class=\'graf-image\' alt=\'Understanding Image compression in Android\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">In the image above, three colors are present(blue, yellow, and white). But the AAPT is trying to get values for the 256 unique colors and after doing so, the final size of the image is 500KB. But if we reduce the colors then there is no effect on the image quality but there is a drastic change in the image size. For example, having 128 colors result in 125KB image and 8 colors result in 124B image. </p><p class="graf--p">So, what you need to do is first optimize your PNG(you can use PNGQuant, TinyPNG, PNGOut, etc for this) and then use it in your application. But in order to do so, you must disable the AAPT tools for your application because AAPT is unaware of the fact that you have done the compression already. So, to disable AAPT, you can use the below code in Gradle:</p><pre><code class="language-java graf graf--code">aaptOptions {\n    cruncherEnabled = False\n}</code></pre><p class="graf--p">After that, you have to make sure that all the images that you are using are fully compressed because now there is no AAPT for image compression.</p><h4 class="graf--h3">Vector Drawable</h4><p class="graf--p">As we all know that PNG files are raster files in nature. So, if you are making an application for different device sizes then you have to use different resolution size images for different devices(for mdpi, hdpi, xhdpi, etc we need different images) and this, in turn, increases your application size. So, we are having many copies of the same image which is not a good thing. </p><p class="graf--p">What if one image can be used in all the devices with different resolutions? Yeah, we can do this with the help of Vector Drawables.</p><p class="graf--p">Vector Drawable is a concept of drawing images with code. The benefit of using this is we can use the same drawable image for different resolution devices and this, in turn, reduces the APK size because we are using only one image for all the devices. What we do here is we write the code for the image, execute that or rasterize those to a bitmap in CPU memory and then we upload that in the GPU and finally the image is drawn on the screen of the device. By doing so, you will get a much smaller image file but it takes time in the rasterization process.</p><p class="graf--p">To convert your PNG image into vector drawable, you can either write the whole code for it or can use a tool named <b class="graf--bold">POTrace</b>. But be very careful before using images that are generated from POTrace because it is just an automated tool. So, you will not get the desired image all the time. But if possible, then code the vector image and you will get the desired results every time.</p><h4 class="graf--h3">JPG</h4><p class="graf--p">Till now we have seen PNGs and Vector Drawables and now its time for the JPEGs i.e. the big images. So, whenever we want to use a good quality image, we tend to use JPEGs and this is the reason why we are concerned about the compression of the JPEGs.</p><p class="graf--p">In JPG compression, we convert our source RGB image to some separate colorspace. As human eyes tend to see more differences in RGBs, than in the YCbCr colorspace, so we create different colorspace. Then we reduce the size of CB and CR channels and apply the discrete Cosine Transform. So, what it does is it converts or represents any signals as a sum of cosine. The output of this cosine transform is run into a quantization phase which quantize the output of cosine transform to integers and after that the statistical encoding is done which may be Huffman or arithmetic or any other encoding and finally, you get the JPG file. Phew, so many steps :(</p><p class="graf--p">There is one another option that is available with JPEG images i.e. you can choose how much to compress an image. For that, you can use <b class="graf--bold">Butteraugli</b>.</p><blockquote class="graf--blockquote">Butteraugli is a project that estimates the psychovisual similarity of two images. It gives a score for the images that is reliable in the domain of barely noticeable differences. Butteraugli not only gives a scalar score, but also computes a spatial map of the level of differences.</blockquote><p class="graf--p">It is just a way to take a source image and compress the image to find how the human eye sees the difference between various qualities of the image. So, if you want to compress your image and at the same time you want to know how much you can compress an image so that the human eye can&#x27;t notice a change, then you can use Butteraugli for this. Want to use a high-resolution image? Cool, use Butteraugli to find the percentage up to which you can compress your image and then compress that image. That&#x27;s it. At the same time, if the quality of the image is not a concern for you then you can further compress your image to get a smaller image file.</p><p class="graf--p">Like the PNG image compression, for JPEG images there are many tools available for compression like JPEGMini, MozJPEG, cJPEG, packJPG, etc.</p><h4 class="graf--h3">WebP</h4><p class="graf--p">In WebP image format, we can do both lossless and lossy compression. The lossless images of WebP are almost 26% smaller than that of PNGs. While the lossy images are 25-34% smaller than that of JPEGs file.</p><p class="graf--p">The lossy WebP uses predictive coding to encode an image. So, to predict the value in a pixel, WebP uses the values present in the neighbouring blocks and then encodes the difference only.</p><p class="graf--p">While the lossless WebP compression uses image fragments that are already seen to reconstruct new pixel. If no match is found, then it uses a local palette.</p><h4 class="graf--h3">Important tip</h4><p class="graf--p">So, we have seen all the image compression that we come across daily. If you are going to use some image in your application then you should first go for the Vector drawable. If vector drawable is there with you, then use it. If you are not having vector drawable and if you have the support of WebP then go for WebP. If you can&#x27;t support WebP and if you need transparency support, use PNG. If you do not need transparency support, then try to find if the image is simple or complex. If it is simple then stick with PNG otherwise if it is complex then go with JPG.</p><p class="graf--p">Image Source: Google I/O</p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/understanding-image-compression-in-android-image-type-selection.png class=\'graf-image\' alt=\'Understanding Image compression in Android\' />\n\t\t\t\t\t\t\t\t</div ><h4 class="graf--h3">Closing notes</h4><p class="graf--p">In this blog, we learned various techniques used for image compressions like PNG, JPEG, Vector Drawable and WebP. We also saw how to decide which image format should we use in our application. But remember one thing, before using any type of image compression, do research to find who are your users, what do they want? Perform good research on that because in some cases JPEGs can be better than PNGs and vice-versa.</p><p class="graf--p"><b class="graf--bold">Reference:</b> Google I/O 2016</p><p class="graf--p">Hope you learned something new today.</p><p class="graf--p">Do share this blog with your fellow developers to spread the knowledge. You can read more blogs on Android on our <a class="markup--anchor" target="_blank" href="https://blog.mindorks.com/">blogging website</a>.</p><p class="graf--p">Happy Learning :)</p><p class="graf--p"><b class="graf--bold">Team MindOrks!</b></p><p class="graf--p"><b class="graf--bold">Also, Let’s connect on</b> <b class="graf--bold"><span class=""><a class="markup--anchor" target="_blank" href="https://twitter.com/hiii_sumit">Twitter</a></span>,</b> <b class="graf--bold"><span class=""><a class="markup--anchor" target="_blank" href="https://www.linkedin.com/in/mishra3452/">Linkedin</a></span>,</b> <b class="graf--bold"><span class=""><a class="markup--anchor" target="_blank" href="https://github.com/mishra3452">Github</a></span>, and</b> <b class="graf--bold"><span class=""><a class="markup--anchor" target="_blank" href="https://www.facebook.com/mishra3452">Facebook</a></span></b></p>',author:17146,img_url:"/images/understanding-image-compression-in-android-banner-2f58a1f66e7aab48.png",blog_url:"understanding-image-compression-in-android",likes:0,rank:0,category:1,published_at:"19th October 2019"},author:{id:17146,name:"Sumit Mishra",google_profile_pic:"https://lh3.googleusercontent.com/a-/AOh14GiHP4JrkmlLjuz_uG1g4E0MhTUClSNytqB8o-pxCA=s96-c?sz=300",fb_profile_pic:null,profile_tagline:"Software Development Engineer at MindOrks",fb_profile_url:"https://www.facebook.com/mishra3452",google_plus_profile_url:null,twitter_profile_url:"https://twitter.com/hiii_sumit",github_profile_url:"https://github.com/mishra3452",linkedin_profile_url:"https://www.linkedin.com/in/sumit-mishra-a15499135/"},isFetching:!1,similarBlogs:[{id:245,title:"Downloading and Showing Image with Glide Library in Android",description:"In this blog, we will learn how to use Glide for downloading and showing images in our Android application. Basically, Glide library downloads the image and store it into your cache or local memory and uses it when needed in future.",author:14897,img_url:"/images/download-show-image-glide-banner.png",blog_url:"downloading-and-showing-image-with-glide-library-in-android",likes:0,rank:0,category:1,published_at:"19th May 2019",score:2.0165717601776123},{id:216,title:"Understanding Density Independence Pixel: sp, dp, dip in Android",description:"What is the best measurement unit for designing for Android Screen? Density Independent Pixel, Scaled Independent Pixels, Density Pixels or Pixels.",author:7037,img_url:"/images/understanding_density_independent_pixel.jpg",blog_url:"understanding-density-independent-pixel-sp-dp-dip-in-android",likes:0,rank:0,category:1,published_at:"31st January 2019",score:.5386013984680176},{id:231,title:"Understanding and Implementing Permission in Android Q",description:"In this blog, we will understand the new privacy-based location permission in Android Q and how to implement it in your app.",author:14897,img_url:"/images/location-permission.png",blog_url:"location-permissions-in-android-q",likes:0,rank:0,category:1,published_at:"11th May 2019",score:.5386013984680176},{id:233,title:"Understanding Settings Panels in Android Q",description:"In this blog, we will understand the new setting panel which released in Android Q. With Google launching Android Q, Lot of exciting features has also popped up. One amazing feature is Location Service usage and few more.",author:14897,img_url:"/images/android-setting.png",blog_url:"understanding-settings-panel-in-android-q",likes:0,rank:0,category:1,published_at:"14th May 2019",score:.5386013984680176},{id:243,title:"Understanding Multidex in Android",description:"In this blog, we will learn how to use Multidex in Android. Basically, Multidex is used when we want to add more than 64K methods in our Android project. If we don't use any Multidex for the project having more than 64K methods, then we will encounter DEX error. So, in this blog, we will learn how to use Multidex.",author:14897,img_url:"/images/understanding-multidex-banner-img.png",blog_url:"understanding-multidex-in-android",likes:0,rank:0,category:1,published_at:"18th May 2019",score:.5386013984680176},{id:263,title:"Understanding the Application Lifecycle in Android",description:"In this blog, we will learn about the Application life cycle in Android. We will learn how to make use of various application states that a particular application has in general. ",author:14897,img_url:"/images/understanding-the-application-lifecycle-in-android-banner.png",blog_url:"understanding-the-application-lifecycle-in-android",likes:0,rank:0,category:1,published_at:"4th June 2019",score:.5386013984680176}],isSimilarBlogsFetching:!1},loginData:{data:null,isLoggingIn:!1,isLoggingOut:!1,loginState:!1,isForcedLogout:!1,isTokenRefreshed:!1,isRedirectHome:!1,message:""},updatesData:{news:null,inspirations:null,isNewsFetching:!0,isInspirationsFetching:!0},blogEditorData:{blogId:null,blogDetailsFormData:{title:"",description:"",imgUrl:"",blogUrl:"",category:"",categories:[],isWriting:!1,isTitleError:!1,isDescriptionError:!1,isImgUrlError:!1,isBlogUrlError:!1,isCategoryError:!1,isUploadingImage:!1,uploadedImageUrl:null},editorState:null,editorText:null,successMessage:null,errorMessage:null,isSending:!1,isMsgToShow:!1,isPublished:!1,isSubmitted:!1,isDraft:!0,isEditOfExistingBlog:!1,isFetchingBlogCategories:!1,isUploadingImage:!1,uploadedImageUrl:null},myBlogsData:{data:null,isSubmittedBlogsFetching:!0,isDraftBlogsFetching:!0,isPublishedBlogsFetching:!0,successMessage:null,errorMessage:null,isMsgToShow:!1,tabNames:["drafts","submissions","published"],selectedTab:"drafts",isFetchingBlog:!1,isDeletingBlog:!1,openEditorPage:!1},profilePreviewData:{profile:null,blogs:null,isFetchingProfile:!1,isFetchingAuthorBlogs:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,isUserNotRegistered:!1,redirectToMyProfileEdit:!1},profileEditableData:{userId:null,name:null,fbProfilePicUrl:null,googleProfilePicUrl:null,profileFormData:{tagline:"",fbProfileUrl:"",googlePlusProfileUrl:"",twitterProfileUrl:"",githubProfileUrl:"",linkedinProfileUrl:"",isWriting:!1,isTaglineError:!1,isFbProfileUrlError:!1,isGooglePlusProfileUrlError:!1,isTwitterProfileUrlError:!1,isGithubProfileUrlError:!1,isLinkedinProfileUrlError:!1},isSavingProfile:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,redirectToProfilePreview:!1},submitBlogData:{formData:{email:"",name:"",link:"",isWriting:!1,isNameError:!1,isEmailError:!1,isLinkError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSubmitting:!1},advertisementsData:{data:{},isLoading:!1},recaptchaData:{verified:!1,successMessage:null,errorMessage:null},blogSearchData:{searches:null,isSearching:!1}}
  </script>
  <script async="" src="https://www.google-analytics.com/analytics.js" type="text/javascript">
  </script>
  <script type="text/javascript">
   window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-91686131-1","auto"),ga("require","cleanUrlTracker"),ga("require","eventTracker"),ga("require","impressionTracker"),ga("require","outboundLinkTracker"),ga("require","urlChangeTracker"),ga("require","maxScrollTracker"),ga("require","mediaQueryTracker"),ga("require","outboundFormTracker"),ga("require","outboundLinkTracker"),ga("require","pageVisibilityTracker"),ga("require","socialWidgetTracker"),ga("require","urlChangeTracker"),ga("send","pageview")
  </script>
  <script defer="defer" src="/assets/autotrack.js" type="text/javascript">
  </script>
  <script src="/assets/highlight.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/vendor-bundle-1.8.6.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/app-bundle-1.8.6.js" type="text/javascript">
  </script>
 </head>
 <body>
  <div id="root">
   <div class="screen app-load-content" data-reactroot="">
    <div class="ui centered grid">
     <div class="row" style="padding:0">
      <div class="ui fixed menu navbar huge borderless grid" style="background-color:#fff;height:60px">
      </div>
     </div>
     <div class="centered computer only row" style="padding:0">
      <div class="ui fixed top menu navbar huge borderless grid header-container" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="right menu">
        <a class="item" href="https://janisharali.com" target="_blank">
         Mentor Ali
        </a>
        <a class="item" href="https://amitshekhar.me" target="_blank">
         Mentor Amit
        </a>
       </div>
      </div>
     </div>
     <div class="tablet only mobile only row" style="padding:0">
      <div class="ui fixed top navbar huge menu borderless" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="item">
       </div>
      </div>
     </div>
    </div>
    <div class="header-height">
    </div>
    <div aria-live="assertive" class="redux-toastr">
     <div>
      <div class="top-left">
      </div>
      <div class="top-right">
      </div>
      <div class="top-center">
      </div>
      <div class="bottom-left">
      </div>
      <div class="bottom-right">
      </div>
      <div class="bottom-center">
      </div>
     </div>
    </div>
    <div class="content-container theme">
     <div class="ui centered one column grid" style="padding-bottom:80px;background-color:#fff">
      <div class="ten wide computer fifteen wide mobile fifteen wide tablet column" style="margin-top:50px">
       <div>
        <div class="blog-page-author">
         <div class="ui small header">
          <img alt="Sumit Mishra" class="ui circular image" src="https://lh3.googleusercontent.com/a-/AOh14GiHP4JrkmlLjuz_uG1g4E0MhTUClSNytqB8o-pxCA=s96-c?sz=300"/>
          <div class="content">
           Sumit Mishra
           <div class="sub header" style="margin-top:5px">
            19th October 2019
           </div>
          </div>
         </div>
        </div>
        <div id="content">
         <article class="template">
          <div class="postContent">
           <div class="notesSource">
            <div class="postField postField--body" id="editor">
             <section class="section--first section--last">
              <div class="section-divider layoutSingleColumn-template">
               <hr class="section-divider"/>
              </div>
              <div class="section-content">
               <div class="section-inner layoutSingleColumn-template">
                <div>
                 <h1 class="graf--h1">
                  Understanding Image compression in Android
                 </h1>
                 <div class="graf-image graf-caption">
                  <img alt="Understanding Image compression in Android" class="graf-image" src="/images/understanding-image-compression-in-android-banner-2f58a1f66e7aab48.png"/>
                 </div>
                 <p class="graf--p">
                  Images play an important role in any application. It helps in conveying our message in a better way. But it comes with some cons also. It increases the APK size. You might have noticed that the applications dealing with images(either the local image or downloaded from the internet) are bigger in size and also we know that lesser the application size more the number of downloads. So, if we reduce the size of the images used in the application then eventually the APK size will be reduced.
                 </p>
                 <p class="graf--p">
                  This is the topic for today's blog. Today, we will understand image compression so that in future if you are planning to use some images in your app then you can just follow this blog and use the most suitable image format to reduce the APK size.
                 </p>
                 <p class="graf--p">
                  We will be covering the below points in this blog:
                 </p>
                 <ul>
                  <li>
                   Why Image Compression?
                  </li>
                  <li>
                   PNG image
                  </li>
                  <li>
                   Vector image
                  </li>
                  <li>
                   JPEG image
                  </li>
                  <li>
                   WebP
                  </li>
                  <li>
                   Important tip
                  </li>
                  <li>
                   Closing notes
                  </li>
                 </ul>
                 <p class="graf--p">
                  So, let's get started.
                 </p>
                 <h4 class="graf--h3">
                  Why Image Compression?
                 </h4>
                 <p class="graf--p">
                  Images are the best way to convey our message to our users. We can convey the information through images in a much much better way as compared to texts.
                 </p>
                 <blockquote class="graf--blockquote">
                  <b class="graf--bold">
                   Images are cool.
                  </b>
                 </blockquote>
                 <p class="graf--p">
                  But the problem with images is that images can be easily bloated. Images can be too big or can have too many pixels or resolutions and this, in turn, reduce your application's performance. For example, if your app is loading an image of 5MB over a 2G network, and it is taking time, then you might end up losing one user of your application. Not only that it will take more data to download the image and also it will drain the battery. So, it is always very important to make sure that the images used in your application are compressed to give a better experience to your users.
                 </p>
                 <p class="graf--p">
                  In Android, we generally deal with the below four image types:
                 </p>
                 <ol type="1">
                  <li>
                   PNG
                  </li>
                  <li>
                   Vector Drawable
                  </li>
                  <li>
                   JPG
                  </li>
                  <li>
                   WebP
                  </li>
                 </ol>
                 <p class="graf--p">
                  Let's have a look at these image formats and how it works internally.
                 </p>
                 <h4 class="graf--h3">
                  PNG
                 </h4>
                 <p class="graf--p">
                  PNG or Portable Network  Graphics is the most commonly used image file in Android these days. They provide a nice and high-resolution image format. But due to this, we need to apply some image compression techniques also. PNG compressions are lossless i.e. you can get back your original image from the compressed one i.e. no loss of color is there. Each row of pixels in a PNG image is taken and processed one at a time. The whole PNG compression process can be divided into two processes:
                 </p>
                 <ol type="1">
                  <li>
                   <b class="graf--bold">
                    Filtering:
                   </b>
                   Here in this process, we will keep the value at each pixel and find the difference of value at one pixel with the value of the next or previous or up or down of a pixel. So, the main idea is to get the minimum difference possible. Less the difference, similar will be the color and larger will be the compression. For example, if an image contains only red color then the compression will be easier because only one color is there. All the pixels have the same color.
                  </li>
                  <li>
                   <b class="graf--bold">
                    Deflate:
                   </b>
                   The output of the filtering process is put into an encoding system called
                   <b class="graf--bold">
                    deflate
                   </b>
                   . Here, we use two algorithms named
                   <b class="graf--bold">
                    <i class="graf--italic">
                     LZ77
                    </i>
                   </b>
                   and
                   <b class="graf--bold">
                    <i class="graf--italic">
                     Huffman encoder
                    </i>
                   </b>
                   . LZ77 is a dictionary algorithm that finds the duplicate characters multiple times in a stream of data. The output of this LZ77 is then fed into the Huffman encoder which is almost identical to compressors like PKWARE, GZip, etc. The output of the deflate is then sent to the disk.
                  </li>
                 </ol>
                 <p class="graf--p">
                  To summarize the above two process, we can say that if the image is having lesser color combinations then more compression can be done because the pixel difference will be around 0. But if the image is having a number of color combinations then compression is difficult.
                 </p>
                 <p class="graf--p">
                  In Android, the AAPT tool does the above thing on PNG images for us. But there are demerits of using it also. So, lets first learn what AAPT does for us:
                 </p>
                 <ol type="1">
                  <li>
                   It analyses the PNG file to check if the image is having only white and black color i.e. greyscale or the image is having combination of different colors
                   <b class="graf--bold">
                    .
                   </b>
                  </li>
                  <li>
                   It checks if the image is having some transparency channel or the image is opaque. If your image is opaque then it will remove that channel and as a result of that, your image size will be reduced.
                  </li>
                  <li>
                   It finds the total number of colors used in the image. If it is less than or equal to 256, then it decreases the size of image.
                  </li>
                 </ol>
                 <p class="graf--p">
                  The demerits of AAPT lies in the above three points. Let's have one example:
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="Understanding Image compression in Android" class="graf-image" src="/images/understanding-image-compression-in-android-256-colour-example.jpg"/>
                 </div>
                 <p class="graf--p">
                  In the image above, three colors are present(blue, yellow, and white). But the AAPT is trying to get values for the 256 unique colors and after doing so, the final size of the image is 500KB. But if we reduce the colors then there is no effect on the image quality but there is a drastic change in the image size. For example, having 128 colors result in 125KB image and 8 colors result in 124B image.
                 </p>
                 <p class="graf--p">
                  So, what you need to do is first optimize your PNG(you can use PNGQuant, TinyPNG, PNGOut, etc for this) and then use it in your application. But in order to do so, you must disable the AAPT tools for your application because AAPT is unaware of the fact that you have done the compression already. So, to disable AAPT, you can use the below code in Gradle:
                 </p>
                 <pre><code class="language-java graf graf--code">aaptOptions {
    cruncherEnabled = False
}</code></pre>
                 <p class="graf--p">
                  After that, you have to make sure that all the images that you are using are fully compressed because now there is no AAPT for image compression.
                 </p>
                 <h4 class="graf--h3">
                  Vector Drawable
                 </h4>
                 <p class="graf--p">
                  As we all know that PNG files are raster files in nature. So, if you are making an application for different device sizes then you have to use different resolution size images for different devices(for mdpi, hdpi, xhdpi, etc we need different images) and this, in turn, increases your application size. So, we are having many copies of the same image which is not a good thing.
                 </p>
                 <p class="graf--p">
                  What if one image can be used in all the devices with different resolutions? Yeah, we can do this with the help of Vector Drawables.
                 </p>
                 <p class="graf--p">
                  Vector Drawable is a concept of drawing images with code. The benefit of using this is we can use the same drawable image for different resolution devices and this, in turn, reduces the APK size because we are using only one image for all the devices. What we do here is we write the code for the image, execute that or rasterize those to a bitmap in CPU memory and then we upload that in the GPU and finally the image is drawn on the screen of the device. By doing so, you will get a much smaller image file but it takes time in the rasterization process.
                 </p>
                 <p class="graf--p">
                  To convert your PNG image into vector drawable, you can either write the whole code for it or can use a tool named
                  <b class="graf--bold">
                   POTrace
                  </b>
                  . But be very careful before using images that are generated from POTrace because it is just an automated tool. So, you will not get the desired image all the time. But if possible, then code the vector image and you will get the desired results every time.
                 </p>
                 <h4 class="graf--h3">
                  JPG
                 </h4>
                 <p class="graf--p">
                  Till now we have seen PNGs and Vector Drawables and now its time for the JPEGs i.e. the big images. So, whenever we want to use a good quality image, we tend to use JPEGs and this is the reason why we are concerned about the compression of the JPEGs.
                 </p>
                 <p class="graf--p">
                  In JPG compression, we convert our source RGB image to some separate colorspace. As human eyes tend to see more differences in RGBs, than in the YCbCr colorspace, so we create different colorspace. Then we reduce the size of CB and CR channels and apply the discrete Cosine Transform. So, what it does is it converts or represents any signals as a sum of cosine. The output of this cosine transform is run into a quantization phase which quantize the output of cosine transform to integers and after that the statistical encoding is done which may be Huffman or arithmetic or any other encoding and finally, you get the JPG file. Phew, so many steps :(
                 </p>
                 <p class="graf--p">
                  There is one another option that is available with JPEG images i.e. you can choose how much to compress an image. For that, you can use
                  <b class="graf--bold">
                   Butteraugli
                  </b>
                  .
                 </p>
                 <blockquote class="graf--blockquote">
                  Butteraugli is a project that estimates the psychovisual similarity of two images. It gives a score for the images that is reliable in the domain of barely noticeable differences. Butteraugli not only gives a scalar score, but also computes a spatial map of the level of differences.
                 </blockquote>
                 <p class="graf--p">
                  It is just a way to take a source image and compress the image to find how the human eye sees the difference between various qualities of the image. So, if you want to compress your image and at the same time you want to know how much you can compress an image so that the human eye can't notice a change, then you can use Butteraugli for this. Want to use a high-resolution image? Cool, use Butteraugli to find the percentage up to which you can compress your image and then compress that image. That's it. At the same time, if the quality of the image is not a concern for you then you can further compress your image to get a smaller image file.
                 </p>
                 <p class="graf--p">
                  Like the PNG image compression, for JPEG images there are many tools available for compression like JPEGMini, MozJPEG, cJPEG, packJPG, etc.
                 </p>
                 <h4 class="graf--h3">
                  WebP
                 </h4>
                 <p class="graf--p">
                  In WebP image format, we can do both lossless and lossy compression. The lossless images of WebP are almost 26% smaller than that of PNGs. While the lossy images are 25-34% smaller than that of JPEGs file.
                 </p>
                 <p class="graf--p">
                  The lossy WebP uses predictive coding to encode an image. So, to predict the value in a pixel, WebP uses the values present in the neighbouring blocks and then encodes the difference only.
                 </p>
                 <p class="graf--p">
                  While the lossless WebP compression uses image fragments that are already seen to reconstruct new pixel. If no match is found, then it uses a local palette.
                 </p>
                 <h4 class="graf--h3">
                  Important tip
                 </h4>
                 <p class="graf--p">
                  So, we have seen all the image compression that we come across daily. If you are going to use some image in your application then you should first go for the Vector drawable. If vector drawable is there with you, then use it. If you are not having vector drawable and if you have the support of WebP then go for WebP. If you can't support WebP and if you need transparency support, use PNG. If you do not need transparency support, then try to find if the image is simple or complex. If it is simple then stick with PNG otherwise if it is complex then go with JPG.
                 </p>
                 <p class="graf--p">
                  Image Source: Google I/O
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="Understanding Image compression in Android" class="graf-image" src="/images/understanding-image-compression-in-android-image-type-selection.png"/>
                 </div>
                 <h4 class="graf--h3">
                  Closing notes
                 </h4>
                 <p class="graf--p">
                  In this blog, we learned various techniques used for image compressions like PNG, JPEG, Vector Drawable and WebP. We also saw how to decide which image format should we use in our application. But remember one thing, before using any type of image compression, do research to find who are your users, what do they want? Perform good research on that because in some cases JPEGs can be better than PNGs and vice-versa.
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Reference:
                  </b>
                  Google I/O 2016
                 </p>
                 <p class="graf--p">
                  Hope you learned something new today.
                 </p>
                 <p class="graf--p">
                  Do share this blog with your fellow developers to spread the knowledge. You can read more blogs on Android on our
                  <a class="markup--anchor" href="https://blog.mindorks.com/" target="_blank">
                   blogging website
                  </a>
                  .
                 </p>
                 <p class="graf--p">
                  Happy Learning :)
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Team MindOrks!
                  </b>
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Also, Let’s connect on
                  </b>
                  <b class="graf--bold">
                   <span class="">
                    <a class="markup--anchor" href="https://twitter.com/hiii_sumit" target="_blank">
                     Twitter
                    </a>
                   </span>
                   ,
                  </b>
                  <b class="graf--bold">
                   <span class="">
                    <a class="markup--anchor" href="https://www.linkedin.com/in/mishra3452/" target="_blank">
                     Linkedin
                    </a>
                   </span>
                   ,
                  </b>
                  <b class="graf--bold">
                   <span class="">
                    <a class="markup--anchor" href="https://github.com/mishra3452" target="_blank">
                     Github
                    </a>
                   </span>
                   , and
                  </b>
                  <b class="graf--bold">
                   <span class="">
                    <a class="markup--anchor" href="https://www.facebook.com/mishra3452" target="_blank">
                     Facebook
                    </a>
                   </span>
                  </b>
                 </p>
                </div>
               </div>
              </div>
             </section>
            </div>
           </div>
          </div>
         </article>
        </div>
       </div>
       <div class="ui divider">
       </div>
      </div>
      <div class="stretched fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui large center aligned header" style="padding-top:20px">
        Recommended for You
       </div>
      </div>
      <div class="fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui centered grid">
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/downloading-and-showing-image-with-glide-library-in-android/">
          <img alt="Downloading and Showing Image with Glide Library in Android" class="ui centered image" src="/images/download-show-image-glide-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Downloading and Showing Image with Glide Library in Android
           </div>
           <div class="meta">
            19th May 2019
           </div>
           <div class="description">
            In this blog, we will learn how to use Glide for downloading and showing images in our Android application. Basically, Glide library downloads the image and store it into your cache or local memory and uses it when needed in future.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/understanding-density-independent-pixel-sp-dp-dip-in-android/">
          <img alt="Understanding Density Independence Pixel: sp, dp, dip in Android" class="ui centered image" src="/images/understanding_density_independent_pixel.jpg" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Understanding Density Independence Pixel: sp, dp, dip in Android
           </div>
           <div class="meta">
            31st January 2019
           </div>
           <div class="description">
            What is the best measurement unit for designing for Android Screen? Density Independent Pixel, Scaled Independent Pixels, Density Pixels or Pixels.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/location-permissions-in-android-q/">
          <img alt="Understanding and Implementing Permission in Android Q" class="ui centered image" src="/images/location-permission.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Understanding and Implementing Permission in Android Q
           </div>
           <div class="meta">
            11th May 2019
           </div>
           <div class="description">
            In this blog, we will understand the new privacy-based location permission in Android Q and how to implement it in your app.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/understanding-settings-panel-in-android-q/">
          <img alt="Understanding Settings Panels in Android Q" class="ui centered image" src="/images/android-setting.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Understanding Settings Panels in Android Q
           </div>
           <div class="meta">
            14th May 2019
           </div>
           <div class="description">
            In this blog, we will understand the new setting panel which released in Android Q. With Google launching Android Q, Lot of exciting features has also popped up. One amazing feature is Location Service usage and few more.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/understanding-multidex-in-android/">
          <img alt="Understanding Multidex in Android" class="ui centered image" src="/images/understanding-multidex-banner-img.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Understanding Multidex in Android
           </div>
           <div class="meta">
            18th May 2019
           </div>
           <div class="description">
            In this blog, we will learn how to use Multidex in Android. Basically, Multidex is used when we want to add more than 64K methods in our Android project. If we don't use any Multidex for the project having more than 64K methods, then we will encounter DEX error. So, in this blog, we will learn how to use Multidex.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/understanding-the-application-lifecycle-in-android/">
          <img alt="Understanding the Application Lifecycle in Android" class="ui centered image" src="/images/understanding-the-application-lifecycle-in-android-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Understanding the Application Lifecycle in Android
           </div>
           <div class="meta">
            4th June 2019
           </div>
           <div class="description">
            In this blog, we will learn about the Application life cycle in Android. We will learn how to make use of various application states that a particular application has in general.
           </div>
          </div>
         </a>
        </div>
       </div>
      </div>
     </div>
    </div>
    <div style="background:#fff">
     <footer class="content-container">
      <div class="ui centered padded grid" style="padding-top:40px;background:linear-gradient(to right,#c4e0e0,#e5f1f1)">
       <h2 class="ui huge icon center aligned header">
        <div class="content">
         Connect With Your Mentors
        </div>
       </h2>
       <div class="centered row">
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Janishar Ali" class="ui medium circular image" src="/assets/ali.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://janisharali.com" target="_blank">
             Janishar Ali
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://janisharali.com" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/janisharali" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Amit Shekhar" class="ui medium circular image" src="/assets/amit.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://amitshekhar.me" target="_blank">
             Amit Shekhar
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://amitshekhar.me" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/amitiitbhu" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div class="ui divider" style="margin:unset">
      </div>
      <h5 class="ui header" style="padding:16px;margin:unset;color:#555">
       <i aria-hidden="true" class="copyright icon">
       </i>
       <div class="content">
        Copyright 2022, MindOrks Nextgen Private Limited
       </div>
      </h5>
     </footer>
    </div>
   </div>
  </div>
  <script type="text/javascript">
   window.hljs.initHighlightingOnLoad()
  </script>
 </body>
</html>