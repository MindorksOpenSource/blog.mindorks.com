<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title>
   Activity Recognition in Android — Still, Walking, Running, Driving and much more
  </title>
  <meta charset="utf-8"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="minimum-scale=1,initial-scale=1,width=device-width,shrink-to-fit=no" name="viewport"/>
  <link href="https://blog.mindorks.com/activity-recognition-in-android-still-walking-running-driving-and-much-more" rel="canonical"/>
  <meta content="986249072156-dabps0lf90smluddrk5rkqsdjghk3hd3.apps.googleusercontent.com" name="google-signin-client_id"/>
  <meta content="android, learn android app development, android app development courses, android blogs, android tutorial" name="keywords"/>
  <meta content="Activity Recognition in Android — Still, Walking, Running, Driving and much more" property="og:title"/>
  <meta content="website" property="og:type"/>
  <meta content="https://blog.mindorks.com/activity-recognition-in-android-still-walking-running-driving-and-much-more" property="og:url"/>
  <meta content="/images/activity-recognition-in-android-banner.png" property="og:image"/>
  <meta content="In this blog, we will learn how to use the Activity Recognition API in our Android Application. The Activity Recognition API is used to determine the Activity that a user is doing at a particular instant of time like walking, running, driving, still, etc." property="og:description"/>
  <meta content="Activity Recognition in Android — Still, Walking, Running, Driving and much more" property="twitter:title"/>
  <meta content="In this blog, we will learn how to use the Activity Recognition API in our Android Application. The Activity Recognition API is used to determine the Activity that a user is doing at a particular instant of time like walking, running, driving, still, etc." name="twitter:description"/>
  <meta content="/images/activity-recognition-in-android-banner.png" name="twitter:image:src"/>
  <meta content="summary_large_image" name="twitter:card"/>
  <meta content="@MindorksNextGen" name="twitter:site"/>
  <meta content="In this blog, we will learn how to use the Activity Recognition API in our Android Application. The Activity Recognition API is used to determine the Activity that a user is doing at a particular instant of time like walking, running, driving, still, etc." name="description"/>
  <meta content="1620001391374687" property="fb:app_id"/>
  <link href="/styles/vendor-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link href="/styles/app-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link as="style" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" onload='this.onload=null,this.rel="stylesheet"' rel="preload"/>
  <noscript>
   <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
  </noscript>
  <script type="text/javascript">
   window.__PRELOADED_STATE__={toastr:{toastrs:[],confirm:null},blogData:{data:{},latestBlogs:null,isFetching:!0,isFetchingLatestBlogs:!1,currentCategory:"",categories:[]},contactData:{formData:{email:"",name:"",phone:"",message:"",isWriting:!1,isNameError:!1,isEmailError:!1,isPhoneError:!1,isMessageError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSending:!1},communityData:{formData:{email:"",isEmailError:!1,isWriting:!1,isSending:!1,dismissMsg:!1},successMessage:null,errorMessage:null},blogPageData:{blogId:273,data:{id:273,title:"Activity Recognition in Android — Still, Walking, Running, Driving and much more",description:"In this blog, we will learn how to use the Activity Recognition API in our Android Application. The Activity Recognition API is used to determine the Activity that a user is doing at a particular instant of time like walking, running, driving, still, etc.",text:'<h1 class="graf--h1">Activity Recognition in Android — Still, Walking, Running, Driving and much more</h1> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/activity-recognition-in-android-banner.png class=\'graf-image\' alt=\'Activity Recognition in Android — Still, Walking, Running, Driving and much more\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">Nowadays, everyone is having smartphones, and we use them to do our day to day lives. The best part of Android applications that are present in mobile phones is that these applications try to know their users more and more. Today, many of the applications are taking locations of the users to give a location related feeds to the users. One common example of this can be a normal news application, where the app takes your current location and presents the news according to the location.</p><p class="graf--p">If you are an Android Developer, then to give your users a better experience of the application, you have to understand your users in a better way. You should know what your users are doing at any instant of time. The more you know about your users the better application you can build for your users. So, there are many application that uses this Activity Recognition of the users. For example, a kilometer finder app starts running when you start driving a car or a bike and stops when you stop driving. By doing this, the app can find the distance that you traveled in a particular day. Other application of this Activity Recognition can be any Health and Fitness app that determines how many meters or kilometers you are running or walking on a particular day and after that, you can find the calories burnt on that day.</p><p class="graf--p">So, in this blog, we will learn how to use the Activity Recognition feature in our Android application to find if a user is Still, Running, Walking, Driving or something else. So, let’s get started.</p><h4 class="graf--h3">Activity Recognition Client</h4><p class="graf--p">In order to find the activities that the user is doing at a particular moment, you have to constantly communicate with the sensors of the mobile and after collecting the data, you have to use some Machine Learning algorithm to find which activity the user is currently doing. But hold on! do we need to learn Machine Learning algorithms to recognize the activities that the user is doing? No no, you need not learn any Machine Learning algorithm for detecting the Activities.</p><p class="graf--p">In Android, we have the Activity Recognition Client that wakes up your device at a regular interval and then collects the data from the device’s sensor and after that this collected data will be used to determine the Activities with the help of some Machine Learning algorithm. All you need to do is use the <b class="graf--bold">Activity Recognition Client </b>and the API will do the rest for you.</p><p class="graf--p">The Activity Recognition Client returns a list of activities that a user might be doing with some confidence percentage. This confidence percentage tells you about the surety of the activity. For example, the activity which is having more than 75% confidence, then there is a probability that the user might be doing that activity. So the confidence parameter tells you the probability of an activity being done by the user.</p><h4 class="graf--h3">Activities detected by the Activity Recognition Client</h4><p class="graf--p">The Activity Recognition Client determines a list of Activities that a user can perform and the API can detect. Following are the activities that can be detected by the Activity Recognition Client:</p><ul><li><b class="graf--bold">STILL:</b> When the mobile device will be still i.e. the user is either sitting at some place or the mobile device is having no motion, then the <b class="graf--bold">Activity Recognition Client</b> will detect the <b class="graf--bold">STILL</b> activity.</li><li><b class="graf--bold">ON_FOOT:</b> When the mobile device is moving at a normal speed i.e. the user carrying the mobile device is either walking or running then the <b class="graf--bold">Activity Recognition Client</b> will detect the <b class="graf--bold">ON_FOOT</b> activity.</li><li><b class="graf--bold">WALKING:</b> This is a sub-activity of the <b class="graf--bold">ON_FOOT</b> activity which is detected by the Activity Recognition Client when the user carrying the mobile device is walking.</li><li><b class="graf--bold">RUNNING:</b> This is also a sub-activity of <b class="graf--bold">ON_FOOT</b> activity which is detected by the Activity Recognition Client when the user carrying the mobile device is running.</li><li><b class="graf--bold">IN_VEHICLE:</b> This activity detected when the mobile device is in the bus or car or some other kind of vehicle or the user holding the mobile device is present in the vehicle.</li><li><b class="graf--bold">ON_BICYCLE:</b> When the device is on the bicycle or the user carrying the mobile is on a bicycle then this activity will be detected.</li><li><b class="graf--bold">TILTING:</b> When the mobile device is being lifted and is having some angle with the flat surface then the Activity Recognition Client will detect this activity.</li><li><b class="graf--bold">UNKNOWN:</b> The Activity Recognition Client will show this result when the device is unable to detect any activity on the mobile device.</li></ul><h4 class="graf--h3">Activity Recognition example</h4><p class="graf--p">We have learned the concept of Activity Recognition Client. Now, the time is for some practical session :) Let’s have one example of Activity Recognition Client to understand the concept of Activity Recognition in a better way. So, let’s do one example.</p><p class="graf--p">Open Android Studio and create a project with Empty Activity template.</p><p class="graf--p"><b class="graf--bold">Adding dependencies and permissions</b></p><p class="graf--p">The Activity Recognition Client requires the dependency of Google Play Services. So, to add the dependency of Google Play Services, add the below line in your app level <b class="graf--bold"><i class="graf--italic">build.gradle</i></b> file:</p><pre><code class="language-java graf graf--code">implementation \'com.google.android.gms:play-services-location:16.0.0\'</code></pre><p class="graf--p">After adding the dependency of Google Play Services, add the permission of ACTIVITY_RECOGNITION in the <b class="graf--bold"><i class="graf--italic">AndroidManifest.xml</i></b> file:</p><pre><code class="language-java graf graf--code">&lt;uses-permission android:name="com.google.android.gms.permission.ACTIVITY_RECOGNITION" /&gt;</code></pre><p class="graf--p"><b class="graf--bold">Adding the UI of the application</b></p><p class="graf--p">So, the process of adding the dependencies and permissions are done. Now the next step is to add the UI for our Main Activity. In our application, we will be having one <b class="graf--bold">TextView </b>to display the name of current activity and one <b class="graf--bold">TextView </b>to display the confidence precentage of  Activity. So, the <b class="graf--bold"><i class="graf--italic">activity_main.xml</i></b> file looks something like this:</p><pre><code class="language-java graf graf--code">&lt;?xml version="1.0" encoding="utf-8"?&gt;\n&lt;android.support.constraint.ConstraintLayout xmlns:app="http://schemas.android.com/apk/res-auto"\n    android:layout_width="match_parent"\n    android:layout_height="match_parent"\n    xmlns:android="http://schemas.android.com/apk/res/android"&gt;\n\n    &lt;TextView\n        android:id="@+id/txt_activity"\n        android:layout_width="wrap_content"\n        android:layout_height="wrap_content"\n        android:layout_margin="24dp"\n        android:layout_marginStart="8dp"\n        android:layout_marginLeft="8dp"\n        android:layout_marginEnd="8dp"\n        android:layout_marginRight="8dp"\n        android:layout_marginBottom="48dp"\n        android:textAllCaps="true"\n        android:textColor="@color/colorPrimary"\n        android:textSize="18dp"\n        android:textStyle="bold"\n        app:layout_constraintBottom_toTopOf="@+id/txt_confidence"\n        app:layout_constraintEnd_toEndOf="parent"\n        app:layout_constraintStart_toStartOf="parent" /&gt;\n\n    &lt;TextView\n        android:id="@+id/txt_confidence"\n        android:layout_width="wrap_content"\n        android:layout_height="wrap_content"\n        android:layout_gravity="center_horizontal"\n        android:layout_margin="24dp"\n        android:layout_marginStart="8dp"\n        android:layout_marginLeft="8dp"\n        android:textAllCaps="true"\n        android:textSize="14dp"\n        app:layout_constraintBottom_toBottomOf="parent"\n        app:layout_constraintEnd_toEndOf="parent"\n        app:layout_constraintStart_toStartOf="parent"\n        app:layout_constraintTop_toTopOf="parent" /&gt;\n\n    &lt;Button\n        android:id="@+id/btn_start_tracking"\n        android:layout_width="240dp"\n        android:layout_height="wrap_content"\n        android:layout_marginStart="8dp"\n        android:layout_marginLeft="8dp"\n        android:layout_marginEnd="8dp"\n        android:layout_marginRight="8dp"\n        android:layout_marginBottom="8dp"\n        android:text="Start Tracking"\n        app:layout_constraintBottom_toTopOf="@+id/btn_stop_tracking"\n        app:layout_constraintEnd_toEndOf="parent"\n        app:layout_constraintStart_toStartOf="parent" /&gt;\n\n    &lt;Button\n        android:id="@+id/btn_stop_tracking"\n        android:layout_width="240dp"\n        android:layout_height="wrap_content"\n        android:layout_alignParentRight="true"\n        android:layout_alignParentBottom="true"\n        android:layout_marginStart="8dp"\n        android:layout_marginLeft="8dp"\n        android:layout_marginEnd="8dp"\n        android:layout_marginRight="8dp"\n        android:layout_marginBottom="8dp"\n        android:text="Stop Tracking"\n        app:layout_constraintBottom_toBottomOf="parent"\n        app:layout_constraintEnd_toEndOf="parent"\n        app:layout_constraintStart_toStartOf="parent" /&gt;\n\n&lt;/android.support.constraint.ConstraintLayout&gt;</code></pre><p class="graf--p">Now, add the strings values in the <b class="graf--bold"><i class="graf--italic">res/values/strings.xml </i></b>file:</p><pre><code class="language-java graf graf--code">&lt;resources&gt;\n    &lt;string name="app_name"&gt;Activity Recognition&lt;/string&gt;\n    &lt;string name="activity_in_vehicle"&gt;In Vehicle&lt;/string&gt;\n    &lt;string name="activity_on_bicycle"&gt;On Bicycle&lt;/string&gt;\n    &lt;string name="activity_on_foot"&gt;On Foot&lt;/string&gt;\n    &lt;string name="activity_running"&gt;Running&lt;/string&gt;\n    &lt;string name="activity_still"&gt;Still&lt;/string&gt;\n    &lt;string name="activity_tilting"&gt;Tilting&lt;/string&gt;\n    &lt;string name="activity_walking"&gt;walking&lt;/string&gt;\n    &lt;string name="activity_unknown"&gt;Unknown&lt;/string&gt;\n&lt;/resources&gt;</code></pre><p class="graf--p">Now, we are done with the UI part of our Main Activity. Now, let&#x27;s move on to the coding part of our application.</p><p class="graf--p">So, we are totally done with the UI part of our application. Now let’s move on to the coding part.</p><p class="graf--p"><b class="graf--bold">Creating an IntentService</b></p><p class="graf--p">After making the UI of the application, our next task is to create a class that will be extended from the IntentService. This class will return a list of probable activities that can be performed by the user or the activity that the user is currently doing i.e. WALKING, RUNNING, ON_FOOT, etc. The code of my DetectedActivitiesIntentService is:</p><pre><code class="language-java graf graf--code">class DetectedActivitiesIntentService : IntentService(TAG) {\n\n    override fun onCreate() {\n        super.onCreate()\n    }\n\n    override fun onHandleIntent(intent: Intent?) {\n        val result = ActivityRecognitionResult.extractResult(intent)\n\n        // Get the list of the probable activities associated with the current state of the\n        // device. Each activity is associated with a confidence level, which is an int between\n        // 0 and 100.\n        val detectedActivities = result.probableActivities as ArrayList&lt;*&gt;\n\n        for (activity in detectedActivities) {\n            broadcastActivity(activity as DetectedActivity)\n        }\n    }\n\n    private fun broadcastActivity(activity: DetectedActivity) {\n        val intent = Intent(MainActivity.BROADCAST_DETECTED_ACTIVITY)\n        intent.putExtra("type", activity.type)\n        intent.putExtra("confidence", activity.confidence)\n        LocalBroadcastManager.getInstance(this).sendBroadcast(intent)\n    }\n\n    companion object {\n\n        protected val TAG = DetectedActivitiesIntentService::class.java.simpleName\n    }\n}// Use the TAG to name the worker thread.</code></pre><p class="graf--p"><b class="graf--bold">Activity Running in Background</b></p><p class="graf--p">Our next step is to write the code for the <b class="graf--bold"><i class="graf--italic">MainActivity.kt</i></b> file. But before that, the thing that should be kept in mind is the battery performance. If you want your Activity Recognition Client to update the activities in a regular interval or in a frequent manner then this will reduce the battery performance of your mobile device. Also, if you want your application to continuously track the ongoing activity, then it is a good task to run your Application in background. But at the same time, the battery consumption should be take care of.</p><p class="graf--p">So, make a class that will detect the Activities in background. Here is the code:</p><pre><code class="language-java graf graf--code">class BackgroundDetectedActivitiesService : Service() {\n\n    private lateinit var mIntentService: Intent\n    private lateinit var mPendingIntent: PendingIntent\n    private lateinit var mActivityRecognitionClient: ActivityRecognitionClient\n\n    internal var mBinder: IBinder = LocalBinder()\n\n    inner class LocalBinder : Binder() {\n        val serverInstance: BackgroundDetectedActivitiesService\n            get() = this@BackgroundDetectedActivitiesService\n    }\n\n    override fun onCreate() {\n        super.onCreate()\n        mActivityRecognitionClient = ActivityRecognitionClient(this)\n        mIntentService = Intent(this, DetectedActivitiesIntentService::class.java)\n        mPendingIntent = PendingIntent.getService(this, 1, mIntentService, PendingIntent.FLAG_UPDATE_CURRENT)\n        requestActivityUpdatesButtonHandler()\n    }\n\n    override fun onBind(intent: Intent): IBinder? {\n        return mBinder\n    }\n\n    override fun onStartCommand(intent: Intent, flags: Int, startId: Int): Int {\n        super.onStartCommand(intent, flags, startId)\n        return Service.START_STICKY\n    }\n\n    fun requestActivityUpdatesButtonHandler() {\n        val task = mActivityRecognitionClient?.requestActivityUpdates(\n                MainActivity.DETECTION_INTERVAL_IN_MILLISECONDS,\n                mPendingIntent)\n\n        task?.addOnSuccessListener {\n            Toast.makeText(applicationContext,\n                    "Successfully requested activity updates",\n                    Toast.LENGTH_SHORT)\n                    .show()\n        }\n\n        task?.addOnFailureListener {\n            Toast.makeText(applicationContext,\n                    "Requesting activity updates failed to start",\n                    Toast.LENGTH_SHORT)\n                    .show()\n        }\n    }\n\n    fun removeActivityUpdatesButtonHandler() {\n        val task = mActivityRecognitionClient?.removeActivityUpdates(\n                mPendingIntent)\n        task?.addOnSuccessListener {\n            Toast.makeText(applicationContext,\n                    "Removed activity updates successfully!",\n                    Toast.LENGTH_SHORT)\n                    .show()\n        }\n\n        task?.addOnFailureListener {\n            Toast.makeText(applicationContext, "Failed to remove activity updates!",\n                    Toast.LENGTH_SHORT).show()\n        }\n    }\n\n    override fun onDestroy() {\n        super.onDestroy()\n        removeActivityUpdatesButtonHandler()\n    }\n\n    companion object {\n        private val TAG = BackgroundDetectedActivitiesService::class.java?.getSimpleName()\n    }\n}</code></pre><p class="graf--p"><b class="graf--bold">Code for MainActivity.kt</b></p><p class="graf--p">So, our final task is to write the code for <b class="graf--bold"><i class="graf--italic">MainActivity.kt</i></b> file. Here, <b class="graf--bold"><i class="graf--italic">BroadCastReceiver() </i></b>is used to receive the Activity Update from the user i.e. whenever there is a change in Activity, then the activity will be recived. Following is the code for <b class="graf--bold"><i class="graf--italic">MainActivity.kt</i></b> file:</p><pre><code class="language-java graf graf--code">class MainActivity : AppCompatActivity() {\n\n    private val TAG = MainActivity::class.java.simpleName\n    internal lateinit var broadcastReceiver: BroadcastReceiver\n\n    private lateinit var txtActivity: TextView\n    private lateinit var txtConfidence: TextView\n    private lateinit var btnStartTrcking: Button\n    private lateinit var btnStopTracking: Button\n\n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n        setContentView(R.layout.activity_main)\n\n        txtActivity = findViewById(R.id.txt_activity)\n        txtConfidence = findViewById(R.id.txt_confidence)\n        btnStartTrcking = findViewById(R.id.btn_start_tracking)\n        btnStopTracking = findViewById(R.id.btn_stop_tracking)\n\n        btnStartTrcking?.setOnClickListener { startTracking() }\n\n        btnStopTracking?.setOnClickListener { stopTracking() }\n\n        broadcastReceiver = object : BroadcastReceiver() {\n            override fun onReceive(context: Context, intent: Intent) {\n                if (intent.action == MainActivity.BROADCAST_DETECTED_ACTIVITY) {\n                    val type = intent.getIntExtra("type", -1)\n                    val confidence = intent.getIntExtra("confidence", 0)\n                    handleUserActivity(type, confidence)\n                }\n            }\n        }\n\n        startTracking()\n    }\n\n    private fun handleUserActivity(type: Int, confidence: Int) {\n        var label = getString(R.string.activity_unknown)\n\n        when (type) {\n            DetectedActivity.IN_VEHICLE -&gt; {\n                label = "You are in Vehicle"\n            }\n            DetectedActivity.ON_BICYCLE -&gt; {\n                label = "You are on Bicycle"\n            }\n            DetectedActivity.ON_FOOT -&gt; {\n                label = "You are on Foot"\n            }\n            DetectedActivity.RUNNING -&gt; {\n                label = "You are Running"\n            }\n            DetectedActivity.STILL -&gt; {\n                label = "You are Still"\n            }\n            DetectedActivity.TILTING -&gt; {\n                label = "Your phone is Tilted"\n            }\n            DetectedActivity.WALKING -&gt; {\n                label = "You are Walking"\n            }\n            DetectedActivity.UNKNOWN -&gt; {\n                label = "Unkown Activity"\n            }\n        }\n\n        Log.e(TAG, "User activity: $label, Confidence: $confidence")\n\n        if (confidence &gt; MainActivity.CONFIDENCE) {\n            txtActivity?.text = label\n            txtConfidence?.text = "Confidence: $confidence"\n        }\n    }\n\n    override fun onResume() {\n        super.onResume()\n\n        LocalBroadcastManager.getInstance(this).registerReceiver(broadcastReceiver,\n                IntentFilter(MainActivity.BROADCAST_DETECTED_ACTIVITY))\n    }\n\n    override fun onPause() {\n        super.onPause()\n\n        LocalBroadcastManager.getInstance(this).unregisterReceiver(broadcastReceiver)\n    }\n\n    private fun startTracking() {\n        val intent = Intent(this@MainActivity, BackgroundDetectedActivitiesService::class.java)\n        startService(intent)\n    }\n\n    private fun stopTracking() {\n        val intent = Intent(this@MainActivity, BackgroundDetectedActivitiesService::class.java)\n        stopService(intent)\n    }\n\n    companion object {\n\n        val BROADCAST_DETECTED_ACTIVITY = "activity_intent"\n\n        internal val DETECTION_INTERVAL_IN_MILLISECONDS: Long = 1000\n\n        val CONFIDENCE = 70\n    }\n}</code></pre><p class="graf--p">Now, run the application and you will get the list of activities along with the confidence of the activity.</p><h4 class="graf--h3">Conclusion</h4><p class="graf--p">In this blog, we learned how to use the Activity Recognition Client in our application to determine the activities that users are doing at any instant of time. The Activity Recognition Client determines the ongoing Activities with some confidence percentage that tells you which activity is currently going on.</p><p class="graf--p">So, that’s it for this blog. Keep Learning :)</p><p class="graf--p"><b class="graf--bold">Team MindOrks!</b></p>',author:14897,img_url:"/images/activity-recognition-in-android-banner.png",blog_url:"activity-recognition-in-android-still-walking-running-driving-and-much-more",likes:0,rank:0,category:1,published_at:"12th June 2019"},author:{id:14897,name:"Admin MindOrks",google_profile_pic:"https://s3.ap-south-1.amazonaws.com/mindorks/website/mindorks-admin.png",fb_profile_pic:null,profile_tagline:"Mindorks is an online software learning platform. It is a community of great programmers.",fb_profile_url:"https://www.facebook.com/mindorks.nextgen/",google_plus_profile_url:"https://mindorks.com",twitter_profile_url:"https://twitter.com/mindorksnextgen",github_profile_url:"https://github.com/mindorksopensource",linkedin_profile_url:"https://in.linkedin.com/company/mindorks"},isFetching:!1,similarBlogs:[{id:277,title:"Understanding Activity Aliases in Android To Preserve Your Launchers",description:"In this blog, we will learn the concept of Activity Aliases in Android. Activity Aliases are used to preserve the Launchers whenever there is a change in the Launcher Activity name. Generally, when we create a shortcut on our home screen and if we change the Launcher Activity, then the shortcut will be removed from the home screen. So, let's find how to deal with this.",author:14897,img_url:"/images/activity-aliases-in-android-banner.png",blog_url:"understanding-activity-aliases-in-android-to-preserve-your-launchers",likes:0,rank:0,category:1,published_at:"17th June 2019",score:2.1641366481781006},{id:302,title:"How to create a Transparent Activity in Android?",description:"In this blog, we will learn how to create a Transparent activity in Android. By using Transparent activity, your app will be launched but nothing will be displayed in the background of the window.",author:14897,img_url:"/images/transparent-activity-in-android-banner.png",blog_url:"how-to-create-a-transparent-activity-in-android",likes:0,rank:0,category:1,published_at:"22nd July 2019",score:2.1641366481781006},{id:193,title:"Android Activity Lifecycle",description:"In this blog, we will learn about Activities in Android and the lifecycle of activity in detail. We will also see the real example use-cases of Activity Lifecycle",author:9959,img_url:"/images/android-activity-lifecycle-banner.png",blog_url:"android-activity-lifecycle",likes:0,rank:0,category:1,published_at:"3rd January 2019",score:2.1641366481781006},{id:84,title:"Detecting and fixing memory leaks in android",description:"Many a time we see ANR dialog while using android apps, lags in our apps, we also see OutOfMemoryError in Android Studio while building apps. All these kinds of stuff happen due to memory leaks.",author:30,img_url:"https://s3.ap-south-1.amazonaws.com/mindorks/blogs/detecting-and-fixing-memory-leaks-in-android.jpg",blog_url:"detecting-and-fixing-memory-leaks-in-android",likes:1,rank:0,category:1,published_at:"27th August 2017",score:.2793795168399811},{id:195,title:"Android  Fragments and its Lifecycle",description:"Android Fragments",author:14897,img_url:"/images/android_fragments_mindorks_feature_image.png",blog_url:"android-fragments-and-its-lifecycle",likes:0,rank:0,category:1,published_at:"3rd January 2019",score:.2793795168399811},{id:206,title:"What is Android Jetpack and why should we use it?",description:"What is Android Jetpack and why should we use it? Benefits of Android Jetpack. Build high quality, robust apps using the Android Jetpack. Android Jetpack is a collection of Android software components which helps us in building great Android apps.",author:30,img_url:"/images/android-jetpack.png",blog_url:"what-is-android-jetpack-and-why-should-we-use-it",likes:0,rank:0,category:1,published_at:"4th January 2019",score:.2793795168399811}],isSimilarBlogsFetching:!1},loginData:{data:null,isLoggingIn:!1,isLoggingOut:!1,loginState:!1,isForcedLogout:!1,isTokenRefreshed:!1,isRedirectHome:!1,message:""},updatesData:{news:null,inspirations:null,isNewsFetching:!0,isInspirationsFetching:!0},blogEditorData:{blogId:null,blogDetailsFormData:{title:"",description:"",imgUrl:"",blogUrl:"",category:"",categories:[],isWriting:!1,isTitleError:!1,isDescriptionError:!1,isImgUrlError:!1,isBlogUrlError:!1,isCategoryError:!1,isUploadingImage:!1,uploadedImageUrl:null},editorState:null,editorText:null,successMessage:null,errorMessage:null,isSending:!1,isMsgToShow:!1,isPublished:!1,isSubmitted:!1,isDraft:!0,isEditOfExistingBlog:!1,isFetchingBlogCategories:!1,isUploadingImage:!1,uploadedImageUrl:null},myBlogsData:{data:null,isSubmittedBlogsFetching:!0,isDraftBlogsFetching:!0,isPublishedBlogsFetching:!0,successMessage:null,errorMessage:null,isMsgToShow:!1,tabNames:["drafts","submissions","published"],selectedTab:"drafts",isFetchingBlog:!1,isDeletingBlog:!1,openEditorPage:!1},profilePreviewData:{profile:null,blogs:null,isFetchingProfile:!1,isFetchingAuthorBlogs:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,isUserNotRegistered:!1,redirectToMyProfileEdit:!1},profileEditableData:{userId:null,name:null,fbProfilePicUrl:null,googleProfilePicUrl:null,profileFormData:{tagline:"",fbProfileUrl:"",googlePlusProfileUrl:"",twitterProfileUrl:"",githubProfileUrl:"",linkedinProfileUrl:"",isWriting:!1,isTaglineError:!1,isFbProfileUrlError:!1,isGooglePlusProfileUrlError:!1,isTwitterProfileUrlError:!1,isGithubProfileUrlError:!1,isLinkedinProfileUrlError:!1},isSavingProfile:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,redirectToProfilePreview:!1},submitBlogData:{formData:{email:"",name:"",link:"",isWriting:!1,isNameError:!1,isEmailError:!1,isLinkError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSubmitting:!1},advertisementsData:{data:{},isLoading:!1},recaptchaData:{verified:!1,successMessage:null,errorMessage:null},blogSearchData:{searches:null,isSearching:!1}}
  </script>
  <script async="" src="https://www.google-analytics.com/analytics.js" type="text/javascript">
  </script>
  <script type="text/javascript">
   window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-91686131-1","auto"),ga("require","cleanUrlTracker"),ga("require","eventTracker"),ga("require","impressionTracker"),ga("require","outboundLinkTracker"),ga("require","urlChangeTracker"),ga("require","maxScrollTracker"),ga("require","mediaQueryTracker"),ga("require","outboundFormTracker"),ga("require","outboundLinkTracker"),ga("require","pageVisibilityTracker"),ga("require","socialWidgetTracker"),ga("require","urlChangeTracker"),ga("send","pageview")
  </script>
  <script defer="defer" src="/assets/autotrack.js" type="text/javascript">
  </script>
  <script src="/assets/highlight.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/vendor-bundle-1.8.6.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/app-bundle-1.8.6.js" type="text/javascript">
  </script>
 </head>
 <body>
  <div id="root">
   <div class="screen app-load-content" data-reactroot="">
    <div class="ui centered grid">
     <div class="row" style="padding:0">
      <div class="ui fixed menu navbar huge borderless grid" style="background-color:#fff;height:60px">
      </div>
     </div>
     <div class="centered computer only row" style="padding:0">
      <div class="ui fixed top menu navbar huge borderless grid header-container" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="right menu">
        <a class="item" href="https://janisharali.com" target="_blank">
         Mentor Ali
        </a>
        <a class="item" href="https://amitshekhar.me" target="_blank">
         Mentor Amit
        </a>
       </div>
      </div>
     </div>
     <div class="tablet only mobile only row" style="padding:0">
      <div class="ui fixed top navbar huge menu borderless" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="item">
       </div>
      </div>
     </div>
    </div>
    <div class="header-height">
    </div>
    <div aria-live="assertive" class="redux-toastr">
     <div>
      <div class="top-left">
      </div>
      <div class="top-right">
      </div>
      <div class="top-center">
      </div>
      <div class="bottom-left">
      </div>
      <div class="bottom-right">
      </div>
      <div class="bottom-center">
      </div>
     </div>
    </div>
    <div class="content-container theme">
     <div class="ui centered one column grid" style="padding-bottom:80px;background-color:#fff">
      <div class="ten wide computer fifteen wide mobile fifteen wide tablet column" style="margin-top:50px">
       <div>
        <div class="blog-page-author">
         <div class="ui small header">
          <img alt="Admin MindOrks" class="ui circular image" src="https://s3.ap-south-1.amazonaws.com/mindorks/website/mindorks-admin.png"/>
          <div class="content">
           Admin MindOrks
           <div class="sub header" style="margin-top:5px">
            12th June 2019
           </div>
          </div>
         </div>
        </div>
        <div id="content">
         <article class="template">
          <div class="postContent">
           <div class="notesSource">
            <div class="postField postField--body" id="editor">
             <section class="section--first section--last">
              <div class="section-divider layoutSingleColumn-template">
               <hr class="section-divider"/>
              </div>
              <div class="section-content">
               <div class="section-inner layoutSingleColumn-template">
                <div>
                 <h1 class="graf--h1">
                  Activity Recognition in Android — Still, Walking, Running, Driving and much more
                 </h1>
                 <div class="graf-image graf-caption">
                  <img alt="Activity Recognition in Android — Still, Walking, Running, Driving and much more" class="graf-image" src="/images/activity-recognition-in-android-banner.png"/>
                 </div>
                 <p class="graf--p">
                  Nowadays, everyone is having smartphones, and we use them to do our day to day lives. The best part of Android applications that are present in mobile phones is that these applications try to know their users more and more. Today, many of the applications are taking locations of the users to give a location related feeds to the users. One common example of this can be a normal news application, where the app takes your current location and presents the news according to the location.
                 </p>
                 <p class="graf--p">
                  If you are an Android Developer, then to give your users a better experience of the application, you have to understand your users in a better way. You should know what your users are doing at any instant of time. The more you know about your users the better application you can build for your users. So, there are many application that uses this Activity Recognition of the users. For example, a kilometer finder app starts running when you start driving a car or a bike and stops when you stop driving. By doing this, the app can find the distance that you traveled in a particular day. Other application of this Activity Recognition can be any Health and Fitness app that determines how many meters or kilometers you are running or walking on a particular day and after that, you can find the calories burnt on that day.
                 </p>
                 <p class="graf--p">
                  So, in this blog, we will learn how to use the Activity Recognition feature in our Android application to find if a user is Still, Running, Walking, Driving or something else. So, let’s get started.
                 </p>
                 <h4 class="graf--h3">
                  Activity Recognition Client
                 </h4>
                 <p class="graf--p">
                  In order to find the activities that the user is doing at a particular moment, you have to constantly communicate with the sensors of the mobile and after collecting the data, you have to use some Machine Learning algorithm to find which activity the user is currently doing. But hold on! do we need to learn Machine Learning algorithms to recognize the activities that the user is doing? No no, you need not learn any Machine Learning algorithm for detecting the Activities.
                 </p>
                 <p class="graf--p">
                  In Android, we have the Activity Recognition Client that wakes up your device at a regular interval and then collects the data from the device’s sensor and after that this collected data will be used to determine the Activities with the help of some Machine Learning algorithm. All you need to do is use the
                  <b class="graf--bold">
                   Activity Recognition Client
                  </b>
                  and the API will do the rest for you.
                 </p>
                 <p class="graf--p">
                  The Activity Recognition Client returns a list of activities that a user might be doing with some confidence percentage. This confidence percentage tells you about the surety of the activity. For example, the activity which is having more than 75% confidence, then there is a probability that the user might be doing that activity. So the confidence parameter tells you the probability of an activity being done by the user.
                 </p>
                 <h4 class="graf--h3">
                  Activities detected by the Activity Recognition Client
                 </h4>
                 <p class="graf--p">
                  The Activity Recognition Client determines a list of Activities that a user can perform and the API can detect. Following are the activities that can be detected by the Activity Recognition Client:
                 </p>
                 <ul>
                  <li>
                   <b class="graf--bold">
                    STILL:
                   </b>
                   When the mobile device will be still i.e. the user is either sitting at some place or the mobile device is having no motion, then the
                   <b class="graf--bold">
                    Activity Recognition Client
                   </b>
                   will detect the
                   <b class="graf--bold">
                    STILL
                   </b>
                   activity.
                  </li>
                  <li>
                   <b class="graf--bold">
                    ON_FOOT:
                   </b>
                   When the mobile device is moving at a normal speed i.e. the user carrying the mobile device is either walking or running then the
                   <b class="graf--bold">
                    Activity Recognition Client
                   </b>
                   will detect the
                   <b class="graf--bold">
                    ON_FOOT
                   </b>
                   activity.
                  </li>
                  <li>
                   <b class="graf--bold">
                    WALKING:
                   </b>
                   This is a sub-activity of the
                   <b class="graf--bold">
                    ON_FOOT
                   </b>
                   activity which is detected by the Activity Recognition Client when the user carrying the mobile device is walking.
                  </li>
                  <li>
                   <b class="graf--bold">
                    RUNNING:
                   </b>
                   This is also a sub-activity of
                   <b class="graf--bold">
                    ON_FOOT
                   </b>
                   activity which is detected by the Activity Recognition Client when the user carrying the mobile device is running.
                  </li>
                  <li>
                   <b class="graf--bold">
                    IN_VEHICLE:
                   </b>
                   This activity detected when the mobile device is in the bus or car or some other kind of vehicle or the user holding the mobile device is present in the vehicle.
                  </li>
                  <li>
                   <b class="graf--bold">
                    ON_BICYCLE:
                   </b>
                   When the device is on the bicycle or the user carrying the mobile is on a bicycle then this activity will be detected.
                  </li>
                  <li>
                   <b class="graf--bold">
                    TILTING:
                   </b>
                   When the mobile device is being lifted and is having some angle with the flat surface then the Activity Recognition Client will detect this activity.
                  </li>
                  <li>
                   <b class="graf--bold">
                    UNKNOWN:
                   </b>
                   The Activity Recognition Client will show this result when the device is unable to detect any activity on the mobile device.
                  </li>
                 </ul>
                 <h4 class="graf--h3">
                  Activity Recognition example
                 </h4>
                 <p class="graf--p">
                  We have learned the concept of Activity Recognition Client. Now, the time is for some practical session :) Let’s have one example of Activity Recognition Client to understand the concept of Activity Recognition in a better way. So, let’s do one example.
                 </p>
                 <p class="graf--p">
                  Open Android Studio and create a project with Empty Activity template.
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Adding dependencies and permissions
                  </b>
                 </p>
                 <p class="graf--p">
                  The Activity Recognition Client requires the dependency of Google Play Services. So, to add the dependency of Google Play Services, add the below line in your app level
                  <b class="graf--bold">
                   <i class="graf--italic">
                    build.gradle
                   </i>
                  </b>
                  file:
                 </p>
                 <pre><code class="language-java graf graf--code">implementation 'com.google.android.gms:play-services-location:16.0.0'</code></pre>
                 <p class="graf--p">
                  After adding the dependency of Google Play Services, add the permission of ACTIVITY_RECOGNITION in the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    AndroidManifest.xml
                   </i>
                  </b>
                  file:
                 </p>
                 <pre><code class="language-java graf graf--code">&lt;uses-permission android:name="com.google.android.gms.permission.ACTIVITY_RECOGNITION" /&gt;</code></pre>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Adding the UI of the application
                  </b>
                 </p>
                 <p class="graf--p">
                  So, the process of adding the dependencies and permissions are done. Now the next step is to add the UI for our Main Activity. In our application, we will be having one
                  <b class="graf--bold">
                   TextView
                  </b>
                  to display the name of current activity and one
                  <b class="graf--bold">
                   TextView
                  </b>
                  to display the confidence precentage of  Activity. So, the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    activity_main.xml
                   </i>
                  </b>
                  file looks something like this:
                 </p>
                 <pre><code class="language-java graf graf--code">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;android.support.constraint.ConstraintLayout xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    xmlns:android="http://schemas.android.com/apk/res/android"&gt;

    &lt;TextView
        android:id="@+id/txt_activity"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_margin="24dp"
        android:layout_marginStart="8dp"
        android:layout_marginLeft="8dp"
        android:layout_marginEnd="8dp"
        android:layout_marginRight="8dp"
        android:layout_marginBottom="48dp"
        android:textAllCaps="true"
        android:textColor="@color/colorPrimary"
        android:textSize="18dp"
        android:textStyle="bold"
        app:layout_constraintBottom_toTopOf="@+id/txt_confidence"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent" /&gt;

    &lt;TextView
        android:id="@+id/txt_confidence"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:layout_margin="24dp"
        android:layout_marginStart="8dp"
        android:layout_marginLeft="8dp"
        android:textAllCaps="true"
        android:textSize="14dp"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent" /&gt;

    &lt;Button
        android:id="@+id/btn_start_tracking"
        android:layout_width="240dp"
        android:layout_height="wrap_content"
        android:layout_marginStart="8dp"
        android:layout_marginLeft="8dp"
        android:layout_marginEnd="8dp"
        android:layout_marginRight="8dp"
        android:layout_marginBottom="8dp"
        android:text="Start Tracking"
        app:layout_constraintBottom_toTopOf="@+id/btn_stop_tracking"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent" /&gt;

    &lt;Button
        android:id="@+id/btn_stop_tracking"
        android:layout_width="240dp"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentBottom="true"
        android:layout_marginStart="8dp"
        android:layout_marginLeft="8dp"
        android:layout_marginEnd="8dp"
        android:layout_marginRight="8dp"
        android:layout_marginBottom="8dp"
        android:text="Stop Tracking"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent" /&gt;

&lt;/android.support.constraint.ConstraintLayout&gt;</code></pre>
                 <p class="graf--p">
                  Now, add the strings values in the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    res/values/strings.xml
                   </i>
                  </b>
                  file:
                 </p>
                 <pre><code class="language-java graf graf--code">&lt;resources&gt;
    &lt;string name="app_name"&gt;Activity Recognition&lt;/string&gt;
    &lt;string name="activity_in_vehicle"&gt;In Vehicle&lt;/string&gt;
    &lt;string name="activity_on_bicycle"&gt;On Bicycle&lt;/string&gt;
    &lt;string name="activity_on_foot"&gt;On Foot&lt;/string&gt;
    &lt;string name="activity_running"&gt;Running&lt;/string&gt;
    &lt;string name="activity_still"&gt;Still&lt;/string&gt;
    &lt;string name="activity_tilting"&gt;Tilting&lt;/string&gt;
    &lt;string name="activity_walking"&gt;walking&lt;/string&gt;
    &lt;string name="activity_unknown"&gt;Unknown&lt;/string&gt;
&lt;/resources&gt;</code></pre>
                 <p class="graf--p">
                  Now, we are done with the UI part of our Main Activity. Now, let's move on to the coding part of our application.
                 </p>
                 <p class="graf--p">
                  So, we are totally done with the UI part of our application. Now let’s move on to the coding part.
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Creating an IntentService
                  </b>
                 </p>
                 <p class="graf--p">
                  After making the UI of the application, our next task is to create a class that will be extended from the IntentService. This class will return a list of probable activities that can be performed by the user or the activity that the user is currently doing i.e. WALKING, RUNNING, ON_FOOT, etc. The code of my DetectedActivitiesIntentService is:
                 </p>
                 <pre><code class="language-java graf graf--code">class DetectedActivitiesIntentService : IntentService(TAG) {

    override fun onCreate() {
        super.onCreate()
    }

    override fun onHandleIntent(intent: Intent?) {
        val result = ActivityRecognitionResult.extractResult(intent)

        // Get the list of the probable activities associated with the current state of the
        // device. Each activity is associated with a confidence level, which is an int between
        // 0 and 100.
        val detectedActivities = result.probableActivities as ArrayList&lt;*&gt;

        for (activity in detectedActivities) {
            broadcastActivity(activity as DetectedActivity)
        }
    }

    private fun broadcastActivity(activity: DetectedActivity) {
        val intent = Intent(MainActivity.BROADCAST_DETECTED_ACTIVITY)
        intent.putExtra("type", activity.type)
        intent.putExtra("confidence", activity.confidence)
        LocalBroadcastManager.getInstance(this).sendBroadcast(intent)
    }

    companion object {

        protected val TAG = DetectedActivitiesIntentService::class.java.simpleName
    }
}// Use the TAG to name the worker thread.</code></pre>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Activity Running in Background
                  </b>
                 </p>
                 <p class="graf--p">
                  Our next step is to write the code for the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    MainActivity.kt
                   </i>
                  </b>
                  file. But before that, the thing that should be kept in mind is the battery performance. If you want your Activity Recognition Client to update the activities in a regular interval or in a frequent manner then this will reduce the battery performance of your mobile device. Also, if you want your application to continuously track the ongoing activity, then it is a good task to run your Application in background. But at the same time, the battery consumption should be take care of.
                 </p>
                 <p class="graf--p">
                  So, make a class that will detect the Activities in background. Here is the code:
                 </p>
                 <pre><code class="language-java graf graf--code">class BackgroundDetectedActivitiesService : Service() {

    private lateinit var mIntentService: Intent
    private lateinit var mPendingIntent: PendingIntent
    private lateinit var mActivityRecognitionClient: ActivityRecognitionClient

    internal var mBinder: IBinder = LocalBinder()

    inner class LocalBinder : Binder() {
        val serverInstance: BackgroundDetectedActivitiesService
            get() = this@BackgroundDetectedActivitiesService
    }

    override fun onCreate() {
        super.onCreate()
        mActivityRecognitionClient = ActivityRecognitionClient(this)
        mIntentService = Intent(this, DetectedActivitiesIntentService::class.java)
        mPendingIntent = PendingIntent.getService(this, 1, mIntentService, PendingIntent.FLAG_UPDATE_CURRENT)
        requestActivityUpdatesButtonHandler()
    }

    override fun onBind(intent: Intent): IBinder? {
        return mBinder
    }

    override fun onStartCommand(intent: Intent, flags: Int, startId: Int): Int {
        super.onStartCommand(intent, flags, startId)
        return Service.START_STICKY
    }

    fun requestActivityUpdatesButtonHandler() {
        val task = mActivityRecognitionClient?.requestActivityUpdates(
                MainActivity.DETECTION_INTERVAL_IN_MILLISECONDS,
                mPendingIntent)

        task?.addOnSuccessListener {
            Toast.makeText(applicationContext,
                    "Successfully requested activity updates",
                    Toast.LENGTH_SHORT)
                    .show()
        }

        task?.addOnFailureListener {
            Toast.makeText(applicationContext,
                    "Requesting activity updates failed to start",
                    Toast.LENGTH_SHORT)
                    .show()
        }
    }

    fun removeActivityUpdatesButtonHandler() {
        val task = mActivityRecognitionClient?.removeActivityUpdates(
                mPendingIntent)
        task?.addOnSuccessListener {
            Toast.makeText(applicationContext,
                    "Removed activity updates successfully!",
                    Toast.LENGTH_SHORT)
                    .show()
        }

        task?.addOnFailureListener {
            Toast.makeText(applicationContext, "Failed to remove activity updates!",
                    Toast.LENGTH_SHORT).show()
        }
    }

    override fun onDestroy() {
        super.onDestroy()
        removeActivityUpdatesButtonHandler()
    }

    companion object {
        private val TAG = BackgroundDetectedActivitiesService::class.java?.getSimpleName()
    }
}</code></pre>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Code for MainActivity.kt
                  </b>
                 </p>
                 <p class="graf--p">
                  So, our final task is to write the code for
                  <b class="graf--bold">
                   <i class="graf--italic">
                    MainActivity.kt
                   </i>
                  </b>
                  file. Here,
                  <b class="graf--bold">
                   <i class="graf--italic">
                    BroadCastReceiver()
                   </i>
                  </b>
                  is used to receive the Activity Update from the user i.e. whenever there is a change in Activity, then the activity will be recived. Following is the code for
                  <b class="graf--bold">
                   <i class="graf--italic">
                    MainActivity.kt
                   </i>
                  </b>
                  file:
                 </p>
                 <pre><code class="language-java graf graf--code">class MainActivity : AppCompatActivity() {

    private val TAG = MainActivity::class.java.simpleName
    internal lateinit var broadcastReceiver: BroadcastReceiver

    private lateinit var txtActivity: TextView
    private lateinit var txtConfidence: TextView
    private lateinit var btnStartTrcking: Button
    private lateinit var btnStopTracking: Button

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        txtActivity = findViewById(R.id.txt_activity)
        txtConfidence = findViewById(R.id.txt_confidence)
        btnStartTrcking = findViewById(R.id.btn_start_tracking)
        btnStopTracking = findViewById(R.id.btn_stop_tracking)

        btnStartTrcking?.setOnClickListener { startTracking() }

        btnStopTracking?.setOnClickListener { stopTracking() }

        broadcastReceiver = object : BroadcastReceiver() {
            override fun onReceive(context: Context, intent: Intent) {
                if (intent.action == MainActivity.BROADCAST_DETECTED_ACTIVITY) {
                    val type = intent.getIntExtra("type", -1)
                    val confidence = intent.getIntExtra("confidence", 0)
                    handleUserActivity(type, confidence)
                }
            }
        }

        startTracking()
    }

    private fun handleUserActivity(type: Int, confidence: Int) {
        var label = getString(R.string.activity_unknown)

        when (type) {
            DetectedActivity.IN_VEHICLE -&gt; {
                label = "You are in Vehicle"
            }
            DetectedActivity.ON_BICYCLE -&gt; {
                label = "You are on Bicycle"
            }
            DetectedActivity.ON_FOOT -&gt; {
                label = "You are on Foot"
            }
            DetectedActivity.RUNNING -&gt; {
                label = "You are Running"
            }
            DetectedActivity.STILL -&gt; {
                label = "You are Still"
            }
            DetectedActivity.TILTING -&gt; {
                label = "Your phone is Tilted"
            }
            DetectedActivity.WALKING -&gt; {
                label = "You are Walking"
            }
            DetectedActivity.UNKNOWN -&gt; {
                label = "Unkown Activity"
            }
        }

        Log.e(TAG, "User activity: $label, Confidence: $confidence")

        if (confidence &gt; MainActivity.CONFIDENCE) {
            txtActivity?.text = label
            txtConfidence?.text = "Confidence: $confidence"
        }
    }

    override fun onResume() {
        super.onResume()

        LocalBroadcastManager.getInstance(this).registerReceiver(broadcastReceiver,
                IntentFilter(MainActivity.BROADCAST_DETECTED_ACTIVITY))
    }

    override fun onPause() {
        super.onPause()

        LocalBroadcastManager.getInstance(this).unregisterReceiver(broadcastReceiver)
    }

    private fun startTracking() {
        val intent = Intent(this@MainActivity, BackgroundDetectedActivitiesService::class.java)
        startService(intent)
    }

    private fun stopTracking() {
        val intent = Intent(this@MainActivity, BackgroundDetectedActivitiesService::class.java)
        stopService(intent)
    }

    companion object {

        val BROADCAST_DETECTED_ACTIVITY = "activity_intent"

        internal val DETECTION_INTERVAL_IN_MILLISECONDS: Long = 1000

        val CONFIDENCE = 70
    }
}</code></pre>
                 <p class="graf--p">
                  Now, run the application and you will get the list of activities along with the confidence of the activity.
                 </p>
                 <h4 class="graf--h3">
                  Conclusion
                 </h4>
                 <p class="graf--p">
                  In this blog, we learned how to use the Activity Recognition Client in our application to determine the activities that users are doing at any instant of time. The Activity Recognition Client determines the ongoing Activities with some confidence percentage that tells you which activity is currently going on.
                 </p>
                 <p class="graf--p">
                  So, that’s it for this blog. Keep Learning :)
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Team MindOrks!
                  </b>
                 </p>
                </div>
               </div>
              </div>
             </section>
            </div>
           </div>
          </div>
         </article>
        </div>
       </div>
       <div class="ui divider">
       </div>
      </div>
      <div class="stretched fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui large center aligned header" style="padding-top:20px">
        Recommended for You
       </div>
      </div>
      <div class="fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui centered grid">
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/understanding-activity-aliases-in-android-to-preserve-your-launchers/">
          <img alt="Understanding Activity Aliases in Android To Preserve Your Launchers" class="ui centered image" src="/images/activity-aliases-in-android-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Understanding Activity Aliases in Android To Preserve Your Launchers
           </div>
           <div class="meta">
            17th June 2019
           </div>
           <div class="description">
            In this blog, we will learn the concept of Activity Aliases in Android. Activity Aliases are used to preserve the Launchers whenever there is a change in the Launcher Activity name. Generally, when we create a shortcut on our home screen and if we change the Launcher Activity, then the shortcut will be removed from the home screen. So, let's find how to deal with this.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/how-to-create-a-transparent-activity-in-android/">
          <img alt="How to create a Transparent Activity in Android?" class="ui centered image" src="/images/transparent-activity-in-android-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            How to create a Transparent Activity in Android?
           </div>
           <div class="meta">
            22nd July 2019
           </div>
           <div class="description">
            In this blog, we will learn how to create a Transparent activity in Android. By using Transparent activity, your app will be launched but nothing will be displayed in the background of the window.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/android-activity-lifecycle/">
          <img alt="Android Activity Lifecycle" class="ui centered image" src="/images/android-activity-lifecycle-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Android Activity Lifecycle
           </div>
           <div class="meta">
            3rd January 2019
           </div>
           <div class="description">
            In this blog, we will learn about Activities in Android and the lifecycle of activity in detail. We will also see the real example use-cases of Activity Lifecycle
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/detecting-and-fixing-memory-leaks-in-android/">
          <img alt="Detecting and fixing memory leaks in android" class="ui centered image" src="https://s3.ap-south-1.amazonaws.com/mindorks/blogs/detecting-and-fixing-memory-leaks-in-android.jpg" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Detecting and fixing memory leaks in android
           </div>
           <div class="meta">
            27th August 2017
           </div>
           <div class="description">
            Many a time we see ANR dialog while using android apps, lags in our apps, we also see OutOfMemoryError in Android Studio while building apps. All these kinds of stuff happen due to memory leaks.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/android-fragments-and-its-lifecycle/">
          <img alt="Android  Fragments and its Lifecycle" class="ui centered image" src="/images/android_fragments_mindorks_feature_image.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Android  Fragments and its Lifecycle
           </div>
           <div class="meta">
            3rd January 2019
           </div>
           <div class="description">
            Android Fragments
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/what-is-android-jetpack-and-why-should-we-use-it/">
          <img alt="What is Android Jetpack and why should we use it?" class="ui centered image" src="/images/android-jetpack.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            What is Android Jetpack and why should we use it?
           </div>
           <div class="meta">
            4th January 2019
           </div>
           <div class="description">
            What is Android Jetpack and why should we use it? Benefits of Android Jetpack. Build high quality, robust apps using the Android Jetpack. Android Jetpack is a collection of Android software components which helps us in building great Android apps.
           </div>
          </div>
         </a>
        </div>
       </div>
      </div>
     </div>
    </div>
    <div style="background:#fff">
     <footer class="content-container">
      <div class="ui centered padded grid" style="padding-top:40px;background:linear-gradient(to right,#c4e0e0,#e5f1f1)">
       <h2 class="ui huge icon center aligned header">
        <div class="content">
         Connect With Your Mentors
        </div>
       </h2>
       <div class="centered row">
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Janishar Ali" class="ui medium circular image" src="/assets/ali.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://janisharali.com" target="_blank">
             Janishar Ali
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://janisharali.com" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/janisharali" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Amit Shekhar" class="ui medium circular image" src="/assets/amit.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://amitshekhar.me" target="_blank">
             Amit Shekhar
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://amitshekhar.me" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/amitiitbhu" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div class="ui divider" style="margin:unset">
      </div>
      <h5 class="ui header" style="padding:16px;margin:unset;color:#555">
       <i aria-hidden="true" class="copyright icon">
       </i>
       <div class="content">
        Copyright 2022, MindOrks Nextgen Private Limited
       </div>
      </h5>
     </footer>
    </div>
   </div>
  </div>
  <script type="text/javascript">
   window.hljs.initHighlightingOnLoad()
  </script>
 </body>
</html>