<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title>
   Desugaring in Android
  </title>
  <meta charset="utf-8"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="minimum-scale=1,initial-scale=1,width=device-width,shrink-to-fit=no" name="viewport"/>
  <link href="https://blog.mindorks.com/desugaring-in-android" rel="canonical"/>
  <meta content="986249072156-dabps0lf90smluddrk5rkqsdjghk3hd3.apps.googleusercontent.com" name="google-signin-client_id"/>
  <meta content="android, learn android app development, android app development courses, android blogs, android tutorial" name="keywords"/>
  <meta content="Desugaring in Android" property="og:title"/>
  <meta content="website" property="og:type"/>
  <meta content="https://blog.mindorks.com/desugaring-in-android" property="og:url"/>
  <meta content="/images/desugaring-in-android-banner-bfa6e37065c3115c.jpg" property="og:image"/>
  <meta content="Backward compatibility is one of the most important aspects of Android development. Android has AppCompat views to provide this feature for its framework components. But what about compatibility when it comes to new Java libraries? Desugaring to the rescue! Check out the blog for more information." property="og:description"/>
  <meta content="Desugaring in Android" property="twitter:title"/>
  <meta content="Backward compatibility is one of the most important aspects of Android development. Android has AppCompat views to provide this feature for its framework components. But what about compatibility when it comes to new Java libraries? Desugaring to the rescue! Check out the blog for more information." name="twitter:description"/>
  <meta content="/images/desugaring-in-android-banner-bfa6e37065c3115c.jpg" name="twitter:image:src"/>
  <meta content="summary_large_image" name="twitter:card"/>
  <meta content="@MindorksNextGen" name="twitter:site"/>
  <meta content="Backward compatibility is one of the most important aspects of Android development. Android has AppCompat views to provide this feature for its framework components. But what about compatibility when it comes to new Java libraries? Desugaring to the rescue! Check out the blog for more information." name="description"/>
  <meta content="1620001391374687" property="fb:app_id"/>
  <link href="/styles/vendor-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link href="/styles/app-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link as="style" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" onload='this.onload=null,this.rel="stylesheet"' rel="preload"/>
  <noscript>
   <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
  </noscript>
  <script type="text/javascript">
   window.__PRELOADED_STATE__={toastr:{toastrs:[],confirm:null},blogData:{data:{},latestBlogs:null,isFetching:!0,isFetchingLatestBlogs:!1,currentCategory:"",categories:[]},contactData:{formData:{email:"",name:"",phone:"",message:"",isWriting:!1,isNameError:!1,isEmailError:!1,isPhoneError:!1,isMessageError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSending:!1},communityData:{formData:{email:"",isEmailError:!1,isWriting:!1,isSending:!1,dismissMsg:!1},successMessage:null,errorMessage:null},blogPageData:{blogId:495,data:{id:495,title:"Desugaring in Android",description:"Backward compatibility is one of the most important aspects of Android development. Android has AppCompat views to provide this feature for its framework components. But what about compatibility when it comes to new Java libraries? Desugaring to the rescue! Check out the blog for more information.",text:'<h1 class="graf--h1">Desugaring in Android</h1> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/desugaring-in-android-banner-bfa6e37065c3115c.jpg class=\'graf-image\' alt=\'Desugaring in Android\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">Since Kotlin became the recommended language for Android development, most of the developers have moved from Java to Kotlin. Kotlin has undoubtedly exceeded all the expectations and is now the favorite language for many. Speaking for myself and from an Android developer’s view-point, if someone asks me to switch back to Java, I’ll think a million times before giving up all the perks provided by Kotlin-first APIs.</p><p class="graf--p">However, people at Oracle are constantly making efforts to improve Java. For instance, Java 10’s <b class="graf--bold">var</b> feature to declare variables and Java 8’s <span class=""><a class="markup--anchor" target="_blank" href="https://developer.android.com/reference/java/time/package-summary">time API</a></span> &amp; <span class=""><a class="markup--anchor" target="_blank" href="https://developer.android.com/reference/java/util/stream/package-summary">stream API</a></span>. Time API actually has a ton of improvements than the classic DateTime API such as <b class="graf--bold">Duration</b>, <b class="graf--bold">Period</b>, and more. I’ll leave that part for you to explore and now let’s talk about what desugaring is &amp; what it has to do with all this stuff.</p><h4 class="graf--h3"><b class="graf--bold">What is Desugaring?</b></h4><p class="graf--p">When any new Android OS is developed, it is shipped with a bunch of Java classes that provide support to the apps requiring those classes to function. Let’s consider the Time API in this case. It was added to the Android API level 26 and hence, the apps using this library will crash on lower API levels such as Marshmallow (API 23).</p><p class="graf--p">Here’s when <b class="graf--bold">desugaring</b> comes into the picture. It allows lower API levels to work with new Java libraries. We’ll see how it does the trick but before that, let’s fire up Android Studio for a quick demo to make things more clear.</p><h4 class="graf--h3"><b class="graf--bold">Practical</b></h4><p class="graf--p">Keeping it short and simple, I’ll just print out the current month using the new Time API and I’ll test it on Android R (API 30) and Android M (API 23).</p><pre><code class="language-java graf graf--code">tv_month.text = LocalDate.now().month.name</code></pre> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/desugaring-in-android-api-30-de8e303cf4bd1a36.png class=\'graf-image\' alt=\'Desugaring in Android\' />\n\t\t\t\t\t\t\t\t</div > <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/desugaring-in-android-crash-320710ba1aaf6fff.png class=\'graf-image\' alt=\'Desugaring in Android\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">As expected, it works on API 30 but fails with a <b class="graf--bold">NoClassDefFoundError</b> exception on API 23. To fix this, we need to enable desugaring in our project using the following steps.</p><ul><li>Set Android gradle plugin to <b class="graf--bold">4.0</b> or higher.</li><li>In compile options, enable <b class="graf--bold">coreLibraryDesugaringEnabled</b> flag and set Java <b class="graf--bold">target &amp; source compatibilities</b> to Java 8.</li><li>Enable <b class="graf--bold">multidex</b> (for projects supporting API level 20 or below)</li><li>Add the desugaring dependency</li></ul><pre><code class="language-java graf graf--code">coreLibraryDesugaring \'com.android.tools:desugar_jdk_libs:1.0.5\'</code></pre> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/desugaring-in-android-voila-22ba80656605dd9c.gif class=\'graf-image\' alt=\'Desugaring in Android\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">And voila! The app can now run on low-level APIs as well. Here’s the <span class=""><a class="markup--anchor" target="_blank" href="https://github.com/smokelaboratory/AndroidDesugaring">demo link</a></span> for you to play around with.</p><h4 class="graf--h3"><b class="graf--bold">Under the hood</b></h4><p class="graf--p">So what actually happened here? How did the missing Java classes in the OS suddenly show up? It’s all possible because of <b class="graf--bold">D8/R8</b> tools. Before jumping into how they do this trick, let’s get into a bit of history to understand what these tools exactly are.</p><h4 class="graf--h3">Exploring D8/R8</h4><p class="graf--p">Android developers have been using <b class="graf--bold">ProGuard</b> for a long time now and it has proved to be a “go-to” tool when it comes to code shrinking and obfuscation. Let’s see how code flows when using ProGuard.</p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/desugaring-in-android-proguard-flow-369a22679ccaadfd.png class=\'graf-image\' alt=\'Desugaring in Android\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">The source code is converted into bytecode by JVM. This bytecode is optimized by ProGuard and finally, it is converted into a dex executable by the dex compiler.</p><p class="graf--p">As the code has to pass through a couple of phases before it is bundled into APK, the build time increases. To reduce this time, Google introduced <b class="graf--bold">Jack &amp; Jill compiler</b> around 2015 which did the same thing but in a single phase.</p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/desugaring-in-android-jack-compiler-81220cf472e8dcff.png class=\'graf-image\' alt=\'Desugaring in Android\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">Due to constant advances in technology and tools, this solution wasn’t able to satisfy the emerging requirements. Hence, Google abandoned it around 2017 and they went back to the classic way of compilation. But this time, they rewrote the dex compiler and introduced a tool called <b class="graf--bold">D8</b>.</p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/desugaring-in-android-d8-flow-c389e70a26678292.png class=\'graf-image\' alt=\'Desugaring in Android\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">This proved to be very successful and was even able to support Kotlin’s growth. Google further introduced <b class="graf--bold">R8</b> code shrinker which basically is a combination of ProGuard and D8. This helped reduce a phase in the compilation process.</p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/desugaring-in-android-r8-flow-76b41451b1645b9d.png class=\'graf-image\' alt=\'Desugaring in Android\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">Uggh..! That’s a lot of theory, isn’t it?</p><p class="graf--p">Coming back to desugaring, the D8/R8 phase is the real magician that provides the missing Java classes. <i class="graf--italic">While converting our app’s source code into dex code, it also adds the dex code for new java libraries which are then finally bundled in the APK.</i> This process is represented in the following diagram.</p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/desugaring-in-android-desugaring-e6abd257b512c03d.jpg class=\'graf-image\' alt=\'Desugaring in Android\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">And that’s how older android API levels can use the new Java libraries!</p><h4 class="graf--h3"><b class="graf--bold">Conclusion</b></h4><p class="graf--p">Desugaring, in simple terms, is a tool to provide backward compatibility for new Java libraries. When we think of it, it’s a very simple concept but to understand it inside-out, we need to know some stuff that revolves around it. I hope you grabbed something useful out of this blog. See you in the next one, till then. Stay Safe!</p>',author:18510,img_url:"/images/desugaring-in-android-banner-bfa6e37065c3115c.jpg",blog_url:"desugaring-in-android",likes:0,rank:0,category:1,published_at:"12th August 2020"},author:{id:18510,name:"Sumeet Rukeja",google_profile_pic:"https://lh3.googleusercontent.com/a-/AOh14GhXmpEfummH4PjhEvNUA3SlcgghayX5fGWPCAAd=s96-c?sz=300",fb_profile_pic:null,profile_tagline:"Technology enthusiast, a F.R.I.E.N.D.S fan & a gamer",fb_profile_url:null,google_plus_profile_url:null,twitter_profile_url:"https://twitter.com/smokelaboratory",github_profile_url:"https://github.com/smokelaboratory",linkedin_profile_url:"https://www.linkedin.com/in/sumeet-rukeja-7a9b5711b"},isFetching:!1,similarBlogs:[{id:247,title:"Exploring Android ViewPager2 in Android",description:"As Google introduced a new ViewPager called the ViewPager2 with some cool features like vertical orientation, use of Recycler View and many more. So, in this blog, we will explore the new ViewPager2 with its implementation as well . ",author:14897,img_url:"/images/exploring-android-viewpager2-banner.png",blog_url:"exploring-android-view-pager2-in-android",likes:0,rank:0,category:1,published_at:"29th May 2019",score:.01835518702864647},{id:254,title:"Android KTX - Android development with Kotlin",description:"In this blog, we will learn how to implement the Android KTX feature of the Android Jetpack that was announced in the Google I/O 2018. We will learn how Kotlin will help us to write the same code and use the same APIs used in Java in a much easier and faster way.",author:14897,img_url:"/images/android-ktx-android-development-banner.png",blog_url:"android-ktx-android-development-with-kotlin",likes:0,rank:0,category:1,published_at:"27th May 2019",score:.01835518702864647},{id:274,title:"Implementing Easy Permissions in Android: Android Tutorial",description:"In this blog, we will learn how to implement Easy Permissions in Android. Easy Permissions are used to ask for permissions required by the application explicitly. These are used to ask users for permissions that are dangerous in nature and involves user privacy.",author:14897,img_url:"/images/implementing-easy-permissions-android-banner.png",blog_url:"implementing-easy-permissions-in-android-android-tutorial",likes:0,rank:0,category:1,published_at:"13th June 2019",score:.01835518702864647},{id:284,title:"Animation in Android - Android Tutorial",description:"In this blog, we will learn how to use Animation in our Andoird Application. Animations are used to convey the message in a better way. It helps in improving the user experience. So, this blog is all about Animations in Android. So, let's learn about Animation.",author:14897,img_url:"/images/animation-in-android-banner.png",blog_url:"animation-in-android-tutorial",likes:0,rank:0,category:1,published_at:"24th June 2019",score:.01835518702864647},{id:297,title:"Integrating Android Google’s reCAPTCHA in Android App",description:"In this blog, we will learn how to implement Google's reCAPTCHA in our Android application. reCAPTCHA is used to verify if the user is a Human Begin or some robot or bot.",author:17146,img_url:"/images/integrating-android-google-re-captcha-in-android-app-banner-d717bffad515418a.png",blog_url:"integrating-android-google-re-captcha-in-android-app",likes:0,rank:0,category:1,published_at:"18th July 2019",score:.01835518702864647},{id:351,title:"Using Android Sensors: Android Tutorial",description:"In this blog, we will learn how to use Android Sensors. There are various sensors present in our Android device and we can use them in our application. For example, we can use the temperature sensor in some weather app. So, let's learn about Android Sensors.",author:14897,img_url:"/images/using-android-sensors-android-tutorial-banner.png",blog_url:"using-android-sensors-android-tutorial",likes:0,rank:0,category:1,published_at:"30th September 2019",score:.01835518702864647}],isSimilarBlogsFetching:!1},loginData:{data:null,isLoggingIn:!1,isLoggingOut:!1,loginState:!1,isForcedLogout:!1,isTokenRefreshed:!1,isRedirectHome:!1,message:""},updatesData:{news:null,inspirations:null,isNewsFetching:!0,isInspirationsFetching:!0},blogEditorData:{blogId:null,blogDetailsFormData:{title:"",description:"",imgUrl:"",blogUrl:"",category:"",categories:[],isWriting:!1,isTitleError:!1,isDescriptionError:!1,isImgUrlError:!1,isBlogUrlError:!1,isCategoryError:!1,isUploadingImage:!1,uploadedImageUrl:null},editorState:null,editorText:null,successMessage:null,errorMessage:null,isSending:!1,isMsgToShow:!1,isPublished:!1,isSubmitted:!1,isDraft:!0,isEditOfExistingBlog:!1,isFetchingBlogCategories:!1,isUploadingImage:!1,uploadedImageUrl:null},myBlogsData:{data:null,isSubmittedBlogsFetching:!0,isDraftBlogsFetching:!0,isPublishedBlogsFetching:!0,successMessage:null,errorMessage:null,isMsgToShow:!1,tabNames:["drafts","submissions","published"],selectedTab:"drafts",isFetchingBlog:!1,isDeletingBlog:!1,openEditorPage:!1},profilePreviewData:{profile:null,blogs:null,isFetchingProfile:!1,isFetchingAuthorBlogs:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,isUserNotRegistered:!1,redirectToMyProfileEdit:!1},profileEditableData:{userId:null,name:null,fbProfilePicUrl:null,googleProfilePicUrl:null,profileFormData:{tagline:"",fbProfileUrl:"",googlePlusProfileUrl:"",twitterProfileUrl:"",githubProfileUrl:"",linkedinProfileUrl:"",isWriting:!1,isTaglineError:!1,isFbProfileUrlError:!1,isGooglePlusProfileUrlError:!1,isTwitterProfileUrlError:!1,isGithubProfileUrlError:!1,isLinkedinProfileUrlError:!1},isSavingProfile:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,redirectToProfilePreview:!1},submitBlogData:{formData:{email:"",name:"",link:"",isWriting:!1,isNameError:!1,isEmailError:!1,isLinkError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSubmitting:!1},advertisementsData:{data:{},isLoading:!1},recaptchaData:{verified:!1,successMessage:null,errorMessage:null},blogSearchData:{searches:null,isSearching:!1}}
  </script>
  <script async="" src="https://www.google-analytics.com/analytics.js" type="text/javascript">
  </script>
  <script type="text/javascript">
   window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-91686131-1","auto"),ga("require","cleanUrlTracker"),ga("require","eventTracker"),ga("require","impressionTracker"),ga("require","outboundLinkTracker"),ga("require","urlChangeTracker"),ga("require","maxScrollTracker"),ga("require","mediaQueryTracker"),ga("require","outboundFormTracker"),ga("require","outboundLinkTracker"),ga("require","pageVisibilityTracker"),ga("require","socialWidgetTracker"),ga("require","urlChangeTracker"),ga("send","pageview")
  </script>
  <script defer="defer" src="/assets/autotrack.js" type="text/javascript">
  </script>
  <script src="/assets/highlight.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/vendor-bundle-1.8.6.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/app-bundle-1.8.6.js" type="text/javascript">
  </script>
 </head>
 <body>
  <div id="root">
   <div class="screen app-load-content" data-reactroot="">
    <div class="ui centered grid">
     <div class="row" style="padding:0">
      <div class="ui fixed menu navbar huge borderless grid" style="background-color:#fff;height:60px">
      </div>
     </div>
     <div class="centered computer only row" style="padding:0">
      <div class="ui fixed top menu navbar huge borderless grid header-container" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="right menu">
        <a class="item" href="https://janisharali.com" target="_blank">
         Mentor Ali
        </a>
        <a class="item" href="https://amitshekhar.me" target="_blank">
         Mentor Amit
        </a>
       </div>
      </div>
     </div>
     <div class="tablet only mobile only row" style="padding:0">
      <div class="ui fixed top navbar huge menu borderless" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="item">
       </div>
      </div>
     </div>
    </div>
    <div class="header-height">
    </div>
    <div aria-live="assertive" class="redux-toastr">
     <div>
      <div class="top-left">
      </div>
      <div class="top-right">
      </div>
      <div class="top-center">
      </div>
      <div class="bottom-left">
      </div>
      <div class="bottom-right">
      </div>
      <div class="bottom-center">
      </div>
     </div>
    </div>
    <div class="content-container theme">
     <div class="ui centered one column grid" style="padding-bottom:80px;background-color:#fff">
      <div class="ten wide computer fifteen wide mobile fifteen wide tablet column" style="margin-top:50px">
       <div>
        <div class="blog-page-author">
         <div class="ui small header">
          <img alt="Sumeet Rukeja" class="ui circular image" src="https://lh3.googleusercontent.com/a-/AOh14GhXmpEfummH4PjhEvNUA3SlcgghayX5fGWPCAAd=s96-c?sz=300"/>
          <div class="content">
           Sumeet Rukeja
           <div class="sub header" style="margin-top:5px">
            12th August 2020
           </div>
          </div>
         </div>
        </div>
        <div id="content">
         <article class="template">
          <div class="postContent">
           <div class="notesSource">
            <div class="postField postField--body" id="editor">
             <section class="section--first section--last">
              <div class="section-divider layoutSingleColumn-template">
               <hr class="section-divider"/>
              </div>
              <div class="section-content">
               <div class="section-inner layoutSingleColumn-template">
                <div>
                 <h1 class="graf--h1">
                  Desugaring in Android
                 </h1>
                 <div class="graf-image graf-caption">
                  <img alt="Desugaring in Android" class="graf-image" src="/images/desugaring-in-android-banner-bfa6e37065c3115c.jpg"/>
                 </div>
                 <p class="graf--p">
                  Since Kotlin became the recommended language for Android development, most of the developers have moved from Java to Kotlin. Kotlin has undoubtedly exceeded all the expectations and is now the favorite language for many. Speaking for myself and from an Android developer’s view-point, if someone asks me to switch back to Java, I’ll think a million times before giving up all the perks provided by Kotlin-first APIs.
                 </p>
                 <p class="graf--p">
                  However, people at Oracle are constantly making efforts to improve Java. For instance, Java 10’s
                  <b class="graf--bold">
                   var
                  </b>
                  feature to declare variables and Java 8’s
                  <span class="">
                   <a class="markup--anchor" href="https://developer.android.com/reference/java/time/package-summary" target="_blank">
                    time API
                   </a>
                  </span>
                  &amp;
                  <span class="">
                   <a class="markup--anchor" href="https://developer.android.com/reference/java/util/stream/package-summary" target="_blank">
                    stream API
                   </a>
                  </span>
                  . Time API actually has a ton of improvements than the classic DateTime API such as
                  <b class="graf--bold">
                   Duration
                  </b>
                  ,
                  <b class="graf--bold">
                   Period
                  </b>
                  , and more. I’ll leave that part for you to explore and now let’s talk about what desugaring is &amp; what it has to do with all this stuff.
                 </p>
                 <h4 class="graf--h3">
                  <b class="graf--bold">
                   What is Desugaring?
                  </b>
                 </h4>
                 <p class="graf--p">
                  When any new Android OS is developed, it is shipped with a bunch of Java classes that provide support to the apps requiring those classes to function. Let’s consider the Time API in this case. It was added to the Android API level 26 and hence, the apps using this library will crash on lower API levels such as Marshmallow (API 23).
                 </p>
                 <p class="graf--p">
                  Here’s when
                  <b class="graf--bold">
                   desugaring
                  </b>
                  comes into the picture. It allows lower API levels to work with new Java libraries. We’ll see how it does the trick but before that, let’s fire up Android Studio for a quick demo to make things more clear.
                 </p>
                 <h4 class="graf--h3">
                  <b class="graf--bold">
                   Practical
                  </b>
                 </h4>
                 <p class="graf--p">
                  Keeping it short and simple, I’ll just print out the current month using the new Time API and I’ll test it on Android R (API 30) and Android M (API 23).
                 </p>
                 <pre><code class="language-java graf graf--code">tv_month.text = LocalDate.now().month.name</code></pre>
                 <div class="graf-image graf-caption">
                  <img alt="Desugaring in Android" class="graf-image" src="/images/desugaring-in-android-api-30-de8e303cf4bd1a36.png"/>
                 </div>
                 <div class="graf-image graf-caption">
                  <img alt="Desugaring in Android" class="graf-image" src="/images/desugaring-in-android-crash-320710ba1aaf6fff.png"/>
                 </div>
                 <p class="graf--p">
                  As expected, it works on API 30 but fails with a
                  <b class="graf--bold">
                   NoClassDefFoundError
                  </b>
                  exception on API 23. To fix this, we need to enable desugaring in our project using the following steps.
                 </p>
                 <ul>
                  <li>
                   Set Android gradle plugin to
                   <b class="graf--bold">
                    4.0
                   </b>
                   or higher.
                  </li>
                  <li>
                   In compile options, enable
                   <b class="graf--bold">
                    coreLibraryDesugaringEnabled
                   </b>
                   flag and set Java
                   <b class="graf--bold">
                    target &amp; source compatibilities
                   </b>
                   to Java 8.
                  </li>
                  <li>
                   Enable
                   <b class="graf--bold">
                    multidex
                   </b>
                   (for projects supporting API level 20 or below)
                  </li>
                  <li>
                   Add the desugaring dependency
                  </li>
                 </ul>
                 <pre><code class="language-java graf graf--code">coreLibraryDesugaring 'com.android.tools:desugar_jdk_libs:1.0.5'</code></pre>
                 <div class="graf-image graf-caption">
                  <img alt="Desugaring in Android" class="graf-image" src="/images/desugaring-in-android-voila-22ba80656605dd9c.gif"/>
                 </div>
                 <p class="graf--p">
                  And voila! The app can now run on low-level APIs as well. Here’s the
                  <span class="">
                   <a class="markup--anchor" href="https://github.com/smokelaboratory/AndroidDesugaring" target="_blank">
                    demo link
                   </a>
                  </span>
                  for you to play around with.
                 </p>
                 <h4 class="graf--h3">
                  <b class="graf--bold">
                   Under the hood
                  </b>
                 </h4>
                 <p class="graf--p">
                  So what actually happened here? How did the missing Java classes in the OS suddenly show up? It’s all possible because of
                  <b class="graf--bold">
                   D8/R8
                  </b>
                  tools. Before jumping into how they do this trick, let’s get into a bit of history to understand what these tools exactly are.
                 </p>
                 <h4 class="graf--h3">
                  Exploring D8/R8
                 </h4>
                 <p class="graf--p">
                  Android developers have been using
                  <b class="graf--bold">
                   ProGuard
                  </b>
                  for a long time now and it has proved to be a “go-to” tool when it comes to code shrinking and obfuscation. Let’s see how code flows when using ProGuard.
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="Desugaring in Android" class="graf-image" src="/images/desugaring-in-android-proguard-flow-369a22679ccaadfd.png"/>
                 </div>
                 <p class="graf--p">
                  The source code is converted into bytecode by JVM. This bytecode is optimized by ProGuard and finally, it is converted into a dex executable by the dex compiler.
                 </p>
                 <p class="graf--p">
                  As the code has to pass through a couple of phases before it is bundled into APK, the build time increases. To reduce this time, Google introduced
                  <b class="graf--bold">
                   Jack &amp; Jill compiler
                  </b>
                  around 2015 which did the same thing but in a single phase.
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="Desugaring in Android" class="graf-image" src="/images/desugaring-in-android-jack-compiler-81220cf472e8dcff.png"/>
                 </div>
                 <p class="graf--p">
                  Due to constant advances in technology and tools, this solution wasn’t able to satisfy the emerging requirements. Hence, Google abandoned it around 2017 and they went back to the classic way of compilation. But this time, they rewrote the dex compiler and introduced a tool called
                  <b class="graf--bold">
                   D8
                  </b>
                  .
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="Desugaring in Android" class="graf-image" src="/images/desugaring-in-android-d8-flow-c389e70a26678292.png"/>
                 </div>
                 <p class="graf--p">
                  This proved to be very successful and was even able to support Kotlin’s growth. Google further introduced
                  <b class="graf--bold">
                   R8
                  </b>
                  code shrinker which basically is a combination of ProGuard and D8. This helped reduce a phase in the compilation process.
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="Desugaring in Android" class="graf-image" src="/images/desugaring-in-android-r8-flow-76b41451b1645b9d.png"/>
                 </div>
                 <p class="graf--p">
                  Uggh..! That’s a lot of theory, isn’t it?
                 </p>
                 <p class="graf--p">
                  Coming back to desugaring, the D8/R8 phase is the real magician that provides the missing Java classes.
                  <i class="graf--italic">
                   While converting our app’s source code into dex code, it also adds the dex code for new java libraries which are then finally bundled in the APK.
                  </i>
                  This process is represented in the following diagram.
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="Desugaring in Android" class="graf-image" src="/images/desugaring-in-android-desugaring-e6abd257b512c03d.jpg"/>
                 </div>
                 <p class="graf--p">
                  And that’s how older android API levels can use the new Java libraries!
                 </p>
                 <h4 class="graf--h3">
                  <b class="graf--bold">
                   Conclusion
                  </b>
                 </h4>
                 <p class="graf--p">
                  Desugaring, in simple terms, is a tool to provide backward compatibility for new Java libraries. When we think of it, it’s a very simple concept but to understand it inside-out, we need to know some stuff that revolves around it. I hope you grabbed something useful out of this blog. See you in the next one, till then. Stay Safe!
                 </p>
                </div>
               </div>
              </div>
             </section>
            </div>
           </div>
          </div>
         </article>
        </div>
       </div>
       <div class="ui divider">
       </div>
      </div>
      <div class="stretched fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui large center aligned header" style="padding-top:20px">
        Recommended for You
       </div>
      </div>
      <div class="fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui centered grid">
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/exploring-android-view-pager2-in-android/">
          <img alt="Exploring Android ViewPager2 in Android" class="ui centered image" src="/images/exploring-android-viewpager2-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Exploring Android ViewPager2 in Android
           </div>
           <div class="meta">
            29th May 2019
           </div>
           <div class="description">
            As Google introduced a new ViewPager called the ViewPager2 with some cool features like vertical orientation, use of Recycler View and many more. So, in this blog, we will explore the new ViewPager2 with its implementation as well .
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/android-ktx-android-development-with-kotlin/">
          <img alt="Android KTX - Android development with Kotlin" class="ui centered image" src="/images/android-ktx-android-development-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Android KTX - Android development with Kotlin
           </div>
           <div class="meta">
            27th May 2019
           </div>
           <div class="description">
            In this blog, we will learn how to implement the Android KTX feature of the Android Jetpack that was announced in the Google I/O 2018. We will learn how Kotlin will help us to write the same code and use the same APIs used in Java in a much easier and faster way.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/implementing-easy-permissions-in-android-android-tutorial/">
          <img alt="Implementing Easy Permissions in Android: Android Tutorial" class="ui centered image" src="/images/implementing-easy-permissions-android-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Implementing Easy Permissions in Android: Android Tutorial
           </div>
           <div class="meta">
            13th June 2019
           </div>
           <div class="description">
            In this blog, we will learn how to implement Easy Permissions in Android. Easy Permissions are used to ask for permissions required by the application explicitly. These are used to ask users for permissions that are dangerous in nature and involves user privacy.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/animation-in-android-tutorial/">
          <img alt="Animation in Android - Android Tutorial" class="ui centered image" src="/images/animation-in-android-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Animation in Android - Android Tutorial
           </div>
           <div class="meta">
            24th June 2019
           </div>
           <div class="description">
            In this blog, we will learn how to use Animation in our Andoird Application. Animations are used to convey the message in a better way. It helps in improving the user experience. So, this blog is all about Animations in Android. So, let's learn about Animation.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/integrating-android-google-re-captcha-in-android-app/">
          <img alt="Integrating Android Google’s reCAPTCHA in Android App" class="ui centered image" src="/images/integrating-android-google-re-captcha-in-android-app-banner-d717bffad515418a.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Integrating Android Google’s reCAPTCHA in Android App
           </div>
           <div class="meta">
            18th July 2019
           </div>
           <div class="description">
            In this blog, we will learn how to implement Google's reCAPTCHA in our Android application. reCAPTCHA is used to verify if the user is a Human Begin or some robot or bot.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/using-android-sensors-android-tutorial/">
          <img alt="Using Android Sensors: Android Tutorial" class="ui centered image" src="/images/using-android-sensors-android-tutorial-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Using Android Sensors: Android Tutorial
           </div>
           <div class="meta">
            30th September 2019
           </div>
           <div class="description">
            In this blog, we will learn how to use Android Sensors. There are various sensors present in our Android device and we can use them in our application. For example, we can use the temperature sensor in some weather app. So, let's learn about Android Sensors.
           </div>
          </div>
         </a>
        </div>
       </div>
      </div>
     </div>
    </div>
    <div style="background:#fff">
     <footer class="content-container">
      <div class="ui centered padded grid" style="padding-top:40px;background:linear-gradient(to right,#c4e0e0,#e5f1f1)">
       <h2 class="ui huge icon center aligned header">
        <div class="content">
         Connect With Your Mentors
        </div>
       </h2>
       <div class="centered row">
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Janishar Ali" class="ui medium circular image" src="/assets/ali.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://janisharali.com" target="_blank">
             Janishar Ali
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://janisharali.com" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/janisharali" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Amit Shekhar" class="ui medium circular image" src="/assets/amit.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://amitshekhar.me" target="_blank">
             Amit Shekhar
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://amitshekhar.me" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/amitiitbhu" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div class="ui divider" style="margin:unset">
      </div>
      <h5 class="ui header" style="padding:16px;margin:unset;color:#555">
       <i aria-hidden="true" class="copyright icon">
       </i>
       <div class="content">
        Copyright 2022, MindOrks Nextgen Private Limited
       </div>
      </h5>
     </footer>
    </div>
   </div>
  </div>
  <script type="text/javascript">
   window.hljs.initHighlightingOnLoad()
  </script>
 </body>
</html>