<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title>
   Using R8 to reduce APK size in Android
  </title>
  <meta charset="utf-8"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="minimum-scale=1,initial-scale=1,width=device-width,shrink-to-fit=no" name="viewport"/>
  <link href="https://blog.mindorks.com/using-r8-to-reduce-apk-size-in-android" rel="canonical"/>
  <meta content="986249072156-dabps0lf90smluddrk5rkqsdjghk3hd3.apps.googleusercontent.com" name="google-signin-client_id"/>
  <meta content="android, learn android app development, android app development courses, android blogs, android tutorial" name="keywords"/>
  <meta content="Using R8 to reduce APK size in Android" property="og:title"/>
  <meta content="website" property="og:type"/>
  <meta content="https://blog.mindorks.com/using-r8-to-reduce-apk-size-in-android" property="og:url"/>
  <meta content="/images/using-r8-to-reduce-apk-size-in-android-banner.png" property="og:image"/>
  <meta content="In this blog, we will learn how to reduce the APK size in Android by using R8. Small-sized applications are more likely to be downloaded by the users as compared to the large sized APKs. So, let's find how to reduce the APK size." property="og:description"/>
  <meta content="Using R8 to reduce APK size in Android" property="twitter:title"/>
  <meta content="In this blog, we will learn how to reduce the APK size in Android by using R8. Small-sized applications are more likely to be downloaded by the users as compared to the large sized APKs. So, let's find how to reduce the APK size." name="twitter:description"/>
  <meta content="/images/using-r8-to-reduce-apk-size-in-android-banner.png" name="twitter:image:src"/>
  <meta content="summary_large_image" name="twitter:card"/>
  <meta content="@MindorksNextGen" name="twitter:site"/>
  <meta content="In this blog, we will learn how to reduce the APK size in Android by using R8. Small-sized applications are more likely to be downloaded by the users as compared to the large sized APKs. So, let's find how to reduce the APK size." name="description"/>
  <meta content="1620001391374687" property="fb:app_id"/>
  <link href="/styles/vendor-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link href="/styles/app-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link as="style" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" onload='this.onload=null,this.rel="stylesheet"' rel="preload"/>
  <noscript>
   <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
  </noscript>
  <script type="text/javascript">
   window.__PRELOADED_STATE__={toastr:{toastrs:[],confirm:null},blogData:{data:{},latestBlogs:null,isFetching:!0,isFetchingLatestBlogs:!1,currentCategory:"",categories:[]},contactData:{formData:{email:"",name:"",phone:"",message:"",isWriting:!1,isNameError:!1,isEmailError:!1,isPhoneError:!1,isMessageError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSending:!1},communityData:{formData:{email:"",isEmailError:!1,isWriting:!1,isSending:!1,dismissMsg:!1},successMessage:null,errorMessage:null},blogPageData:{blogId:372,data:{id:372,title:"Using R8 to reduce APK size in Android",description:"In this blog, we will learn how to reduce the APK size in Android by using R8. Small-sized applications are more likely to be downloaded by the users as compared to the large sized APKs. So, let's find how to reduce the APK size.",text:'<h1 class="graf--h1">Using R8 to reduce APK size in Android</h1> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/using-r8-to-reduce-apk-size-in-android-banner.png class=\'graf-image\' alt=\'Using R8 to reduce APK size in Android\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">Application size plays an important role in deciding whether your application will reach the next billion users or not. In most of the cases, the users have very less amount of space in their mobile phones. So, if your APK size is big then you will end up losing your users. It becomes an important task to reduce the APK size as much as possible.</p><blockquote class="graf--blockquote">Smaller APK size is always better.</blockquote><p class="graf--p">In this blog, we will learn how to reduce the APK size by using R8 in our application. The following topics will be covered in this blog:</p><ul><li>What is R8 Shrinking?</li><li>How to enable R8 Shrinking in your app?</li><li>How does Shrinking work?</li><li>Closing note</li></ul><p class="graf--p">So, let&#x27;s get started.</p><h4 class="graf--h3">What is R8 Shrinking?</h4><p class="graf--p">R8 shrinking is a process in which we reduce the amount of code of our application and by doing so, the APK size automatically gets reduced. So, reduced APK sized applications are more likely to be kept in people&#x27;s phone. All we need to do is reduce the class files(i.e. the code) written in our Android application.</p><p class="graf--p">To reduce the APK size, we have three different techniques: </p><ol type="1"><li><b class="graf--bold">Shrinking or Tree Shaking:</b> Shrinking is the process of removal of unreachable code from our Android project. It performs some static analysis to get rid of unreachable code and removes the uninstantiated object.</li><li><b class="graf--bold">Optimization:</b> This is used to optimize the code for size. It involves dead code removal, unused argument removal, selective inlining, class merging, etc.</li><li><b class="graf--bold">Identifier Renaming:</b> In this process, we obfuscate the class name and other variable names. For example, if the name of the class is &quot;MyAwesomeClass&quot;, then it will be obfuscated to &quot;a&quot; or something else but smaller in size.</li></ol><p class="graf--p">But many of you might be thinking that if I am making an application then why would I include some extra code if I am not going to use it? And as a result, if I am not including that unwanted code then how will R8 shrink the application size? So, what&#x27;s the reason behind using this R8 shrinking?</p><p class="graf--p">The answer is simple:</p><ul><li><b class="graf--bold">Third-party library:</b> Every application requires some kind of third-party libraries. But in your application, you might be using a small part of that third-party library and rest of the part is not useful for you. So, why to keep those lines of code? Without any shrinking, all the library codes will be retained in your app. Even if you are writing you app in Kotlin, then you have to include Kotlin Standard Library and this, in turn, increase your APK size.</li><li><b class="graf--bold">Code optimization:</b> Even if your application doesn&#x27;t have unwanted lines of code, you can still optimize the code written by you by using some optimization techniques like dead code removal, unused argument removal, selective inlining, class merging, etc.</li></ul><blockquote class="graf--blockquote">Note: You must be thinking that these things are already handled by Proguard, then why to use R8? The answer is simple, R8 works with Proguard rules and R8 shrinks the code <b class="graf--bold">faster</b> while improving the output size.</blockquote><h4 class="graf--h3">How to enable R8 Shrinking in your app?</h4><p class="graf--p">To enable R8 shrinking in your application, set the <code class="graf--code-inline">minifyEnabled</code> to <code class="graf--code-inline">true</code> in your app&#x27;s main <code class="graf--code-inline">build.gradle</code> file. </p><pre><code class="language-java graf graf--code">android {\n    ...\n    buildTypes {\n        release {\n            minifyEnabled false\n        }\n    }\n}</code></pre><p class="graf--p">Try to find the APK size by making a single Activity application and then by using R8 shrinking and after that check for the APK size by including some third-party library before and after using R8 shrinking. You will notice the difference in APK size.</p><p class="graf--p">But how does this shrinking work? Let&#x27;s find.</p><h4 class="graf--h3">How does Shrinking work?</h4><p class="graf--p">The algorithms used for APK size reduction traces the unreachable code and it removes those codes from the APK. This is done with the help of entry-points. So, R8 starts with this entry-point and goes down to all the reachable code and in the end, it removes the unreachable code. To define this entry-points, we have something called the keep rules that we generally write the R8 configuration in the <code class="graf--code-inline">proguard-rule</code> file. Let&#x27;s have an example of the same:</p><pre><code class="language-java graf graf--code">class com.mindorks.JavaHelloWorld {\n    //unreachable code\n    private void iAmUnused() {\n        System.out.println("I am of no use :( ");\n    }\n\n    //reachable code\n    private static void reachableExample() {\n        System.out.println("Hello, MindOrks :) ");\n    }\n\n    //main function\n    public static void main(String[] args) {\n        reachableExample();\n    }\n}</code></pre><p class="graf--p">And in the rule, we add:</p><pre><code class="language-java graf graf--code">//This is the entry point \n-keep class com.mindorks.JavaHelloWorld {\n    public static void main(java.lang.String[]); \n}</code></pre><p class="graf--p">In the above code, when the R8 shrinking starts, then the R8 will start tracing from the entry point i.e. the main function will be called and from the main function, the <b class="graf--bold"><i class="graf--italic">reachableExample()</i></b> method will be called and finally after printing &quot;Hello, MindOrks :)&quot; the tracing will be stopped. So, the <b class="graf--bold"><i class="graf--italic">iAmUnused()</i></b> method is unreachable and it will be removed. Also, at the same time, the name of the method <i class="graf--italic">rechableExample()</i> will get reduced to something shorter like <i class="graf--italic">a()</i> or <i class="graf--italic">b()</i>. And finally, R8 can inline the code of the <i class="graf--italic">reachableExample()</i> in the main function. So, the final code will be:</p><pre><code class="language-java graf graf--code">class com.mindorks.JavaHelloWorld {\n    \n    //main function\n    public static void main(String[] args) {\n        System.out.println("Hello, MindOrks :) ");\n    }\n}</code></pre><p class="graf--p">Similarly, in Android, we can have various entry points like Activities, Services, Content Providers, Broadcast receivers and to handle these entry points, aapt2 tool is used. For example, in our manifest file, we define MainActivity or other activity as our entry point.</p><p class="graf--p">Apart from these entry points provided by aapt2 tools, there are several other things that are required for the Android Platform and these are provided by the Android Studio in the configuration file. Add the below line in your app&#x27;s main <b class="graf--bold"><i class="graf--italic">build.gradle</i></b> file:</p><pre><code class="language-java graf graf--code">minifyEnabled true\nproguardFiles getDefaultProguardFile(\'proguard-android-optimize.txt\')</code></pre><p class="graf--p">But, there is one problem, when your code contains some reflection code then it is not recognized by R8 by tracing the code. So, it removes that code also and it should not do that. For example,</p><pre><code class="language-java graf graf--code">class Company(val name: String)\n\nfun printJson() {\n    val myGson: Gson()\n    val compnay = Company("MindOrks")\n    print(myGson.toJson(compnay))\n}\n\n//output: {}</code></pre><p class="graf--p">In the above code, the output is an empty JSON object. This is because the filed &quot;name&quot; is written but never read. Here Gson uses reflection techniques, so R8 doesn&#x27;t see that this field is actually read and removes the code.  So, to avoid this you have to have some keep rules that will tell the R8 to keep the value named &quot;name&quot; and don&#x27;t delete that. Generally, we put all these keep rules in a file called <code class="graf--code-inline">proguard-rules.pro</code> and add the below lines in your app&#x27;s main <b class="graf--bold"><i class="graf--italic">build.gradle</i></b> file:</p><pre><code class="language-java graf graf--code">minifyEnabled true\nproguardFiles getDefaultProguardFile(\'proguard-android-optimize.txt\'), \n        \'proguard-rules.pro\'</code></pre><p class="graf--p">You can read more about Proguard from <a class="markup--anchor" target="_blank" href="https://blog.mindorks.com/applying-proguard-in-an-android-application">here</a>.</p><h4 class="graf--h3">Closing note</h4><p class="graf--p">In this blog, we learned how to reduce the APK size by using R8 in our application. As the app size matters a lot. So, use R8 to reduce that app size and it is easy to implement.</p><p class="graf--p">Hope you learned something new today.</p><p class="graf--p">Have a look at our Android tutorials <b class="graf--bold"><a class="markup--anchor" target="_blank" href="https://mindorks.com/android-tutorial">here</a></b>.</p><p class="graf--p">Do share this blog with your fellow developers to spread the knowledge. You can read more blogs on Android on our <a class="markup--anchor" target="_blank" href="https://blog.mindorks.com/">bloggi</a><a class="markup--anchor" target="_blank" href="https://blog.mindorks.com/">ng website</a>.</p><p class="graf--p"><b class="graf--bold"><a class="markup--anchor" target="_blank" href="https://bootcamp.mindorks.com/">Apply Now: MindOrks Android Online Course and Learn Advanced Android</a></b></p><p class="graf--p">Happy Learning :)</p><p class="graf--p"><b class="graf--bold">Team MindOrks!</b></p>',author:17146,img_url:"/images/using-r8-to-reduce-apk-size-in-android-banner.png",blog_url:"using-r8-to-reduce-apk-size-in-android",likes:0,rank:0,category:1,published_at:"30th October 2019"},author:{id:17146,name:"Sumit Mishra",google_profile_pic:"https://lh3.googleusercontent.com/a-/AOh14GiHP4JrkmlLjuz_uG1g4E0MhTUClSNytqB8o-pxCA=s96-c?sz=300",fb_profile_pic:null,profile_tagline:"Software Development Engineer at MindOrks",fb_profile_url:"https://www.facebook.com/mishra3452",google_plus_profile_url:null,twitter_profile_url:"https://twitter.com/hiii_sumit",github_profile_url:"https://github.com/mishra3452",linkedin_profile_url:"https://www.linkedin.com/in/sumit-mishra-a15499135/"},isFetching:!1,similarBlogs:[{id:493,title:"How to reduce APK size in Android?",description:"Bloated APKs have a higher chance of uninstalls or getting rejected by the customers. This blog describes how to optimize apk size in Android.",author:3003,img_url:"/images/optimize-android-apk-banner-c07d71b4b0c45adc.png",blog_url:"how-to-reduce-apk-size-in-android-2f3713d2d662",likes:0,rank:0,category:1,published_at:"6th August 2020",score:10.312633514404297},{id:88,title:"How to create multiple apk files for android application",description:"Too many android devices and much more to come and among them, various different CPU architectures and different screen densities devices are there. Making single apk with all device compatible, increases your apk size, as it has resources for every device.",author:30,img_url:"https://s3.ap-south-1.amazonaws.com/mindorks/blogs/how-to-create-multiple-apk-files-for-android-application.jpg",blog_url:"how-to-create-multiple-apk-files-for-android-application",likes:0,rank:0,category:1,published_at:"30th August 2017",score:3.138566493988037},{id:351,title:"Using Android Sensors: Android Tutorial",description:"In this blog, we will learn how to use Android Sensors. There are various sensors present in our Android device and we can use them in our application. For example, we can use the temperature sensor in some weather app. So, let's learn about Android Sensors.",author:14897,img_url:"/images/using-android-sensors-android-tutorial-banner.png",blog_url:"using-android-sensors-android-tutorial",likes:0,rank:0,category:1,published_at:"30th September 2019",score:.3374535143375397},{id:234,title:"Push Notifications in Android Using FCM",description:"In this blog, we will learn using Push Notifications in Android Device using FCM. We will learn how to integrate the push notification feature in the app from scratch and handle the message as well.",author:14897,img_url:"/images/fcm.jpg",blog_url:"pushing-notifications-in-android-using-fcm",likes:0,rank:0,category:1,published_at:"15th May 2019",score:.3282759189605713},{id:238,title:"Using Custom and Downloadable Fonts in Android",description:"In this blog, we will learn how to use custom and downloadable fonts in android that was introduced in Android 8.0. Now there is no need of writing some piece of code for using the fonts. Also you can choose from any of the thousands of fonts on Google Fonts and use them in your app.",author:14897,img_url:"/images/downloadable-font-banner.png",blog_url:"using-custom-and-downloadable-fonts-in-android",likes:0,rank:0,category:1,published_at:"16th May 2019",score:.3282759189605713},{id:244,title:"Using Swipe-to-refresh in Android Application",description:"In this blog, we will be learning the Swipe-to-refresh gesture that is being used in various application like the Facebook app or the Instagram app, where the user of the app refreshes the app according to their need.",author:14897,img_url:"/images/swipe-to-refresh-banner.png",blog_url:"using-swipe-to-refresh-in-android-application",likes:0,rank:0,category:1,published_at:"21st May 2019",score:.3282759189605713}],isSimilarBlogsFetching:!1},loginData:{data:null,isLoggingIn:!1,isLoggingOut:!1,loginState:!1,isForcedLogout:!1,isTokenRefreshed:!1,isRedirectHome:!1,message:""},updatesData:{news:null,inspirations:null,isNewsFetching:!0,isInspirationsFetching:!0},blogEditorData:{blogId:null,blogDetailsFormData:{title:"",description:"",imgUrl:"",blogUrl:"",category:"",categories:[],isWriting:!1,isTitleError:!1,isDescriptionError:!1,isImgUrlError:!1,isBlogUrlError:!1,isCategoryError:!1,isUploadingImage:!1,uploadedImageUrl:null},editorState:null,editorText:null,successMessage:null,errorMessage:null,isSending:!1,isMsgToShow:!1,isPublished:!1,isSubmitted:!1,isDraft:!0,isEditOfExistingBlog:!1,isFetchingBlogCategories:!1,isUploadingImage:!1,uploadedImageUrl:null},myBlogsData:{data:null,isSubmittedBlogsFetching:!0,isDraftBlogsFetching:!0,isPublishedBlogsFetching:!0,successMessage:null,errorMessage:null,isMsgToShow:!1,tabNames:["drafts","submissions","published"],selectedTab:"drafts",isFetchingBlog:!1,isDeletingBlog:!1,openEditorPage:!1},profilePreviewData:{profile:null,blogs:null,isFetchingProfile:!1,isFetchingAuthorBlogs:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,isUserNotRegistered:!1,redirectToMyProfileEdit:!1},profileEditableData:{userId:null,name:null,fbProfilePicUrl:null,googleProfilePicUrl:null,profileFormData:{tagline:"",fbProfileUrl:"",googlePlusProfileUrl:"",twitterProfileUrl:"",githubProfileUrl:"",linkedinProfileUrl:"",isWriting:!1,isTaglineError:!1,isFbProfileUrlError:!1,isGooglePlusProfileUrlError:!1,isTwitterProfileUrlError:!1,isGithubProfileUrlError:!1,isLinkedinProfileUrlError:!1},isSavingProfile:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,redirectToProfilePreview:!1},submitBlogData:{formData:{email:"",name:"",link:"",isWriting:!1,isNameError:!1,isEmailError:!1,isLinkError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSubmitting:!1},advertisementsData:{data:{},isLoading:!1},recaptchaData:{verified:!1,successMessage:null,errorMessage:null},blogSearchData:{searches:null,isSearching:!1}}
  </script>
  <script async="" src="https://www.google-analytics.com/analytics.js" type="text/javascript">
  </script>
  <script type="text/javascript">
   window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-91686131-1","auto"),ga("require","cleanUrlTracker"),ga("require","eventTracker"),ga("require","impressionTracker"),ga("require","outboundLinkTracker"),ga("require","urlChangeTracker"),ga("require","maxScrollTracker"),ga("require","mediaQueryTracker"),ga("require","outboundFormTracker"),ga("require","outboundLinkTracker"),ga("require","pageVisibilityTracker"),ga("require","socialWidgetTracker"),ga("require","urlChangeTracker"),ga("send","pageview")
  </script>
  <script defer="defer" src="/assets/autotrack.js" type="text/javascript">
  </script>
  <script src="/assets/highlight.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/vendor-bundle-1.8.6.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/app-bundle-1.8.6.js" type="text/javascript">
  </script>
 </head>
 <body>
  <div id="root">
   <div class="screen app-load-content" data-reactroot="">
    <div class="ui centered grid">
     <div class="row" style="padding:0">
      <div class="ui fixed menu navbar huge borderless grid" style="background-color:#fff;height:60px">
      </div>
     </div>
     <div class="centered computer only row" style="padding:0">
      <div class="ui fixed top menu navbar huge borderless grid header-container" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="right menu">
        <a class="item" href="https://janisharali.com" target="_blank">
         Mentor Ali
        </a>
        <a class="item" href="https://amitshekhar.me" target="_blank">
         Mentor Amit
        </a>
       </div>
      </div>
     </div>
     <div class="tablet only mobile only row" style="padding:0">
      <div class="ui fixed top navbar huge menu borderless" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="item">
       </div>
      </div>
     </div>
    </div>
    <div class="header-height">
    </div>
    <div aria-live="assertive" class="redux-toastr">
     <div>
      <div class="top-left">
      </div>
      <div class="top-right">
      </div>
      <div class="top-center">
      </div>
      <div class="bottom-left">
      </div>
      <div class="bottom-right">
      </div>
      <div class="bottom-center">
      </div>
     </div>
    </div>
    <div class="content-container theme">
     <div class="ui centered one column grid" style="padding-bottom:80px;background-color:#fff">
      <div class="ten wide computer fifteen wide mobile fifteen wide tablet column" style="margin-top:50px">
       <div>
        <div class="blog-page-author">
         <div class="ui small header">
          <img alt="Sumit Mishra" class="ui circular image" src="https://lh3.googleusercontent.com/a-/AOh14GiHP4JrkmlLjuz_uG1g4E0MhTUClSNytqB8o-pxCA=s96-c?sz=300"/>
          <div class="content">
           Sumit Mishra
           <div class="sub header" style="margin-top:5px">
            30th October 2019
           </div>
          </div>
         </div>
        </div>
        <div id="content">
         <article class="template">
          <div class="postContent">
           <div class="notesSource">
            <div class="postField postField--body" id="editor">
             <section class="section--first section--last">
              <div class="section-divider layoutSingleColumn-template">
               <hr class="section-divider"/>
              </div>
              <div class="section-content">
               <div class="section-inner layoutSingleColumn-template">
                <div>
                 <h1 class="graf--h1">
                  Using R8 to reduce APK size in Android
                 </h1>
                 <div class="graf-image graf-caption">
                  <img alt="Using R8 to reduce APK size in Android" class="graf-image" src="/images/using-r8-to-reduce-apk-size-in-android-banner.png"/>
                 </div>
                 <p class="graf--p">
                  Application size plays an important role in deciding whether your application will reach the next billion users or not. In most of the cases, the users have very less amount of space in their mobile phones. So, if your APK size is big then you will end up losing your users. It becomes an important task to reduce the APK size as much as possible.
                 </p>
                 <blockquote class="graf--blockquote">
                  Smaller APK size is always better.
                 </blockquote>
                 <p class="graf--p">
                  In this blog, we will learn how to reduce the APK size by using R8 in our application. The following topics will be covered in this blog:
                 </p>
                 <ul>
                  <li>
                   What is R8 Shrinking?
                  </li>
                  <li>
                   How to enable R8 Shrinking in your app?
                  </li>
                  <li>
                   How does Shrinking work?
                  </li>
                  <li>
                   Closing note
                  </li>
                 </ul>
                 <p class="graf--p">
                  So, let's get started.
                 </p>
                 <h4 class="graf--h3">
                  What is R8 Shrinking?
                 </h4>
                 <p class="graf--p">
                  R8 shrinking is a process in which we reduce the amount of code of our application and by doing so, the APK size automatically gets reduced. So, reduced APK sized applications are more likely to be kept in people's phone. All we need to do is reduce the class files(i.e. the code) written in our Android application.
                 </p>
                 <p class="graf--p">
                  To reduce the APK size, we have three different techniques:
                 </p>
                 <ol type="1">
                  <li>
                   <b class="graf--bold">
                    Shrinking or Tree Shaking:
                   </b>
                   Shrinking is the process of removal of unreachable code from our Android project. It performs some static analysis to get rid of unreachable code and removes the uninstantiated object.
                  </li>
                  <li>
                   <b class="graf--bold">
                    Optimization:
                   </b>
                   This is used to optimize the code for size. It involves dead code removal, unused argument removal, selective inlining, class merging, etc.
                  </li>
                  <li>
                   <b class="graf--bold">
                    Identifier Renaming:
                   </b>
                   In this process, we obfuscate the class name and other variable names. For example, if the name of the class is "MyAwesomeClass", then it will be obfuscated to "a" or something else but smaller in size.
                  </li>
                 </ol>
                 <p class="graf--p">
                  But many of you might be thinking that if I am making an application then why would I include some extra code if I am not going to use it? And as a result, if I am not including that unwanted code then how will R8 shrink the application size? So, what's the reason behind using this R8 shrinking?
                 </p>
                 <p class="graf--p">
                  The answer is simple:
                 </p>
                 <ul>
                  <li>
                   <b class="graf--bold">
                    Third-party library:
                   </b>
                   Every application requires some kind of third-party libraries. But in your application, you might be using a small part of that third-party library and rest of the part is not useful for you. So, why to keep those lines of code? Without any shrinking, all the library codes will be retained in your app. Even if you are writing you app in Kotlin, then you have to include Kotlin Standard Library and this, in turn, increase your APK size.
                  </li>
                  <li>
                   <b class="graf--bold">
                    Code optimization:
                   </b>
                   Even if your application doesn't have unwanted lines of code, you can still optimize the code written by you by using some optimization techniques like dead code removal, unused argument removal, selective inlining, class merging, etc.
                  </li>
                 </ul>
                 <blockquote class="graf--blockquote">
                  Note: You must be thinking that these things are already handled by Proguard, then why to use R8? The answer is simple, R8 works with Proguard rules and R8 shrinks the code
                  <b class="graf--bold">
                   faster
                  </b>
                  while improving the output size.
                 </blockquote>
                 <h4 class="graf--h3">
                  How to enable R8 Shrinking in your app?
                 </h4>
                 <p class="graf--p">
                  To enable R8 shrinking in your application, set the
                  <code class="graf--code-inline">
                   minifyEnabled
                  </code>
                  to
                  <code class="graf--code-inline">
                   true
                  </code>
                  in your app's main
                  <code class="graf--code-inline">
                   build.gradle
                  </code>
                  file.
                 </p>
                 <pre><code class="language-java graf graf--code">android {
    ...
    buildTypes {
        release {
            minifyEnabled false
        }
    }
}</code></pre>
                 <p class="graf--p">
                  Try to find the APK size by making a single Activity application and then by using R8 shrinking and after that check for the APK size by including some third-party library before and after using R8 shrinking. You will notice the difference in APK size.
                 </p>
                 <p class="graf--p">
                  But how does this shrinking work? Let's find.
                 </p>
                 <h4 class="graf--h3">
                  How does Shrinking work?
                 </h4>
                 <p class="graf--p">
                  The algorithms used for APK size reduction traces the unreachable code and it removes those codes from the APK. This is done with the help of entry-points. So, R8 starts with this entry-point and goes down to all the reachable code and in the end, it removes the unreachable code. To define this entry-points, we have something called the keep rules that we generally write the R8 configuration in the
                  <code class="graf--code-inline">
                   proguard-rule
                  </code>
                  file. Let's have an example of the same:
                 </p>
                 <pre><code class="language-java graf graf--code">class com.mindorks.JavaHelloWorld {
    //unreachable code
    private void iAmUnused() {
        System.out.println("I am of no use :( ");
    }

    //reachable code
    private static void reachableExample() {
        System.out.println("Hello, MindOrks :) ");
    }

    //main function
    public static void main(String[] args) {
        reachableExample();
    }
}</code></pre>
                 <p class="graf--p">
                  And in the rule, we add:
                 </p>
                 <pre><code class="language-java graf graf--code">//This is the entry point 
-keep class com.mindorks.JavaHelloWorld {
    public static void main(java.lang.String[]); 
}</code></pre>
                 <p class="graf--p">
                  In the above code, when the R8 shrinking starts, then the R8 will start tracing from the entry point i.e. the main function will be called and from the main function, the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    reachableExample()
                   </i>
                  </b>
                  method will be called and finally after printing "Hello, MindOrks :)" the tracing will be stopped. So, the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    iAmUnused()
                   </i>
                  </b>
                  method is unreachable and it will be removed. Also, at the same time, the name of the method
                  <i class="graf--italic">
                   rechableExample()
                  </i>
                  will get reduced to something shorter like
                  <i class="graf--italic">
                   a()
                  </i>
                  or
                  <i class="graf--italic">
                   b()
                  </i>
                  . And finally, R8 can inline the code of the
                  <i class="graf--italic">
                   reachableExample()
                  </i>
                  in the main function. So, the final code will be:
                 </p>
                 <pre><code class="language-java graf graf--code">class com.mindorks.JavaHelloWorld {
    
    //main function
    public static void main(String[] args) {
        System.out.println("Hello, MindOrks :) ");
    }
}</code></pre>
                 <p class="graf--p">
                  Similarly, in Android, we can have various entry points like Activities, Services, Content Providers, Broadcast receivers and to handle these entry points, aapt2 tool is used. For example, in our manifest file, we define MainActivity or other activity as our entry point.
                 </p>
                 <p class="graf--p">
                  Apart from these entry points provided by aapt2 tools, there are several other things that are required for the Android Platform and these are provided by the Android Studio in the configuration file. Add the below line in your app's main
                  <b class="graf--bold">
                   <i class="graf--italic">
                    build.gradle
                   </i>
                  </b>
                  file:
                 </p>
                 <pre><code class="language-java graf graf--code">minifyEnabled true
proguardFiles getDefaultProguardFile('proguard-android-optimize.txt')</code></pre>
                 <p class="graf--p">
                  But, there is one problem, when your code contains some reflection code then it is not recognized by R8 by tracing the code. So, it removes that code also and it should not do that. For example,
                 </p>
                 <pre><code class="language-java graf graf--code">class Company(val name: String)

fun printJson() {
    val myGson: Gson()
    val compnay = Company("MindOrks")
    print(myGson.toJson(compnay))
}

//output: {}</code></pre>
                 <p class="graf--p">
                  In the above code, the output is an empty JSON object. This is because the filed "name" is written but never read. Here Gson uses reflection techniques, so R8 doesn't see that this field is actually read and removes the code.  So, to avoid this you have to have some keep rules that will tell the R8 to keep the value named "name" and don't delete that. Generally, we put all these keep rules in a file called
                  <code class="graf--code-inline">
                   proguard-rules.pro
                  </code>
                  and add the below lines in your app's main
                  <b class="graf--bold">
                   <i class="graf--italic">
                    build.gradle
                   </i>
                  </b>
                  file:
                 </p>
                 <pre><code class="language-java graf graf--code">minifyEnabled true
proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 
        'proguard-rules.pro'</code></pre>
                 <p class="graf--p">
                  You can read more about Proguard from
                  <a class="markup--anchor" href="https://blog.mindorks.com/applying-proguard-in-an-android-application" target="_blank">
                   here
                  </a>
                  .
                 </p>
                 <h4 class="graf--h3">
                  Closing note
                 </h4>
                 <p class="graf--p">
                  In this blog, we learned how to reduce the APK size by using R8 in our application. As the app size matters a lot. So, use R8 to reduce that app size and it is easy to implement.
                 </p>
                 <p class="graf--p">
                  Hope you learned something new today.
                 </p>
                 <p class="graf--p">
                  Have a look at our Android tutorials
                  <b class="graf--bold">
                   <a class="markup--anchor" href="https://mindorks.com/android-tutorial" target="_blank">
                    here
                   </a>
                  </b>
                  .
                 </p>
                 <p class="graf--p">
                  Do share this blog with your fellow developers to spread the knowledge. You can read more blogs on Android on our
                  <a class="markup--anchor" href="https://blog.mindorks.com/" target="_blank">
                   bloggi
                  </a>
                  <a class="markup--anchor" href="https://blog.mindorks.com/" target="_blank">
                   ng website
                  </a>
                  .
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   <a class="markup--anchor" href="https://bootcamp.mindorks.com/" target="_blank">
                    Apply Now: MindOrks Android Online Course and Learn Advanced Android
                   </a>
                  </b>
                 </p>
                 <p class="graf--p">
                  Happy Learning :)
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Team MindOrks!
                  </b>
                 </p>
                </div>
               </div>
              </div>
             </section>
            </div>
           </div>
          </div>
         </article>
        </div>
       </div>
       <div class="ui divider">
       </div>
      </div>
      <div class="stretched fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui large center aligned header" style="padding-top:20px">
        Recommended for You
       </div>
      </div>
      <div class="fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui centered grid">
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card">
          <img alt="How to reduce APK size in Android?" class="ui centered image" src="/images/optimize-android-apk-banner-c07d71b4b0c45adc.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            How to reduce APK size in Android?
           </div>
           <div class="meta">
            6th August 2020
           </div>
           <div class="description">
            Bloated APKs have a higher chance of uninstalls or getting rejected by the customers. This blog describes how to optimize apk size in Android.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card">
          <img alt="How to create multiple apk files for android application" class="ui centered image" src="https://s3.ap-south-1.amazonaws.com/mindorks/blogs/how-to-create-multiple-apk-files-for-android-application.jpg" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            How to create multiple apk files for android application
           </div>
           <div class="meta">
            30th August 2017
           </div>
           <div class="description">
            Too many android devices and much more to come and among them, various different CPU architectures and different screen densities devices are there. Making single apk with all device compatible, increases your apk size, as it has resources for every device.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card">
          <img alt="Using Android Sensors: Android Tutorial" class="ui centered image" src="/images/using-android-sensors-android-tutorial-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Using Android Sensors: Android Tutorial
           </div>
           <div class="meta">
            30th September 2019
           </div>
           <div class="description">
            In this blog, we will learn how to use Android Sensors. There are various sensors present in our Android device and we can use them in our application. For example, we can use the temperature sensor in some weather app. So, let's learn about Android Sensors.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card">
          <img alt="Push Notifications in Android Using FCM" class="ui centered image" src="/images/fcm.jpg" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Push Notifications in Android Using FCM
           </div>
           <div class="meta">
            15th May 2019
           </div>
           <div class="description">
            In this blog, we will learn using Push Notifications in Android Device using FCM. We will learn how to integrate the push notification feature in the app from scratch and handle the message as well.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card">
          <img alt="Using Custom and Downloadable Fonts in Android" class="ui centered image" src="/images/downloadable-font-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Using Custom and Downloadable Fonts in Android
           </div>
           <div class="meta">
            16th May 2019
           </div>
           <div class="description">
            In this blog, we will learn how to use custom and downloadable fonts in android that was introduced in Android 8.0. Now there is no need of writing some piece of code for using the fonts. Also you can choose from any of the thousands of fonts on Google Fonts and use them in your app.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card">
          <img alt="Using Swipe-to-refresh in Android Application" class="ui centered image" src="/images/swipe-to-refresh-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Using Swipe-to-refresh in Android Application
           </div>
           <div class="meta">
            21st May 2019
           </div>
           <div class="description">
            In this blog, we will be learning the Swipe-to-refresh gesture that is being used in various application like the Facebook app or the Instagram app, where the user of the app refreshes the app according to their need.
           </div>
          </div>
         </a>
        </div>
       </div>
      </div>
     </div>
    </div>
    <div style="background:#fff">
     <footer class="content-container">
      <div class="ui centered padded grid" style="padding-top:40px;background:linear-gradient(to right,#c4e0e0,#e5f1f1)">
       <h2 class="ui huge icon center aligned header">
        <div class="content">
         Connect With Your Mentors
        </div>
       </h2>
       <div class="centered row">
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Janishar Ali" class="ui medium circular image" src="/assets/ali.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://janisharali.com" target="_blank">
             Janishar Ali
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://janisharali.com" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/janisharali" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Amit Shekhar" class="ui medium circular image" src="/assets/amit.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://amitshekhar.me" target="_blank">
             Amit Shekhar
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://amitshekhar.me" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/amitiitbhu" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div class="ui divider" style="margin:unset">
      </div>
      <h5 class="ui header" style="padding:16px;margin:unset;color:#555">
       <i aria-hidden="true" class="copyright icon">
       </i>
       <div class="content">
        Copyright 2022, MindOrks Nextgen Private Limited
       </div>
      </h5>
     </footer>
    </div>
   </div>
  </div>
  <script type="text/javascript">
   window.hljs.initHighlightingOnLoad()
  </script>
 </body>
</html>