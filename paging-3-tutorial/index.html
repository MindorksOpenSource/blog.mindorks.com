<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title>
   Paging 3 Android Tutorial
  </title>
  <meta charset="utf-8"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="minimum-scale=1,initial-scale=1,width=device-width,shrink-to-fit=no" name="viewport"/>
  <link href="https://blog.mindorks.com/paging-3-tutorial" rel="canonical"/>
  <meta content="986249072156-dabps0lf90smluddrk5rkqsdjghk3hd3.apps.googleusercontent.com" name="google-signin-client_id"/>
  <meta content="android, learn android app development, android app development courses, android blogs, android tutorial" name="keywords"/>
  <meta content="Paging 3 Android Tutorial" property="og:title"/>
  <meta content="website" property="og:type"/>
  <meta content="https://blog.mindorks.com/paging-3-tutorial" property="og:url"/>
  <meta content="/images/pagin-3-banner-ea0e11235223f0cd.png" property="og:image"/>
  <meta content="In this blog, we will learn how to use paging 3 library in our android project. We will also see how we can use it with Coroutines and RxJava." property="og:description"/>
  <meta content="Paging 3 Android Tutorial" property="twitter:title"/>
  <meta content="In this blog, we will learn how to use paging 3 library in our android project. We will also see how we can use it with Coroutines and RxJava." name="twitter:description"/>
  <meta content="/images/pagin-3-banner-ea0e11235223f0cd.png" name="twitter:image:src"/>
  <meta content="summary_large_image" name="twitter:card"/>
  <meta content="@MindorksNextGen" name="twitter:site"/>
  <meta content="In this blog, we will learn how to use paging 3 library in our android project. We will also see how we can use it with Coroutines and RxJava." name="description"/>
  <meta content="1620001391374687" property="fb:app_id"/>
  <link href="/styles/vendor-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link href="/styles/app-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link as="style" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" onload='this.onload=null,this.rel="stylesheet"' rel="preload"/>
  <noscript>
   <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
  </noscript>
  <script type="text/javascript">
     </script>
  <script async="" src="https://www.google-analytics.com/analytics.js" type="text/javascript">
  </script>
  <script type="text/javascript">
   window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-91686131-1","auto"),ga("require","cleanUrlTracker"),ga("require","eventTracker"),ga("require","impressionTracker"),ga("require","outboundLinkTracker"),ga("require","urlChangeTracker"),ga("require","maxScrollTracker"),ga("require","mediaQueryTracker"),ga("require","outboundFormTracker"),ga("require","outboundLinkTracker"),ga("require","pageVisibilityTracker"),ga("require","socialWidgetTracker"),ga("require","urlChangeTracker"),ga("send","pageview")
  </script>
  <script defer="defer" src="/assets/autotrack.js" type="text/javascript">
  </script>
  <script src="/assets/highlight.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/vendor-bundle-1.8.6.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/app-bundle-1.8.6.js" type="text/javascript">
  </script>
 </head>
 <body>
  <div id="root">
   <div class="screen app-load-content" data-reactroot="">
    <div class="ui centered grid">
     <div class="row" style="padding:0">
      <div class="ui fixed menu navbar huge borderless grid" style="background-color:#fff;height:60px">
      </div>
     </div>
     <div class="centered computer only row" style="padding:0">
      <div class="ui fixed top menu navbar huge borderless grid header-container" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="right menu">
        <a class="item" href="https://janisharali.com" target="_blank">
         Mentor Ali
        </a>
        <a class="item" href="https://amitshekhar.me" target="_blank">
         Mentor Amit
        </a>
       </div>
      </div>
     </div>
     <div class="tablet only mobile only row" style="padding:0">
      <div class="ui fixed top navbar huge menu borderless" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="item">
       </div>
      </div>
     </div>
    </div>
    <div class="header-height">
    </div>
    <div aria-live="assertive" class="redux-toastr">
     <div>
      <div class="top-left">
      </div>
      <div class="top-right">
      </div>
      <div class="top-center">
      </div>
      <div class="bottom-left">
      </div>
      <div class="bottom-right">
      </div>
      <div class="bottom-center">
      </div>
     </div>
    </div>
    <div class="content-container theme">
     <div class="ui centered one column grid" style="padding-bottom:80px;background-color:#fff">
      <div class="ten wide computer fifteen wide mobile fifteen wide tablet column" style="margin-top:50px">
       <div>
        <div class="blog-page-author">
         <div class="ui small header">
          <img alt="Himanshu Singh" class="ui circular image" src="https://lh3.googleusercontent.com/a-/AOh14Ghy8H-FJrgWB2TcxHCOKWxWEQB4AiklYADGTydu4nE=s96-c?sz=300"/>
          <div class="content">
           Himanshu Singh
           <div class="sub header" style="margin-top:5px">
            14th August 2020
           </div>
          </div>
         </div>
        </div>
        <div id="content">
         <article class="template">
          <div class="postContent">
           <div class="notesSource">
            <div class="postField postField--body" id="editor">
             <section class="section--first section--last">
              <div class="section-divider layoutSingleColumn-template">
               <hr class="section-divider"/>
              </div>
              <div class="section-content">
               <div class="section-inner layoutSingleColumn-template">
                <div>
                 <h1 class="graf--h1">
                  Paging 3 Android Tutorial
                 </h1>
                 <div class="graf-image graf-caption">
                  <img alt="Paging 3 Android Tutorial" class="graf-image" src="/images/pagin-3-banner-ea0e11235223f0cd.png"/>
                 </div>
                 <p class="graf--p">
                 </p>
                 <p class="graf--p">
                  When working with RecyclerViews in our Android project, we display a list with a lot of items in it. Sometimes we have use-case like fetching a contact list from the phone and displaying it on the list. Loading a lot of data at once in a list is not a very efficient task to do. To get over this, we have paging in Android.
                 </p>
                 <p class="graf--p">
                  By using the Paging library, we can load a lot of data efficiently, and only we will load the data when needed. In this blog, we will be learning about the Paging 3 library in Android and how we can use it to load our large set of data in our RecyclerView efficiently.
                 </p>
                 <p class="graf--p">
                  In this blog, we are going to learn,
                 </p>
                 <ul>
                  <li>
                   Introduction to Paging 3 library
                  </li>
                  <li>
                   Understanding and Implementing Paging 3 library.
                  </li>
                  <li>
                   Getting the States of the data
                  </li>
                  <li>
                   Adding the Header and Footer view.
                  </li>
                  <li>
                   Using it with RxJava.
                  </li>
                 </ul>
                 <h4 class="graf--h3">
                  Introduction to Paging 3 library
                 </h4>
                 <p class="graf--p">
                  Google launched Paging 3 as a part of the Jetpack series. It is still in the early stages. Paging 3 is written entirely using Kotlin Coroutines. It has support for requesting the next page to load more data automatically. It supports Flow, LiveData, and RxJava along with Kotlin Coroutine.
                 </p>
                 <p class="graf--p">
                  Paging 3 also adds support for caching and handles the state efficiently like loading and failed states while loading the items on ti the list. It also keeps track for the keys to get data from the next and previous pages.
                 </p>
                 <h4 class="graf--h3">
                  Understanding and Implementing Paging 3 library
                 </h4>
                 <p class="graf--p">
                  In this, we are going to learn implementing Paging 3 library by fetching the list from an API and displaying it in the list. We are going to use the following API for displaying the list,
                 </p>
                 <pre><code class="language-java graf graf--code">https://reqres.in/api/users?page=1</code></pre>
                 <p class="graf--p">
                  Our project structure looks like,
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="Paging 3 Android Tutorial" class="graf-image" src="/images/project-stuct-90a21ffae7082b17.jpg"/>
                 </div>
                 <p class="graf--p">
                  Here, we have an
                  <b class="graf--bold">
                   adapter
                  </b>
                  package which is responsible for displaying the list in the RecyclerView.
                  <b class="graf--bold">
                   data
                  </b>
                  package is responsible for fetching data from the API. We also have MainActivity in which we are going to display the list.
                 </p>
                 <p class="graf--p">
                  So, now let's get started.
                 </p>
                 <h4 class="graf--h3">
                  Step 01.
                 </h4>
                 <p class="graf--p">
                  Let's first setup the dependencies for Paging 3 in our app's build.gradle like,
                 </p>
                 <pre><code class="language-java graf graf--code">implementation "androidx.paging:paging-runtime:{latest-version}"</code></pre>
                 <blockquote class="graf--blockquote">
                  Note: At the time of writing the blog, its version is 3.0.0-alpha04
                 </blockquote>
                 <p class="graf--p">
                  and we will also add the support for Retrofit and Moshi as we are going to use Moshi as convertor factory for Retrofit like,
                 </p>
                 <pre><code class="language-java graf graf--code">implementation "com.squareup.retrofit2:retrofit:{latest-version}"
implementation "com.squareup.retrofit2:converter-moshi:{latest-version}"
implementation "com.squareup.moshi:moshi-kotlin:{latest-version}" </code></pre>
                 <pre><code class="language-java graf graf--code">implementation "androidx.lifecycle:lifecycle-viewmodel-ktx:{latest-version}"</code></pre>
                 <h4 class="graf--h3">
                  Step 02.
                 </h4>
                 <p class="graf--p">
                  Now, we are going to setup APIService and Retrofit client like,
                 </p>
                 <pre><code class="language-java graf graf--code">interface APIService {

    @GET("api/users")
    suspend fun getListData(@Query("page") pageNumber: Int): Response&lt;ApiResponse&gt;

    companion object {
        
        private val moshi = Moshi.Builder()
            .add(KotlinJsonAdapterFactory())
            .build()

        fun getApiService() = Retrofit.Builder()
            .baseUrl("https://reqres.in/")
            .addConverterFactory(MoshiConverterFactory.create(moshi))
            .build()
            .create(APIService::class.java)
    }
}</code></pre>
                 <p class="graf--p">
                  Here, we have created an
                  <b class="graf--bold">
                   APIService
                  </b>
                  interface with
                  <b class="graf--bold">
                   getListData
                  </b>
                  function which takes a query parameter which will take the page number from which we have to fetch the data from.
                 </p>
                 <p class="graf--p">
                  We also setup the Retrofit client, by adding the base URL and the convertor factory of Moshi.
                 </p>
                 <h4 class="graf--h3">
                  Step 03.
                 </h4>
                 <p class="graf--p">
                  Now, we have to create the data class for the following JSON output which we get as the response,
                 </p>
                 <pre><code class="language-java graf graf--code">{
    "page": 1,
    "per_page": 6,
    "total": 12,
    "total_pages": 2,
    "data": [
    {
        "id": 1,
        "email": "george.bluth@reqres.in",
        "first_name": "George",
        "last_name": "Bluth",
        "avatar": "https://s3.amazonaws.com/uifaces/faces/twitter/calebogden/128.jpg"
    },
    {
        "id": 2,
        "email": "janet.weaver@reqres.in",
        "first_name": "Janet",
        "last_name": "Weaver",
        "avatar": "https://s3.amazonaws.com/uifaces/faces/twitter/josephstein/128.jpg"
    }
    ],
    "ad": {
    "company": "StatusCode Weekly",
    "url": "http://statuscode.org/",
    "text": "A weekly newsletter focusing on software development, infrastructure, the server, performance, and the stack end of things."
}}</code></pre>
                 <p class="graf--p">
                  and we create the corresponding data classes for the above JSON response. Our ApiResponse data class looks like,
                 </p>
                 <pre><code class="language-java graf graf--code">data class ApiResponse(
    @Json(name = "ad")
    val ad: Ad,
    @Json(name = "data")
    val myData: List&lt;Data&gt;,
    @Json(name = "page")
    val page: Int,
    @Json(name = "per_page")
    val perPage: Int,
    @Json(name = "total")
    val total: Int,
    @Json(name = "total_pages")
    val totalPages: Int
)</code></pre>
                 <p class="graf--p">
                  The Ad data class looks like,
                 </p>
                 <pre><code class="language-java graf graf--code">data class Ad(
    @Json(name = "company")
    val company: String,
    @Json(name = "text")
    val text: String,
    @Json(name = "url")
    val url: String
)</code></pre>
                 <p class="graf--p">
                  and Data data class looks like,
                 </p>
                 <pre><code class="language-java graf graf--code">data class Data(
    @Json(name = "avatar")
    val avatar: String,
    @Json(name = "email")
    val email: String,
    @Json(name = "first_name")
    val firstName: String,
    @Json(name = "id")
    val id: Int,
    @Json(name = "last_name")
    val lastName: String
)</code></pre>
                 <h4 class="graf--h3">
                  Step 04.
                 </h4>
                 <p class="graf--p">
                  Now, since we have setup the data class and APIService, let's setup the paging library. In PostDataSource we will update the code as,
                 </p>
                 <pre><code class="language-java graf graf--code">class PostDataSource(private val apiService: APIService) : PagingSource&lt;Int, Data&gt;() {

    override suspend fun load(params: LoadParams&lt;Int&gt;): LoadResult&lt;Int, Data&gt; {
       
    }

}</code></pre>
                 <p class="graf--p">
                  Here, we have extended
                  <b class="graf--bold">
                   PostDataSource
                  </b>
                  with
                  <b class="graf--bold">
                   PagingSource
                  </b>
                  which will implement a suspend load function which will help us to load the data.
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   PostDataSource
                  </b>
                  also takes a primary constructor parameter
                  <b class="graf--bold">
                   APIService
                  </b>
                  . PostDataSource acts here as a
                  <b class="graf--bold">
                   repository
                  </b>
                  and the
                  <b class="graf--bold">
                   load
                  </b>
                  function gets the data from the API.
                 </p>
                 <p class="graf--p">
                  Since the load function is a
                  <b class="graf--bold">
                   suspend
                  </b>
                  function, we can call other
                  <b class="graf--bold">
                   suspend
                  </b>
                  functions inside it without any issues which we created in
                  <b class="graf--bold">
                   APIService
                  </b>
                  .
                 </p>
                 <p class="graf--p">
                  In the
                  <b class="graf--bold">
                   PostDataSource
                  </b>
                  , we take two
                  <b class="graf--bold">
                   parameters
                  </b>
                  one of integer type and other of the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    data
                   </i>
                  </b>
                  type we have to load on the list item. The integer parameter represents the page number here.
                 </p>
                 <p class="graf--p">
                  Now, we update the load function like,
                 </p>
                 <pre><code class="language-java graf graf--code">override suspend fun load(params: LoadParams&lt;Int&gt;): LoadResult&lt;Int, Data&gt; {
    try {
        val currentLoadingPageKey = params.key ?: 1
        val response = apiService.getListData(currentLoadingPageKey)
        val responseData = mutableListOf&lt;Data&gt;()
        val data = response.body()?.myData ?: emptyList()
        responseData.addAll(data)

        val prevKey = if (currentLoadingPageKey == 1) null else currentLoadingPageKey - 1

        return LoadResult.Page(
            data = responseData,
            prevKey = prevKey,
            nextKey = currentLoadingPageKey.plus(1)
        )
    } catch (e: Exception) {
        return LoadResult.Error(e)
    }
}
</code></pre>
                 <p class="graf--p">
                  Here, we get the page number from params and assign it to
                  <b class="graf--bold">
                   nextPage
                  </b>
                  variable using
                  <b class="graf--bold">
                   param.key
                  </b>
                  and if it returns
                  <b class="graf--bold">
                   null
                  </b>
                  , we set a default value 1.
                 </p>
                 <p class="graf--p">
                  We also do the API call and get assign the
                  <i class="graf--italic">
                   response
                  </i>
                  to the
                  <b class="graf--bold">
                   response
                  </b>
                  variable using
                  <b class="graf--bold">
                   APIService
                  </b>
                  which we passed as a constructor parameter to
                  <b class="graf--bold">
                   PostDataSource
                  </b>
                  class.
                 </p>
                 <p class="graf--p">
                  After doing all the operations with the successful response, we return the
                  <b class="graf--bold">
                   LoadResult.Page
                  </b>
                  object here with the required data and it something went wrong we use
                  <b class="graf--bold">
                   LoadResult.Error
                  </b>
                  .
                 </p>
                 <p class="graf--p">
                  We are also passing null as the next key if there is no corresponding data in that direction.
                 </p>
                 <blockquote class="graf--blockquote">
                  Here, the PostDataSource is responsible to keep track of the page which has to be requested next which we get from the APIService.
                 </blockquote>
                 <h4 class="graf--h3">
                  Step 05.
                 </h4>
                 <p class="graf--p">
                  Now, since we have the DataSource setup we will now get the data in the MainViewModel. We will create the MainViewModel by adding the APIService as a parameter to the primary constructor. So, we will update the ViewModel like,
                 </p>
                 <pre><code class="language-java graf graf--code">class MainViewModel(private val apiService: APIService) : ViewModel() {

}</code></pre>
                 <p class="graf--p">
                  Now, inside the ViewModel, we will create a variable called
                  <b class="graf--bold">
                   listData
                  </b>
                  and assign it to the Pager instance.
                 </p>
                 <pre><code class="language-java graf graf--code">val listData = Pager(PagingConfig(pageSize = 6)) {
    PostDataSource(apiService)
}.flow.cachedIn(viewModelScope)</code></pre>
                 <p class="graf--p">
                  Here, the
                  <b class="graf--bold">
                   Pager
                  </b>
                  will call the load function from the
                  <b class="graf--bold">
                   PostDataSource
                  </b>
                  and we will pass the
                  <b class="graf--bold">
                   apiService
                  </b>
                  as well in the object of
                  <b class="graf--bold">
                   PostDataSource
                  </b>
                  .
                 </p>
                 <p class="graf--p">
                  In the
                  <b class="graf--bold">
                   Pager
                  </b>
                  object, we also pass the configuration which is used to configure the behavior of
                  <b class="graf--bold">
                   Paging
                  </b>
                  and how it should load its data.  We are passing the
                  <b class="graf--bold">
                   PagingConfig
                  </b>
                  with the
                  <b class="graf--bold">
                   pageSize
                  </b>
                  .
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   PageSize
                  </b>
                  specifics the number of items loaded at once from the
                  <b class="graf--bold">
                   PostDataSource
                  </b>
                  . Recommended is to always keep the page size to more than the visible items on the screen.
                 </p>
                 <p class="graf--p">
                  And lastly, we will convert the
                  <b class="graf--bold">
                   listData
                  </b>
                  as flow by adding
                  <b class="graf--bold">
                   .flow .
                  </b>
                 </p>
                 <blockquote class="graf--blockquote">
                  It will convert the stream of data into a Flow. If we want to return
                  <b class="graf--bold">
                   LiveData
                  </b>
                  we can replace
                  <b class="graf--bold">
                   .flow
                  </b>
                  with
                  <b class="graf--bold">
                   .liveData
                  </b>
                  .
                 </blockquote>
                 <p class="graf--p">
                  And at last, we cache the data in
                  <b class="graf--bold">
                   viewModelScope
                  </b>
                  , and the data will be alive until the scope is active. Here, we are using
                  <b class="graf--bold">
                   viewModelScope
                  </b>
                  and since we are caching the data in the ViewModel it would not be impacted on any configuration changes.
                 </p>
                 <h4 class="graf--h3">
                  Step 06.
                 </h4>
                 <p class="graf--p">
                  Now, since we are getting the data in ViewModel, we now need to pass the data in the RecyclerView of MainActivity. We will update the
                  <b class="graf--bold">
                   activity_main.xml
                  </b>
                  like,
                 </p>
                 <pre><code class="language-java graf graf--code">&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity"&gt;

    &lt;androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerView"
        android:layout_width="match_parent"
        android:layout_height="match_parent" /&gt;

&lt;/LinearLayout&gt;</code></pre>
                 <p class="graf--p">
                  Now, we will update the MainActivity like,
                 </p>
                 <pre><code class="language-java graf graf--code">class MainActivity : AppCompatActivity() {

    lateinit var viewModel: MainViewModel
    lateinit var mainListAdapter: MainListAdapter

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        setupViewModel()
        setupList()
        setupView()
    }

    private fun setupView() {
        lifecycleScope.launch {
            viewModel.listData.collect {
                mainListAdapter.submitData(it)
            }
        }
    }

    private fun setupList() {
        mainListAdapter = MainListAdapter()
        recyclerView.apply {
            layoutManager = LinearLayoutManager(this)
            adapter = mainListAdapter
        }
    }

    private fun setupViewModel() {
        viewModel =
            ViewModelProvider(
                this,
             MainViewModelFactory(APIService.getApiService())
            )[MainViewModel::class.java]
    }
}</code></pre>
                 <p class="graf--p">
                  Here, we have setup our ViewModel by passing the
                  <b class="graf--bold">
                   MainViewModelFactory
                  </b>
                  with the instance of APIService.
                 </p>
                 <p class="graf--p">
                  The MainViewModelFactory looks like,
                 </p>
                 <pre><code class="language-java graf graf--code">class MainViewModelFactory(private val apiService: APIService) : ViewModelProvider.Factory {

    override fun &lt;T : ViewModel?&gt; create(modelClass: Class&lt;T&gt;): T {
        if (modelClass.isAssignableFrom(MainViewModel::class.java)) {
            return MainViewModel(apiService) as T
        }
        throw IllegalArgumentException("Unknown ViewModel class")
    }
}</code></pre>
                 <p class="graf--p">
                  And then we have to setup the RecyclerView in the
                  <b class="graf--bold">
                   setupList
                  </b>
                  function and lastly, in the
                  <b class="graf--bold">
                   setupView
                  </b>
                  function, we will
                  <b class="graf--bold">
                   <i class="graf--italic">
                    collect
                   </i>
                  </b>
                  the data from
                  <b class="graf--bold">
                   listData
                  </b>
                  variable from ViewModel inside the
                  <b class="graf--bold">
                   lifecycleScope
                  </b>
                  and then pass it to the
                  <b class="graf--bold">
                   submitData
                  </b>
                  function which is part of
                  <b class="graf--bold">
                   PagingDataAdapter
                  </b>
                  which helps us to update the data we fetched from the API and display in the UI.
                 </p>
                 <h4 class="graf--h3">
                  Step 07.
                 </h4>
                 <p class="graf--p">
                  Now, we will update the MainListAdapter. We will extend the
                  <b class="graf--bold">
                   MainListAdapter
                  </b>
                  with
                  <b class="graf--bold">
                   PagingDataAdapter
                  </b>
                  and the
                  <b class="graf--bold">
                   PagingDataAdapter
                  </b>
                  will take the type of data we need to display in the list and the ViewHolder.
                 </p>
                 <p class="graf--p">
                  It also takes a DiffUtil callback, as a parameter to its primary constructor which helps the
                  <b class="graf--bold">
                   PagingDataAdapter
                  </b>
                  to update the items if they are changed or updated. And DiffUtil callback is used because they are more performant.
                 </p>
                 <p class="graf--p">
                  Now, the MainListAdapter looks like,
                 </p>
                 <pre><code class="language-java graf graf--code">class MainListAdapter : PagingDataAdapter&lt;Data, MainListAdapter.ViewHolder&gt;(DataDifferntiator) {

    class ViewHolder(view: View) : RecyclerView.ViewHolder(view)

    override fun onBindViewHolder(holder: ViewHolder, position: Int) {
        holder.itemView.textViewName.text =
            "${getItem(position)?.firstName} ${getItem(position)?.lastName}"
        holder.itemView.textViewEmail.text = getItem(position)?.email

    }


    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): ViewHolder {
        return ViewHolder(
            LayoutInflater
                .from(parent.context)
                .inflate(R.layout.list_item, parent, false)
        )
    }

    object DataDifferntiator : DiffUtil.ItemCallback&lt;Data&gt;() {

        override fun areItemsTheSame(oldItem: Data, newItem: Data): Boolean {
            return oldItem.id == newItem.id
        }

        override fun areContentsTheSame(oldItem: Data, newItem: Data): Boolean {
            return oldItem == newItem
        }
    }

}</code></pre>
                 <p class="graf--p">
                  Here, in the MainListAdapter, inside the
                  <b class="graf--bold">
                   onCreateViewHolder
                  </b>
                  we are returning the ViewHolder by inflating the
                  <b class="graf--bold">
                   R.layout.list_item.
                  </b>
                 </p>
                 <p class="graf--p">
                  Here, the list_item layout file looks like,
                 </p>
                 <pre><code class="language-java graf graf--code">&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:padding="4dp"&gt;

    &lt;TextView
        android:id="@+id/textViewName"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="4dp"
        android:layout_marginBottom="4dp"
        android:textAppearance="@android:style/TextAppearance.DeviceDefault.Large" /&gt;

    &lt;TextView
        android:id="@+id/textViewEmail"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="4dp"
        android:layout_marginBottom="4dp" /&gt;
&lt;/LinearLayout&gt;</code></pre>
                 <p class="graf--p">
                  and inside the
                  <b class="graf--bold">
                   onBindViewHolder
                  </b>
                  we will assign the full name and email to both the TextViews.
                 </p>
                 <p class="graf--p">
                  And when we run the app, we will see the desired output on the screen and when we scroll the list to the bottom it will load the item from the second page and so on.
                 </p>
                 <h4 class="graf--h3">
                  Getting the States of the data
                 </h4>
                 <p class="graf--p">
                  Now, while loading the data we might also want to show progress view, and when we have loaded the data we should hide the progress view.
                 </p>
                 <p class="graf--p">
                  To react to the states of data we use
                  <b class="graf--bold">
                   addLoadStateListener
                  </b>
                  like,
                 </p>
                 <pre><code class="language-java graf graf--code">mainListAdapter.addLoadStateListener {
    if (it.refresh == LoadState.Loading) {
        // show progress view
    } else {
        //hide progress view
    }

}</code></pre>
                 <p class="graf--p">
                  Here, we get the CombinedLoadState in
                  <b class="graf--bold">
                   addLoadStateListener
                  </b>
                  and we use this to show or hide the progress views.
                 </p>
                 <p class="graf--p">
                  We can also react to errors inside the
                  <b class="graf--bold">
                   addLoadStateListener
                  </b>
                  if all the state methods like
                  <i class="graf--italic">
                   refresh
                  </i>
                  ,
                  <i class="graf--italic">
                   append
                  </i>
                  , and
                  <i class="graf--italic">
                   prepend
                  </i>
                  are instance of
                  <b class="graf--bold">
                   LoadState.Error
                  </b>
                  .
                 </p>
                 <h4 class="graf--h3">
                  Adding the Header and Footer view
                 </h4>
                 <p class="graf--p">
                  Now, since we have successfully integrated the Paging 3 library, now we will see how we can setup a footer view and header view.
                 </p>
                 <p class="graf--p">
                  FooterView is the one that when we go the last item of the list and the data is getting loaded from the next page, the footer view gets displayed. And as soon as the data is loaded the footer view is hidden.
                 </p>
                 <p class="graf--p">
                  For creating these views we will create a RecyclerViewAdapter similar to how we do in general use of RecyclerViews.
                 </p>
                 <p class="graf--p">
                  But in this case, we will extend the RecyclerView with
                  <b class="graf--bold">
                   LoadStateAdapter
                  </b>
                  and pass the ViewHolder to it like,
                 </p>
                 <pre><code class="language-java graf graf--code">class HeaderFooterAdapter() : LoadStateAdapter&lt;HeaderFooterAdapter.ViewHolder&gt;() {

    override fun onBindViewHolder(holder: LoadStateViewHolder, loadState: LoadState) {

        if (loadState == LoadState.Loading) {
            //show progress viewe
        } else //hide the view
       
    }

    override fun onCreateViewHolder(parent: ViewGroup, loadState: LoadState): LoadStateViewHolder {
        return LoadStateViewHolder(
           //layout file
        )
    }

    class ViewHolder(private val view: View) : RecyclerView.ViewHolder(view)
}</code></pre>
                 <p class="graf--p">
                  Here, inside the
                  <b class="graf--bold">
                   onBindViewHolder,
                  </b>
                  we get an additional parameter now of
                  <b class="graf--bold">
                   <i class="graf--italic">
                    LoadState
                   </i>
                  </b>
                  which we can use to show or hide the loading view based on if the data is getting loaded or not and add it to the adapter we use
                  <b class="graf--bold">
                   withLoadStateHeaderAndFooter
                  </b>
                  like,
                 </p>
                 <pre><code class="language-java graf graf--code">mainListAdapter.withLoadStateHeaderAndFooter(
    header = HeaderFooterAdapter(),
    footer = HeaderFooterAdapter()
)</code></pre>
                 <p class="graf--p">
                  If we want to just add a footer we will use,
                 </p>
                 <pre><code class="language-java graf graf--code">mainListAdapter.withLoadStateFooter(
    HeaderFooterAdapter()
}</code></pre>
                 <p class="graf--p">
                  and to use with header we use,
                 </p>
                 <pre><code class="language-java graf graf--code">mainListAdapter.withLoadStateHeader(
   HeaderFooterAdapter()
)</code></pre>
                 <p class="graf--p">
                  And now, if the data is getting loaded from the paging library, the footer/header is displayed based on which one or both are attached to the RecyclerView adapter.
                 </p>
                 <h4 class="graf--h3">
                  Using it with RxJava
                 </h4>
                 <p class="graf--p">
                  If we don't want to use it with Coroutines and Flow and want to go ahead and use RxJava, we still need to follow the above steps but with few changes.
                 </p>
                 <p class="graf--p">
                  Let me list them down.
                 </p>
                 <h4 class="graf--h3">
                  Step 01.
                 </h4>
                 <p class="graf--p">
                  First, we need to add the dependencies for Paging 3 Rx support,
                 </p>
                 <pre><code class="language-java graf graf--code">implementation "androidx.paging:paging-rxjava2:{latest-version}"</code></pre>
                 <p class="graf--p">
                  and we will also add the dependency for RxJava2 adapter factory,
                 </p>
                 <pre><code class="language-java graf graf--code">implementation "com.squareup.retrofit2:adapter-rxjava2:{latest-version}"</code></pre>
                 <h4 class="graf--h3">
                  Step 02.
                 </h4>
                 <p class="graf--p">
                  Now, as a next step, we need to update the PostDataSource and extend it using
                  <b class="graf--bold">
                   RxPagingSource
                  </b>
                  in place of
                  <b class="graf--bold">
                   PagingSource
                  </b>
                  like,
                 </p>
                 <pre><code class="language-java graf graf--code">class PostDataSource(private val apiService: APIService) : RxPagingSource&lt;Int, Data&gt;() {

}</code></pre>
                 <p class="graf--p">
                  Now, the
                  <b class="graf--bold">
                   PostDataSource
                  </b>
                  will implement the loadSingle function of return type
                  <b class="graf--bold">
                   Single
                  </b>
                  like,
                 </p>
                 <pre><code class="language-java graf graf--code">override fun loadSingle(params: LoadParams&lt;Int&gt;): Single&lt;LoadResult&lt;Int, Data&gt;&gt; {

}</code></pre>
                 <h4 class="graf--h3">
                  Step 03.
                 </h4>
                 <p class="graf--p">
                  Now, we will update the
                  <b class="graf--bold">
                   APIService
                  </b>
                  interface like,
                 </p>
                 <pre><code class="language-java graf graf--code">interface APIService {

    @GET("api/users")
     fun getListData(@Query("page") pageNumber: Int): Single&lt;ApiResponse&gt;

    companion object {

        private val moshi = Moshi.Builder()
            .add(KotlinJsonAdapterFactory())
            .build()

        fun getApiService() = Retrofit.Builder()
            .baseUrl("https://reqres.in/")
            .addCallAdapterFactory(RxJava2CallAdapterFactory.create())
            .addConverterFactory(MoshiConverterFactory.create(moshi))
            .build()
            .create(APIService::class.java)
    }
}</code></pre>
                 <p class="graf--p">
                  Here, the
                  <b class="graf--bold">
                   getListData
                  </b>
                  returns a Single and is not a suspend function anymore. And we have added another adapter factory to support RxJava2 to the Retrofit builder.
                 </p>
                 <h4 class="graf--h3">
                  Step 04.
                 </h4>
                 <p class="graf--p">
                  Now, inside the loadSingle function, we can do our tasks and return
                  <b class="graf--bold">
                   LoadResult.Page
                  </b>
                  object if the output is successful or
                  <b class="graf--bold">
                   LoadResult.Error
                  </b>
                  if it isn't.
                 </p>
                 <p class="graf--p">
                  And to get the data from the PostDataSource to ViewModel we will update the
                  <b class="graf--bold">
                   listData
                  </b>
                  variable in
                  <b class="graf--bold">
                   MainViewModel
                  </b>
                  like,
                 </p>
                 <pre><code class="language-java graf graf--code">val listData = Pager(PagingConfig(pageSize = 6)) {
    PostDataSource(apiService)
}.flowable.cachedIn(viewModelScope)</code></pre>
                 <p class="graf--p">
                  This will return a Flowable of PagingData and their rest remains the same as above.
                 </p>
                 <p class="graf--p">
                  We can also pass make
                  <b class="graf--bold">
                   listData
                  </b>
                  of type Observable of PagingData like,
                 </p>
                 <pre><code class="language-java graf graf--code">val listData = Pager(PagingConfig(pageSize = 6)) {
    PostDataSource(apiService)
}.observable.cachedIn(viewModelScope)</code></pre>
                 <p class="graf--p">
                  The MainListAdapter remains untouched and in the
                  <b class="graf--bold">
                   setupView
                  </b>
                  function in MainActivity gets updated like,
                 </p>
                 <pre><code class="language-java graf graf--code">viewModel.listData.subscribe { 
    mainListAdapter.submitData(lifecycle,it)
}</code></pre>
                 <p class="graf--p">
                  Here, we are passing the lifecycle of the View and the paging data to submit data to inflate the list.
                 </p>
                 <p class="graf--p">
                  This is how you can use the Paging 3 library with RxJava as well.
                 </p>
                 <h4 class="graf--h3">
                  Conclusion
                 </h4>
                 <p class="graf--p">
                  Paging 3 library is still in its early stage and it is completely re-written using Kotlin coroutines but it can be used with Flow and RxJava both.
                 </p>
                 <p class="graf--p">
                  <a class="markup--anchor" href="https://github.com/MindorksOpenSource/Paging3-Android-Tutorial" target="_blank">
                   You can find the complete project here.
                  </a>
                 </p>
                 <p class="graf--p">
                  Happy learning.
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Team MindOrks :)
                  </b>
                 </p>
                </div>
               </div>
              </div>
             </section>
            </div>
           </div>
          </div>
         </article>
        </div>
       </div>
       <div class="ui divider">
       </div>
      </div>
      <div class="stretched fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui large center aligned header" style="padding-top:20px">
        Recommended for You
       </div>
      </div>
      <div class="fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui centered grid">
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/implementing-paging-library-in-android/">
          <img alt="Implementing Paging Library in Android" class="ui centered image" src="/images/implementing-paging-library-in-android-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Implementing Paging Library in Android
           </div>
           <div class="meta">
            28th June 2019
           </div>
           <div class="description">
            In this blog, we will learn how to implement Paging Library in Android. Paging Library is used to get only a selected amount of data out of a heap of data i.e. at a particular instant of time only the desired amount of data will be loaded in the application. This feature is very important for applications using infinite scrolling. We have created a full tutorial for Paging.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/implementing-easy-permissions-in-android-android-tutorial/">
          <img alt="Implementing Easy Permissions in Android: Android Tutorial" class="ui centered image" src="/images/implementing-easy-permissions-android-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Implementing Easy Permissions in Android: Android Tutorial
           </div>
           <div class="meta">
            13th June 2019
           </div>
           <div class="description">
            In this blog, we will learn how to implement Easy Permissions in Android. Easy Permissions are used to ask for permissions required by the application explicitly. These are used to ask users for permissions that are dangerous in nature and involves user privacy.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/animation-in-android-tutorial/">
          <img alt="Animation in Android - Android Tutorial" class="ui centered image" src="/images/animation-in-android-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Animation in Android - Android Tutorial
           </div>
           <div class="meta">
            24th June 2019
           </div>
           <div class="description">
            In this blog, we will learn how to use Animation in our Andoird Application. Animations are used to convey the message in a better way. It helps in improving the user experience. So, this blog is all about Animations in Android. So, let's learn about Animation.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/using-android-sensors-android-tutorial/">
          <img alt="Using Android Sensors: Android Tutorial" class="ui centered image" src="/images/using-android-sensors-android-tutorial-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Using Android Sensors: Android Tutorial
           </div>
           <div class="meta">
            30th September 2019
           </div>
           <div class="description">
            In this blog, we will learn how to use Android Sensors. There are various sensors present in our Android device and we can use them in our application. For example, we can use the temperature sensor in some weather app. So, let's learn about Android Sensors.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/getting-started-with-android-ndk-android-tutorial/">
          <img alt="Getting started with Android NDK: Android Tutorial" class="ui centered image" src="/images/getting-started-with-android-ndk-android-tutorial-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Getting started with Android NDK: Android Tutorial
           </div>
           <div class="meta">
            9th October 2019
           </div>
           <div class="description">
            In this blog, we will learn how to use Android NDK. We will learn the use of native codes i.e. C and C++ in Android development. So, let's learn about Android development in a native way.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/powerful-android-orm-greendao-3-tutorial/">
          <img alt="Powerful Android ORM: greenDAO 3 Tutorial" class="ui centered image" src="https://s3.ap-south-1.amazonaws.com/mindorks/blogs/powerful-android-orm-greendao-3-tutorial-cover.jpg" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Powerful Android ORM: greenDAO 3 Tutorial
           </div>
           <div class="meta">
            13th February 2017
           </div>
           <div class="description">
            greenDAO is an open source Android ORM making development for SQLite databases easy. It relieves developers from dealing with low-level database requirements while saving development time.
           </div>
          </div>
         </a>
        </div>
       </div>
      </div>
     </div>
    </div>
    <div style="background:#fff">
     <footer class="content-container">
      <div class="ui centered padded grid" style="padding-top:40px;background:linear-gradient(to right,#c4e0e0,#e5f1f1)">
       <h2 class="ui huge icon center aligned header">
        <div class="content">
         Connect With Your Mentors
        </div>
       </h2>
       <div class="centered row">
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Janishar Ali" class="ui medium circular image" src="/assets/ali.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://janisharali.com" target="_blank">
             Janishar Ali
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://janisharali.com" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/janisharali" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Amit Shekhar" class="ui medium circular image" src="/assets/amit.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://amitshekhar.me" target="_blank">
             Amit Shekhar
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://amitshekhar.me" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/amitiitbhu" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div class="ui divider" style="margin:unset">
      </div>
      <h5 class="ui header" style="padding:16px;margin:unset;color:#555">
       <i aria-hidden="true" class="copyright icon">
       </i>
       <div class="content">
        Copyright 2022, MindOrks Nextgen Private Limited
       </div>
      </h5>
     </footer>
    </div>
   </div>
  </div>
  <script type="text/javascript">
   window.hljs.initHighlightingOnLoad()
  </script>
 </body>
</html>