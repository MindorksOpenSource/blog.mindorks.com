<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title>
   MVI Architecture - Android Tutorial for Beginners - Step By Step Guide
  </title>
  <meta charset="utf-8"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="minimum-scale=1,initial-scale=1,width=device-width,shrink-to-fit=no" name="viewport"/>
  <link href="https://blog.mindorks.com/mvi-architecture-android-tutorial-for-beginners-step-by-step-guide" rel="canonical"/>
  <meta content="986249072156-dabps0lf90smluddrk5rkqsdjghk3hd3.apps.googleusercontent.com" name="google-signin-client_id"/>
  <meta content="android, learn android app development, android app development courses, android blogs, android tutorial" name="keywords"/>
  <meta content="MVI Architecture - Android Tutorial for Beginners - Step By Step Guide" property="og:title"/>
  <meta content="website" property="og:type"/>
  <meta content="https://blog.mindorks.com/mvi-architecture-android-tutorial-for-beginners-step-by-step-guide" property="og:url"/>
  <meta content="/images/mvi-6e0666a81fd24f41.png" property="og:image"/>
  <meta content="In this tutorial, first, we are going to learn about the MVI architecture in Android, and then we will build a project with MVI architecture. This tutorial is for beginners who want to get started with the MVI architecture." property="og:description"/>
  <meta content="MVI Architecture - Android Tutorial for Beginners - Step By Step Guide" property="twitter:title"/>
  <meta content="In this tutorial, first, we are going to learn about the MVI architecture in Android, and then we will build a project with MVI architecture. This tutorial is for beginners who want to get started with the MVI architecture." name="twitter:description"/>
  <meta content="/images/mvi-6e0666a81fd24f41.png" name="twitter:image:src"/>
  <meta content="summary_large_image" name="twitter:card"/>
  <meta content="@MindorksNextGen" name="twitter:site"/>
  <meta content="In this tutorial, first, we are going to learn about the MVI architecture in Android, and then we will build a project with MVI architecture. This tutorial is for beginners who want to get started with the MVI architecture." name="description"/>
  <meta content="1620001391374687" property="fb:app_id"/>
  <link href="/styles/vendor-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link href="/styles/app-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link as="style" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" onload='this.onload=null,this.rel="stylesheet"' rel="preload"/>
  <noscript>
   <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
  </noscript>
  <script type="text/javascript">
   window.__PRELOADED_STATE__={toastr:{toastrs:[],confirm:null},blogData:{data:{},latestBlogs:null,isFetching:!0,isFetchingLatestBlogs:!1,currentCategory:"",categories:[]},contactData:{formData:{email:"",name:"",phone:"",message:"",isWriting:!1,isNameError:!1,isEmailError:!1,isPhoneError:!1,isMessageError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSending:!1},communityData:{formData:{email:"",isEmailError:!1,isWriting:!1,isSending:!1,dismissMsg:!1},successMessage:null,errorMessage:null},blogPageData:{blogId:485,data:{id:485,title:"MVI Architecture - Android Tutorial for Beginners - Step By Step Guide",description:"In this tutorial, first, we are going to learn about the MVI architecture in Android, and then we will build a project with MVI architecture. This tutorial is for beginners who want to get started with the MVI architecture.",text:'<h1 class="graf--h1">MVI Architecture - Android Tutorial for Beginners - Step By Step Guide</h1> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/mvi-6e0666a81fd24f41.png class=\'graf-image\' alt=\'MVI Architecture - Android Tutorial for Beginners - Step By Step Guide\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">Android architectural patterns are evolving day by day.  As we develop apps, we start facing new challenges and issues. New patterns will be discovered as we keep solving similar challenges. As Android Developers, we have MVC, MVP, and MVVM as the most commonly used patterns. All of them use an imperative programming approach.  With this approach even though most of our challenges will be resolved, we still face some challenges regarding the thread safety, maintaining states of the application. With this let’s see what MVI architectural pattern is, how it resolves these challenges, and how to get started on MVI.</p><p class="graf--p">In this blog, I will walk you through,</p><ul><li>What is MVI architecture?</li><li>How does the MVI work?</li><li>Advantages and Disadvantages of MVI</li><li>Creating a Project with MVI architecture</li><li>Project Source Code and What Next?</li></ul><h4 class="graf--h3">What is MVI architecture?</h4><p class="graf--p">MVI stands for <b class="graf--bold">Model-View-Intent</b>. This pattern has been introduced recently in Android. It works based on the principle of unidirectional and cylindrical flow inspired by the Cycle.js framework.</p><p class="graf--p">Let’s see what is the role of each component of MVI.</p><ul><li><b class="graf--bold">Model: </b>Unlike other patterns, In MVI <b class="graf--bold">Model</b> represents the state of the UI. i.e for example UI might have different states like Data Loading, Loaded, Change in UI with user Actions, Errors, User current screen position states. Each state is stored as similar to the object in the model. </li><li><b class="graf--bold">View: </b>The View in the MVI is our Interfaces which can be implemented in Activities and fragments. It means to have a container which can accept the different model states and display it as a UI. They use observable intents(Note: This doesn&#x27;t represent the Android traditional Intents) to respond to user actions.</li><li><b class="graf--bold">Intent: </b>Even though this is not an Intent as termed by Android from before. The result of the user actions is passed as an input value to Intents. In turn, we can say we will be sending models as inputs to the Intents which can load it through Views.</li></ul><h4 class="graf--h3">How does the MVI work?</h4><p class="graf--p">User does an action which will be an Intent → Intent is a state which is an input to model → Model stores state and send the requested state to the View → View Loads the state from Model → Displays to the user. If we observe, the data will always flow from the user and end with the user through intent. It cannot be the other way, Hence its called Unidirectional architecture. If the user does one more action the same cycle is repeated, hence it is Cyclic.</p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/mvi_cyclic-49d9f8c2d3fe26b7.png class=\'graf-image\' alt=\'MVI Architecture - Android Tutorial for Beginners - Step By Step Guide\' />\n\t\t\t\t\t\t\t\t</div ><h4 class="graf--h3">Advantages and Disadvantages of MVI</h4><p class="graf--p">Let’s see what are the advantages and disadvantages of MVI</p><p class="graf--p"><b class="graf--bold">Advantages of MVI</b></p><ul><li>Maintaining state is no more a challenge with this architecture, As it focuses mainly on states.</li><li>As it is unidirectional, Data flow can be tracked and predicted easily.</li><li>It ensures thread safety as the state objects are immutable.</li><li>Easy to debug, As we know the state of the object when the error occurred.</li><li>It&#x27;s more decoupled as each component fulfills its own responsibility.</li><li>Testing the app also will be easier as we can map the business logic for each state.</li></ul><p class="graf--p"><b class="graf--bold">Disadvantages of MVI</b></p><ul><li>It leads to lots of boilerplate code as we have to maintain a state for each user action.</li><li>As we know it has to create lots of objects for all the states. This makes it too costly for app memory management. </li><li>Handling alert states might be challenging while we handle configuration changes. For example, if there is no internet we will show the snackbar, On configuration change, it shows the snackbar again as its the state of the intent. In terms of usability, this has to be handled.</li></ul><p class="graf--p">With this background, let’s create a small app with MVI </p><h4 class="graf--h3">Creating a Project with MVI architecture</h4><p class="graf--p">Let&#x27;s start by setting up the Android project.</p><p class="graf--p">We are trying to achieve this in our Android project</p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/mvi_1-9856d13ed93fdb60.png class=\'graf-image\' alt=\'MVI Architecture - Android Tutorial for Beginners - Step By Step Guide\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p"><b class="graf--bold">Create a Project</b></p><ul><li>Start a new Android project</li><li>Select Empty Activity and Next</li><li>Name: MVI-Architecture-Android-Beginners</li><li>Package name: com.mindorks.framework.mvi</li><li>Language: Kotlin</li><li>Finish</li><li>Your starting project is ready now</li></ul><p class="graf--p"><b class="graf--bold">Add dependencies</b></p><pre><code class="language-java graf graf--code">// Added Dependencies\nimplementation "androidx.recyclerview:recyclerview:1.1.0"\nimplementation \'android.arch.lifecycle:extensions:1.1.1\'\nimplementation \'androidx.lifecycle:lifecycle-viewmodel-ktx:2.2.0\'\nimplementation \'androidx.lifecycle:lifecycle-runtime-ktx:2.2.0\'\nimplementation \'com.github.bumptech.glide:glide:4.11.0\'\n\n//retrofit\nimplementation \'com.squareup.retrofit2:retrofit:2.8.1\'\nimplementation "com.squareup.retrofit2:converter-moshi:2.6.2"\n\n//Coroutine\nimplementation "org.jetbrains.kotlinx:kotlinx-coroutines-android:1.3.6"\nimplementation "org.jetbrains.kotlinx:kotlinx-coroutines-core:1.3.6"</code></pre><p class="graf--p"><b class="graf--bold">Project Structure</b></p><p class="graf--p">For the project, We are going to follow a beginner version of MVI. Our package in the project will look like below.  </p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/mvi_folder_structure-1a1f6b88f42ee672.png class=\'graf-image\' alt=\'MVI Architecture - Android Tutorial for Beginners - Step By Step Guide\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p"><b class="graf--bold">Setup Data Layer</b></p><p class="graf--p">Now, in this section, we will set up the data layer.<br/>Under the data package, we will have api, model, and repository packages. We will create these packages and let’s concentrate on adding classes to each package one by one.</p><p class="graf--p">Let’s add classes supporting API.</p><p class="graf--p">We need a model to which the response will be transformed. Create User.kt data class as shown below.</p><pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.data.model\n\nimport com.squareup.moshi.Json\n\ndata class User(\n    @Json(name = "id")\n    val id: Int = 0,\n    @Json(name = "name")\n    val name: String = "",\n    @Json(name = "email")\n    val email: String = "",\n    @Json(name = "avatar")\n    val avatar: String = ""\n)</code></pre><p class="graf--p">Create ApiHelper.kt interface</p><pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.data.api\n\nimport com.mindorks.framework.mvi.data.model.User\n\ninterface ApiHelper {\n\n    suspend fun getUsers(): List&lt;User&gt;\n\n}</code></pre><blockquote class="graf--blockquote">Note: We have used suspend keyword to support Coroutines so that we can call it from a Coroutine or another suspend function.</blockquote><p class="graf--p">Kotlin-Coroutines and Flow API are used in this project. You can learn from the following:</p><ul><li><a class="markup--anchor" target="_blank" href="https://amitshekhar.me/blog/kotlin-coroutines">Kotlin-Coroutines</a></li><li><a class="markup--anchor" target="_blank" href="https://github.com/amitshekhariitbhu/Learn-Kotlin-Flow">Kotlin Flow API</a></li></ul><p class="graf--p">Create a class ApiService.kt where we will specify HTTP methods to communicate to the API.</p><pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.data.api\n\nimport com.mindorks.framework.mvi.data.model.User\nimport retrofit2.http.GET\n\ninterface ApiService {\n\n   @GET("users")\n   suspend fun getUsers(): List&lt;User&gt;\n}</code></pre><p class="graf--p">Now add retrofit builder which will build endpoint URL and consume REST services.</p><pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.data.api\n\nimport retrofit2.Retrofit\nimport retrofit2.converter.moshi.MoshiConverterFactory\n\nobject RetrofitBuilder {\n\n    private const val BASE_URL = "https://5e510330f2c0d300147c034c.mockapi.io/"\n\n    private fun getRetrofit() = Retrofit.Builder()\n        .baseUrl(BASE_URL)\n        .addConverterFactory(MoshiConverterFactory.create())\n        .build()\n\n\n    val apiService: ApiService = getRetrofit().create(ApiService::class.java)\n\n}</code></pre><p class="graf--p">Now we need to implement this interface to fetch the List&lt;Users&gt;, create ApiHelperImpl.kt</p><pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.data.api\n\nimport com.mindorks.framework.mvi.data.model.User\n\nclass ApiHelperImpl(private val apiService: ApiService) : ApiHelper {\n\n    override suspend fun getUsers(): List&lt;User&gt; {\n        return apiService.getUsers()\n    }\n}</code></pre><p class="graf--p">Now we are ready to communicate with restful services in our data layer.</p><p class="graf--p">We will need a repository to requests data. In our case, we are calling the <code class="graf--code-inline">getUsers</code> method from activity through ViewModel to get the user list. Create <i class="graf--italic"><b class="graf--bold">MainRepository.kt</b></i></p><pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.data.repository\n\nimport com.mindorks.framework.mvi.data.api.ApiHelper\n\n\nclass MainRepository(private val apiHelper: ApiHelper) {\n\n    suspend fun getUsers() = apiHelper.getUsers()\n\n}</code></pre><p class="graf--p">So our data layer is ready. Coming to UI part now, we need an adapter to recyclerview, Intent for storing user actions, our main activity under view, MainViewModel under viewModel, View state where we have defined different states for which we need to load data to views.</p><p class="graf--p">Create MainAdapter in adapter package</p><pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.ui.main.adapter\n\nimport android.view.LayoutInflater\nimport android.view.View\nimport android.view.ViewGroup\nimport androidx.recyclerview.widget.RecyclerView\nimport com.bumptech.glide.Glide\nimport com.mindorks.framework.mvi.R\nimport com.mindorks.framework.mvi.data.model.User\nimport kotlinx.android.synthetic.main.item_layout.view.*\n\nclass MainAdapter(\n    private val users: ArrayList&lt;User&gt;\n) : RecyclerView.Adapter&lt;MainAdapter.DataViewHolder&gt;() {\n\n    class DataViewHolder(itemView: View) : RecyclerView.ViewHolder(itemView) {\n        fun bind(user: User) {\n            itemView.textViewUserName.text = user.name\n            itemView.textViewUserEmail.text = user.email\n            Glide.with(itemView.imageViewAvatar.context)\n                .load(user.avatar)\n                .into(itemView.imageViewAvatar)\n        }\n    }\n\n    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int) =\n        DataViewHolder(\n            LayoutInflater.from(parent.context).inflate(\n                R.layout.item_layout, parent,\n                false\n            )\n        )\n\n    override fun getItemCount(): Int = users.size\n\n    override fun onBindViewHolder(holder: DataViewHolder, position: Int) =\n        holder.bind(users[position])\n\n    fun addData(list: List&lt;User&gt;) {\n        users.addAll(list)\n    }\n\n}</code></pre><p class="graf--p">Create MainIntent.kt under the intent package</p><pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.ui.main.intent\n\nsealed class MainIntent {\n\n    object FetchUser : MainIntent()\n\n}</code></pre><p class="graf--p">Now adding the <b class="graf--bold"><i class="graf--italic">MainState.kt </i></b>under viewstate package. This is the most important part of MVI. In this class, we are defining the states Idle, loading, users, error. Each state can be loaded on to the view by the user intents.</p><pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.ui.main.viewstate\n\nimport com.mindorks.framework.mvi.data.model.User\n\nsealed class MainState {\n\n    object Idle : MainState()\n    object Loading : MainState()\n    data class Users(val user: List&lt;User&gt;) : MainState()\n    data class Error(val error: String?) : MainState()\n\n}</code></pre><p class="graf--p">Create a ViewModel class - MainViewModel</p><pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.ui.main.viewmodel\n\nimport androidx.lifecycle.ViewModel\nimport androidx.lifecycle.viewModelScope\nimport com.mindorks.framework.mvi.data.repository.MainRepository\nimport com.mindorks.framework.mvi.ui.main.intent.MainIntent\nimport com.mindorks.framework.mvi.ui.main.viewstate.MainState\nimport kotlinx.coroutines.ExperimentalCoroutinesApi\nimport kotlinx.coroutines.channels.Channel\nimport kotlinx.coroutines.flow.MutableStateFlow\nimport kotlinx.coroutines.flow.StateFlow\nimport kotlinx.coroutines.flow.collect\nimport kotlinx.coroutines.flow.consumeAsFlow\nimport kotlinx.coroutines.launch\n\n@ExperimentalCoroutinesApi\nclass MainViewModel(\n    private val repository: MainRepository\n) : ViewModel() {\n\n    val userIntent = Channel&lt;MainIntent&gt;(Channel.UNLIMITED)\n    private val _state = MutableStateFlow&lt;MainState&gt;(MainState.Idle)\n    val state: StateFlow&lt;MainState&gt;\n        get() = _state\n\n    init {\n        handleIntent()\n    }\n\n    private fun handleIntent() {\n        viewModelScope.launch {\n            userIntent.consumeAsFlow().collect {\n                when (it) {\n                    is MainIntent.FetchUser -&gt; fetchUser()\n                }\n            }\n        }\n    }\n\n    private fun fetchUser() {\n        viewModelScope.launch {\n            _state.value = MainState.Loading\n            _state.value = try {\n                MainState.Users(repository.getUsers())\n            } catch (e: Exception) {\n                MainState.Error(e.localizedMessage)\n            }\n        }\n    }\n}</code></pre><p class="graf--p">Here in the ViewModel, we are observing on the <code class="graf--code-inline">userIntent</code> to perform the action on it.</p><p class="graf--p">And based on the response from the data layer, we change the state inside the <code class="graf--code-inline">fetchUser</code> method. And that state is being observed in the MainActivity.</p><p class="graf--p">Let us set up ViewModelFactory under the util package.</p><p class="graf--p">We are instantiating our viewModel in this class and we will return the instance of the ViewModel.</p><pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.util\n\nimport androidx.lifecycle.ViewModel\nimport androidx.lifecycle.ViewModelProvider\nimport com.mindorks.framework.mvi.data.api.ApiHelper\nimport com.mindorks.framework.mvi.data.repository.MainRepository\nimport com.mindorks.framework.mvi.ui.main.viewmodel.MainViewModel\n\nclass ViewModelFactory(private val apiHelper: ApiHelper) : ViewModelProvider.Factory {\n\n    override fun &lt;T : ViewModel?&gt; create(modelClass: Class&lt;T&gt;): T {\n        if (modelClass.isAssignableFrom(MainViewModel::class.java)) {\n            return MainViewModel(MainRepository(apiHelper)) as T\n        }\n        throw IllegalArgumentException("Unknown class name")\n    }\n\n}</code></pre><p class="graf--p">Now, let&#x27;s set up the XML layout.</p><p class="graf--p">In the layout folder, update the activity_main.xml with the following code:</p><pre><code class="language-java graf graf--code">&lt;?xml version="1.0" encoding="utf-8"?&gt;\n&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"\n    xmlns:app="http://schemas.android.com/apk/res-auto"\n    xmlns:tools="http://schemas.android.com/tools"\n    android:layout_width="match_parent"\n    android:layout_height="match_parent"\n    tools:context=".ui.main.view.MainActivity"&gt;\n\n    &lt;androidx.recyclerview.widget.RecyclerView\n        android:id="@+id/recyclerView"\n        android:layout_width="match_parent"\n        android:layout_height="match_parent"\n        android:visibility="gone" /&gt;\n\n    &lt;ProgressBar\n        android:id="@+id/progressBar"\n        android:layout_width="wrap_content"\n        android:layout_height="wrap_content"\n        app:layout_constraintBottom_toBottomOf="parent"\n        app:layout_constraintEnd_toEndOf="parent"\n        android:visibility="gone"\n        app:layout_constraintStart_toStartOf="parent"\n        app:layout_constraintTop_toTopOf="parent" /&gt;\n\n    &lt;Button\n        android:id="@+id/buttonFetchUser"\n        android:layout_width="wrap_content"\n        android:layout_height="wrap_content"\n        android:text="@string/fetch_user"\n        app:layout_constraintBottom_toBottomOf="parent"\n        app:layout_constraintEnd_toEndOf="parent"\n        app:layout_constraintStart_toStartOf="parent"\n        app:layout_constraintTop_toTopOf="parent" /&gt;\n\n&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</code></pre><p class="graf--p">Add item_layout.xml in the layout folder and add the following code:</p><pre><code class="language-java graf graf--code">&lt;?xml version="1.0" encoding="utf-8"?&gt;\n&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"\n    xmlns:app="http://schemas.android.com/apk/res-auto"\n    xmlns:tools="http://schemas.android.com/tools"\n    android:id="@+id/container"\n    android:layout_width="match_parent"\n    android:layout_height="60dp"&gt;\n\n    &lt;ImageView\n        android:id="@+id/imageViewAvatar"\n        android:layout_width="60dp"\n        android:layout_height="0dp"\n        android:padding="4dp"\n        app:layout_constraintBottom_toBottomOf="parent"\n        app:layout_constraintStart_toStartOf="parent"\n        app:layout_constraintTop_toTopOf="parent" /&gt;\n\n    &lt;androidx.appcompat.widget.AppCompatTextView\n        android:id="@+id/textViewUserName"\n        style="@style/TextAppearance.AppCompat.Large"\n        android:layout_width="0dp"\n        android:layout_height="wrap_content"\n        android:layout_marginStart="8dp"\n        android:layout_marginTop="4dp"\n        app:layout_constraintEnd_toEndOf="parent"\n        app:layout_constraintStart_toEndOf="@+id/imageViewAvatar"\n        app:layout_constraintTop_toTopOf="parent"\n        tools:text="MindOrks" /&gt;\n\n    &lt;androidx.appcompat.widget.AppCompatTextView\n        android:id="@+id/textViewUserEmail"\n        android:layout_width="0dp"\n        android:layout_height="wrap_content"\n        app:layout_constraintEnd_toEndOf="parent"\n        app:layout_constraintStart_toStartOf="@+id/textViewUserName"\n        app:layout_constraintTop_toBottomOf="@+id/textViewUserName"\n        tools:text="MindOrks" /&gt;\n\n&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</code></pre><p class="graf--p">Add the following in strings.xml.</p><pre><code class="language-java graf graf--code">&lt;string name="fetch_user"&gt;Fetch User&lt;/string&gt;</code></pre><p class="graf--p">Coming to our MainAcitvity.kt class, We will be adding this under view package. This is the user-facing activity that takes input from the user, based on this MVI checks for the states mentioned in viewModel and loads the particular state in the view.</p><p class="graf--p">Let&#x27;s see how MainActivity takes care of requesting data, handling states</p><pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.ui.main.view\n\nimport android.os.Bundle\nimport android.view.View\nimport android.widget.Toast\nimport androidx.appcompat.app.AppCompatActivity\nimport androidx.lifecycle.ViewModelProviders\nimport androidx.lifecycle.lifecycleScope\nimport androidx.recyclerview.widget.DividerItemDecoration\nimport androidx.recyclerview.widget.LinearLayoutManager\nimport com.mindorks.framework.mvi.R\nimport com.mindorks.framework.mvi.data.api.ApiHelperImpl\nimport com.mindorks.framework.mvi.data.api.RetrofitBuilder\nimport com.mindorks.framework.mvi.data.model.User\nimport com.mindorks.framework.mvi.util.ViewModelFactory\nimport com.mindorks.framework.mvi.ui.main.adapter.MainAdapter\nimport com.mindorks.framework.mvi.ui.main.intent.MainIntent\nimport com.mindorks.framework.mvi.ui.main.viewmodel.MainViewModel\nimport com.mindorks.framework.mvi.ui.main.viewstate.MainState\nimport kotlinx.android.synthetic.main.activity_main.*\nimport kotlinx.coroutines.ExperimentalCoroutinesApi\nimport kotlinx.coroutines.flow.collect\nimport kotlinx.coroutines.launch\n\n@ExperimentalCoroutinesApi\nclass MainActivity : AppCompatActivity() {\n\n    private lateinit var mainViewModel: MainViewModel\n    private var adapter = MainAdapter(arrayListOf())\n\n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n        setContentView(R.layout.activity_main)\n        setupUI()\n        setupViewModel()\n        observeViewModel()\n        setupClicks()\n    }\n\n    private fun setupClicks() {\n        buttonFetchUser.setOnClickListener {\n            lifecycleScope.launch {\n                mainViewModel.userIntent.send(MainIntent.FetchUser)\n            }\n        }\n    }\n\n\n    private fun setupUI() {\n        recyclerView.layoutManager = LinearLayoutManager(this)\n        recyclerView.run {\n            addItemDecoration(\n                DividerItemDecoration(\n                    recyclerView.context,\n                    (recyclerView.layoutManager as LinearLayoutManager).orientation\n                )\n            )\n        }\n        recyclerView.adapter = adapter\n    }\n\n\n    private fun setupViewModel() {\n        mainViewModel = ViewModelProviders.of(\n            this,\n            ViewModelFactory(\n                ApiHelperImpl(\n                    RetrofitBuilder.apiService\n                )\n            )\n        ).get(MainViewModel::class.java)\n    }\n\n    private fun observeViewModel() {\n        lifecycleScope.launch {\n            mainViewModel.state.collect {\n                when (it) {\n                    is MainState.Idle -&gt; {\n\n                    }\n                    is MainState.Loading -&gt; {\n                        buttonFetchUser.visibility = View.GONE\n                        progressBar.visibility = View.VISIBLE\n                    }\n\n                    is MainState.Users -&gt; {\n                        progressBar.visibility = View.GONE\n                        buttonFetchUser.visibility = View.GONE\n                        renderList(it.user)\n                    }\n                    is MainState.Error -&gt; {\n                        progressBar.visibility = View.GONE\n                        buttonFetchUser.visibility = View.VISIBLE\n                        Toast.makeText(this@MainActivity, it.error, Toast.LENGTH_LONG).show()\n                    }\n                }\n            }\n        }\n    }\n\n    private fun renderList(users: List&lt;User&gt;) {\n        recyclerView.visibility = View.VISIBLE\n        users.let { listOfUsers -&gt; listOfUsers.let { adapter.addData(it) } }\n        adapter.notifyDataSetChanged()\n    }\n}</code></pre><p class="graf--p">Here, we are sending the intent to fetch the data on button click(User Action).</p><p class="graf--p">Also, we are observing on the ViewModel State for the state changes. And, using &quot;when&quot; condition we are comparing the response intent state and loading the respective states.</p><p class="graf--p">Finally, add the Internet Permission in your project. Add the following in the AndroidManifest.xml:</p><pre><code class="language-java graf graf--code">&lt;uses-permission android:name="android.permission.INTERNET"/&gt;</code></pre><p class="graf--p">Now, build the project and run the app on the device. It should load the data into the UI.</p><h4 class="graf--h3"><b class="graf--bold">Project Source Code and What Next?</b></h4><p class="graf--p">For the project source code, check <b class="graf--bold"><a class="markup--anchor" target="_blank" href="https://github.com/MindorksOpenSource/MVI-Architecture-Android-Beginners">here</a></b>.</p><p class="graf--p">As we have done some simplifications in this project for the Beginners level, so, we can improve this project to go to the Advanced level, a few of the things which we can improve are as follows:</p><ul><li>Implement Dependency Inject Framework - <span class=""><a class="markup--anchor" target="_blank" href="https://blog.mindorks.com/a-complete-guide-to-learn-dagger-2-b4c7a570d99c">Dagger</a></span> in the project.</li><li>Make ApiService Singleton and reuse the same instance for all the features.</li><li>Create base classes such as BaseActivity.</li><li>Handle all the API errors at a single place in a better way.</li><li>Create Interfaces for the classes wherever required.</li><li>Take advantage of <span class=""><a class="markup--anchor" target="_blank" href="https://blog.mindorks.com/android-ktx-android-development-with-kotlin">Android KTX - Kotlin Extensions</a></span>.</li><li>Write Unit-Test</li><li>and so on.</li></ul><p class="graf--p">I hope you have learned the MVI architecture in Android.</p><p class="graf--p"><i class="graf--italic">Keep Learning, Keep Exploring, Keep Growing</i></p><p class="graf--p"><i class="graf--italic">Thank you</i></p>',author:17597,img_url:"/images/mvi-6e0666a81fd24f41.png",blog_url:"mvi-architecture-android-tutorial-for-beginners-step-by-step-guide",likes:0,rank:0,category:1,published_at:"17th June 2020"},author:{id:17597,name:"Shwetha Vasudev",google_profile_pic:"https://lh3.googleusercontent.com/a-/AOh14GhaMhnt96YUNN_sGizdGjFBXFnoCGRejMHnpG_Id84=s96-c?sz=300",fb_profile_pic:null,profile_tagline:"An Android Engineer with enthusiasm and eager to learn and explore new technologies. ",fb_profile_url:"https://www.facebook.com/shwetha.vasudev/",google_plus_profile_url:null,twitter_profile_url:"https://twitter.com/ShwethaV9",github_profile_url:"https://github.com/ShweV",linkedin_profile_url:"https://www.linkedin.com/in/shwetha-vasudev-61383659"},isFetching:!1,similarBlogs:[{id:358,title:"Java Tutorial For Beginners - Learn Java From Basics",description:"In this blog, we will learn how to get started with Java from basics. ",author:9959,img_url:"/images/java-basics.png",blog_url:"java-tutorial-for-beginners-learn-java-from-basics",likes:0,rank:0,category:1,published_at:"8th October 2019",score:3.6215922832489014},{id:420,title:"Using WebViews in Flutter: Tutorial",description:"In this blog, we will learn how to use WebViews in Flutter. WebViews are very important to open some web pages inside your application.",author:17146,img_url:"/images/using-webviews-in-flutter-tutorial-banner.jpg",blog_url:"using-webviews-in-flutter-tutorial",likes:0,rank:0,category:9,published_at:"20th April 2020",score:.8256809115409851}],isSimilarBlogsFetching:!1},loginData:{data:null,isLoggingIn:!1,isLoggingOut:!1,loginState:!1,isForcedLogout:!1,isTokenRefreshed:!1,isRedirectHome:!1,message:""},updatesData:{news:null,inspirations:null,isNewsFetching:!0,isInspirationsFetching:!0},blogEditorData:{blogId:null,blogDetailsFormData:{title:"",description:"",imgUrl:"",blogUrl:"",category:"",categories:[],isWriting:!1,isTitleError:!1,isDescriptionError:!1,isImgUrlError:!1,isBlogUrlError:!1,isCategoryError:!1,isUploadingImage:!1,uploadedImageUrl:null},editorState:null,editorText:null,successMessage:null,errorMessage:null,isSending:!1,isMsgToShow:!1,isPublished:!1,isSubmitted:!1,isDraft:!0,isEditOfExistingBlog:!1,isFetchingBlogCategories:!1,isUploadingImage:!1,uploadedImageUrl:null},myBlogsData:{data:null,isSubmittedBlogsFetching:!0,isDraftBlogsFetching:!0,isPublishedBlogsFetching:!0,successMessage:null,errorMessage:null,isMsgToShow:!1,tabNames:["drafts","submissions","published"],selectedTab:"drafts",isFetchingBlog:!1,isDeletingBlog:!1,openEditorPage:!1},profilePreviewData:{profile:null,blogs:null,isFetchingProfile:!1,isFetchingAuthorBlogs:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,isUserNotRegistered:!1,redirectToMyProfileEdit:!1},profileEditableData:{userId:null,name:null,fbProfilePicUrl:null,googleProfilePicUrl:null,profileFormData:{tagline:"",fbProfileUrl:"",googlePlusProfileUrl:"",twitterProfileUrl:"",githubProfileUrl:"",linkedinProfileUrl:"",isWriting:!1,isTaglineError:!1,isFbProfileUrlError:!1,isGooglePlusProfileUrlError:!1,isTwitterProfileUrlError:!1,isGithubProfileUrlError:!1,isLinkedinProfileUrlError:!1},isSavingProfile:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,redirectToProfilePreview:!1},submitBlogData:{formData:{email:"",name:"",link:"",isWriting:!1,isNameError:!1,isEmailError:!1,isLinkError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSubmitting:!1},advertisementsData:{data:{},isLoading:!1},recaptchaData:{verified:!1,successMessage:null,errorMessage:null},blogSearchData:{searches:null,isSearching:!1}}
  </script>
  <script async="" src="https://www.google-analytics.com/analytics.js" type="text/javascript">
  </script>
  <script type="text/javascript">
   window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-91686131-1","auto"),ga("require","cleanUrlTracker"),ga("require","eventTracker"),ga("require","impressionTracker"),ga("require","outboundLinkTracker"),ga("require","urlChangeTracker"),ga("require","maxScrollTracker"),ga("require","mediaQueryTracker"),ga("require","outboundFormTracker"),ga("require","outboundLinkTracker"),ga("require","pageVisibilityTracker"),ga("require","socialWidgetTracker"),ga("require","urlChangeTracker"),ga("send","pageview")
  </script>
  <script defer="defer" src="/assets/autotrack.js" type="text/javascript">
  </script>
  <script src="/assets/highlight.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/vendor-bundle-1.8.6.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/app-bundle-1.8.6.js" type="text/javascript">
  </script>
 </head>
 <body>
  <div id="root">
   <div class="screen app-load-content" data-reactroot="">
    <div class="ui centered grid">
     <div class="row" style="padding:0">
      <div class="ui fixed menu navbar huge borderless grid" style="background-color:#fff;height:60px">
      </div>
     </div>
     <div class="centered computer only row" style="padding:0">
      <div class="ui fixed top menu navbar huge borderless grid header-container" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="right menu">
        <a class="item" href="https://janisharali.com" target="_blank">
         Mentor Ali
        </a>
        <a class="item" href="https://amitshekhar.me" target="_blank">
         Mentor Amit
        </a>
       </div>
      </div>
     </div>
     <div class="tablet only mobile only row" style="padding:0">
      <div class="ui fixed top navbar huge menu borderless" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="item">
       </div>
      </div>
     </div>
    </div>
    <div class="header-height">
    </div>
    <div aria-live="assertive" class="redux-toastr">
     <div>
      <div class="top-left">
      </div>
      <div class="top-right">
      </div>
      <div class="top-center">
      </div>
      <div class="bottom-left">
      </div>
      <div class="bottom-right">
      </div>
      <div class="bottom-center">
      </div>
     </div>
    </div>
    <div class="content-container theme">
     <div class="ui centered one column grid" style="padding-bottom:80px;background-color:#fff">
      <div class="ten wide computer fifteen wide mobile fifteen wide tablet column" style="margin-top:50px">
       <div>
        <div class="blog-page-author">
         <div class="ui small header">
          <img alt="Shwetha Vasudev" class="ui circular image" src="https://lh3.googleusercontent.com/a-/AOh14GhaMhnt96YUNN_sGizdGjFBXFnoCGRejMHnpG_Id84=s96-c?sz=300"/>
          <div class="content">
           Shwetha Vasudev
           <div class="sub header" style="margin-top:5px">
            17th June 2020
           </div>
          </div>
         </div>
        </div>
        <div id="content">
         <article class="template">
          <div class="postContent">
           <div class="notesSource">
            <div class="postField postField--body" id="editor">
             <section class="section--first section--last">
              <div class="section-divider layoutSingleColumn-template">
               <hr class="section-divider"/>
              </div>
              <div class="section-content">
               <div class="section-inner layoutSingleColumn-template">
                <div>
                 <h1 class="graf--h1">
                  MVI Architecture - Android Tutorial for Beginners - Step By Step Guide
                 </h1>
                 <div class="graf-image graf-caption">
                  <img alt="MVI Architecture - Android Tutorial for Beginners - Step By Step Guide" class="graf-image" src="/images/mvi-6e0666a81fd24f41.png"/>
                 </div>
                 <p class="graf--p">
                  Android architectural patterns are evolving day by day.  As we develop apps, we start facing new challenges and issues. New patterns will be discovered as we keep solving similar challenges. As Android Developers, we have MVC, MVP, and MVVM as the most commonly used patterns. All of them use an imperative programming approach.  With this approach even though most of our challenges will be resolved, we still face some challenges regarding the thread safety, maintaining states of the application. With this let’s see what MVI architectural pattern is, how it resolves these challenges, and how to get started on MVI.
                 </p>
                 <p class="graf--p">
                  In this blog, I will walk you through,
                 </p>
                 <ul>
                  <li>
                   What is MVI architecture?
                  </li>
                  <li>
                   How does the MVI work?
                  </li>
                  <li>
                   Advantages and Disadvantages of MVI
                  </li>
                  <li>
                   Creating a Project with MVI architecture
                  </li>
                  <li>
                   Project Source Code and What Next?
                  </li>
                 </ul>
                 <h4 class="graf--h3">
                  What is MVI architecture?
                 </h4>
                 <p class="graf--p">
                  MVI stands for
                  <b class="graf--bold">
                   Model-View-Intent
                  </b>
                  . This pattern has been introduced recently in Android. It works based on the principle of unidirectional and cylindrical flow inspired by the Cycle.js framework.
                 </p>
                 <p class="graf--p">
                  Let’s see what is the role of each component of MVI.
                 </p>
                 <ul>
                  <li>
                   <b class="graf--bold">
                    Model:
                   </b>
                   Unlike other patterns, In MVI
                   <b class="graf--bold">
                    Model
                   </b>
                   represents the state of the UI. i.e for example UI might have different states like Data Loading, Loaded, Change in UI with user Actions, Errors, User current screen position states. Each state is stored as similar to the object in the model.
                  </li>
                  <li>
                   <b class="graf--bold">
                    View:
                   </b>
                   The View in the MVI is our Interfaces which can be implemented in Activities and fragments. It means to have a container which can accept the different model states and display it as a UI. They use observable intents(Note: This doesn't represent the Android traditional Intents) to respond to user actions.
                  </li>
                  <li>
                   <b class="graf--bold">
                    Intent:
                   </b>
                   Even though this is not an Intent as termed by Android from before. The result of the user actions is passed as an input value to Intents. In turn, we can say we will be sending models as inputs to the Intents which can load it through Views.
                  </li>
                 </ul>
                 <h4 class="graf--h3">
                  How does the MVI work?
                 </h4>
                 <p class="graf--p">
                  User does an action which will be an Intent → Intent is a state which is an input to model → Model stores state and send the requested state to the View → View Loads the state from Model → Displays to the user. If we observe, the data will always flow from the user and end with the user through intent. It cannot be the other way, Hence its called Unidirectional architecture. If the user does one more action the same cycle is repeated, hence it is Cyclic.
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="MVI Architecture - Android Tutorial for Beginners - Step By Step Guide" class="graf-image" src="/images/mvi_cyclic-49d9f8c2d3fe26b7.png"/>
                 </div>
                 <h4 class="graf--h3">
                  Advantages and Disadvantages of MVI
                 </h4>
                 <p class="graf--p">
                  Let’s see what are the advantages and disadvantages of MVI
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Advantages of MVI
                  </b>
                 </p>
                 <ul>
                  <li>
                   Maintaining state is no more a challenge with this architecture, As it focuses mainly on states.
                  </li>
                  <li>
                   As it is unidirectional, Data flow can be tracked and predicted easily.
                  </li>
                  <li>
                   It ensures thread safety as the state objects are immutable.
                  </li>
                  <li>
                   Easy to debug, As we know the state of the object when the error occurred.
                  </li>
                  <li>
                   It's more decoupled as each component fulfills its own responsibility.
                  </li>
                  <li>
                   Testing the app also will be easier as we can map the business logic for each state.
                  </li>
                 </ul>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Disadvantages of MVI
                  </b>
                 </p>
                 <ul>
                  <li>
                   It leads to lots of boilerplate code as we have to maintain a state for each user action.
                  </li>
                  <li>
                   As we know it has to create lots of objects for all the states. This makes it too costly for app memory management.
                  </li>
                  <li>
                   Handling alert states might be challenging while we handle configuration changes. For example, if there is no internet we will show the snackbar, On configuration change, it shows the snackbar again as its the state of the intent. In terms of usability, this has to be handled.
                  </li>
                 </ul>
                 <p class="graf--p">
                  With this background, let’s create a small app with MVI
                 </p>
                 <h4 class="graf--h3">
                  Creating a Project with MVI architecture
                 </h4>
                 <p class="graf--p">
                  Let's start by setting up the Android project.
                 </p>
                 <p class="graf--p">
                  We are trying to achieve this in our Android project
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="MVI Architecture - Android Tutorial for Beginners - Step By Step Guide" class="graf-image" src="/images/mvi_1-9856d13ed93fdb60.png"/>
                 </div>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Create a Project
                  </b>
                 </p>
                 <ul>
                  <li>
                   Start a new Android project
                  </li>
                  <li>
                   Select Empty Activity and Next
                  </li>
                  <li>
                   Name: MVI-Architecture-Android-Beginners
                  </li>
                  <li>
                   Package name: com.mindorks.framework.mvi
                  </li>
                  <li>
                   Language: Kotlin
                  </li>
                  <li>
                   Finish
                  </li>
                  <li>
                   Your starting project is ready now
                  </li>
                 </ul>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Add dependencies
                  </b>
                 </p>
                 <pre><code class="language-java graf graf--code">// Added Dependencies
implementation "androidx.recyclerview:recyclerview:1.1.0"
implementation 'android.arch.lifecycle:extensions:1.1.1'
implementation 'androidx.lifecycle:lifecycle-viewmodel-ktx:2.2.0'
implementation 'androidx.lifecycle:lifecycle-runtime-ktx:2.2.0'
implementation 'com.github.bumptech.glide:glide:4.11.0'

//retrofit
implementation 'com.squareup.retrofit2:retrofit:2.8.1'
implementation "com.squareup.retrofit2:converter-moshi:2.6.2"

//Coroutine
implementation "org.jetbrains.kotlinx:kotlinx-coroutines-android:1.3.6"
implementation "org.jetbrains.kotlinx:kotlinx-coroutines-core:1.3.6"</code></pre>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Project Structure
                  </b>
                 </p>
                 <p class="graf--p">
                  For the project, We are going to follow a beginner version of MVI. Our package in the project will look like below.
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="MVI Architecture - Android Tutorial for Beginners - Step By Step Guide" class="graf-image" src="/images/mvi_folder_structure-1a1f6b88f42ee672.png"/>
                 </div>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Setup Data Layer
                  </b>
                 </p>
                 <p class="graf--p">
                  Now, in this section, we will set up the data layer.
                  <br/>
                  Under the data package, we will have api, model, and repository packages. We will create these packages and let’s concentrate on adding classes to each package one by one.
                 </p>
                 <p class="graf--p">
                  Let’s add classes supporting API.
                 </p>
                 <p class="graf--p">
                  We need a model to which the response will be transformed. Create User.kt data class as shown below.
                 </p>
                 <pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.data.model

import com.squareup.moshi.Json

data class User(
    @Json(name = "id")
    val id: Int = 0,
    @Json(name = "name")
    val name: String = "",
    @Json(name = "email")
    val email: String = "",
    @Json(name = "avatar")
    val avatar: String = ""
)</code></pre>
                 <p class="graf--p">
                  Create ApiHelper.kt interface
                 </p>
                 <pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.data.api

import com.mindorks.framework.mvi.data.model.User

interface ApiHelper {

    suspend fun getUsers(): List&lt;User&gt;

}</code></pre>
                 <blockquote class="graf--blockquote">
                  Note: We have used suspend keyword to support Coroutines so that we can call it from a Coroutine or another suspend function.
                 </blockquote>
                 <p class="graf--p">
                  Kotlin-Coroutines and Flow API are used in this project. You can learn from the following:
                 </p>
                 <ul>
                  <li>
                   <a class="markup--anchor" href="https://amitshekhar.me/blog/kotlin-coroutines" target="_blank">
                    Kotlin-Coroutines
                   </a>
                  </li>
                  <li>
                   <a class="markup--anchor" href="https://github.com/amitshekhariitbhu/Learn-Kotlin-Flow" target="_blank">
                    Kotlin Flow API
                   </a>
                  </li>
                 </ul>
                 <p class="graf--p">
                  Create a class ApiService.kt where we will specify HTTP methods to communicate to the API.
                 </p>
                 <pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.data.api

import com.mindorks.framework.mvi.data.model.User
import retrofit2.http.GET

interface ApiService {

   @GET("users")
   suspend fun getUsers(): List&lt;User&gt;
}</code></pre>
                 <p class="graf--p">
                  Now add retrofit builder which will build endpoint URL and consume REST services.
                 </p>
                 <pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.data.api

import retrofit2.Retrofit
import retrofit2.converter.moshi.MoshiConverterFactory

object RetrofitBuilder {

    private const val BASE_URL = "https://5e510330f2c0d300147c034c.mockapi.io/"

    private fun getRetrofit() = Retrofit.Builder()
        .baseUrl(BASE_URL)
        .addConverterFactory(MoshiConverterFactory.create())
        .build()


    val apiService: ApiService = getRetrofit().create(ApiService::class.java)

}</code></pre>
                 <p class="graf--p">
                  Now we need to implement this interface to fetch the List&lt;Users&gt;, create ApiHelperImpl.kt
                 </p>
                 <pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.data.api

import com.mindorks.framework.mvi.data.model.User

class ApiHelperImpl(private val apiService: ApiService) : ApiHelper {

    override suspend fun getUsers(): List&lt;User&gt; {
        return apiService.getUsers()
    }
}</code></pre>
                 <p class="graf--p">
                  Now we are ready to communicate with restful services in our data layer.
                 </p>
                 <p class="graf--p">
                  We will need a repository to requests data. In our case, we are calling the
                  <code class="graf--code-inline">
                   getUsers
                  </code>
                  method from activity through ViewModel to get the user list. Create
                  <i class="graf--italic">
                   <b class="graf--bold">
                    MainRepository.kt
                   </b>
                  </i>
                 </p>
                 <pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.data.repository

import com.mindorks.framework.mvi.data.api.ApiHelper


class MainRepository(private val apiHelper: ApiHelper) {

    suspend fun getUsers() = apiHelper.getUsers()

}</code></pre>
                 <p class="graf--p">
                  So our data layer is ready. Coming to UI part now, we need an adapter to recyclerview, Intent for storing user actions, our main activity under view, MainViewModel under viewModel, View state where we have defined different states for which we need to load data to views.
                 </p>
                 <p class="graf--p">
                  Create MainAdapter in adapter package
                 </p>
                 <pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.ui.main.adapter

import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.recyclerview.widget.RecyclerView
import com.bumptech.glide.Glide
import com.mindorks.framework.mvi.R
import com.mindorks.framework.mvi.data.model.User
import kotlinx.android.synthetic.main.item_layout.view.*

class MainAdapter(
    private val users: ArrayList&lt;User&gt;
) : RecyclerView.Adapter&lt;MainAdapter.DataViewHolder&gt;() {

    class DataViewHolder(itemView: View) : RecyclerView.ViewHolder(itemView) {
        fun bind(user: User) {
            itemView.textViewUserName.text = user.name
            itemView.textViewUserEmail.text = user.email
            Glide.with(itemView.imageViewAvatar.context)
                .load(user.avatar)
                .into(itemView.imageViewAvatar)
        }
    }

    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int) =
        DataViewHolder(
            LayoutInflater.from(parent.context).inflate(
                R.layout.item_layout, parent,
                false
            )
        )

    override fun getItemCount(): Int = users.size

    override fun onBindViewHolder(holder: DataViewHolder, position: Int) =
        holder.bind(users[position])

    fun addData(list: List&lt;User&gt;) {
        users.addAll(list)
    }

}</code></pre>
                 <p class="graf--p">
                  Create MainIntent.kt under the intent package
                 </p>
                 <pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.ui.main.intent

sealed class MainIntent {

    object FetchUser : MainIntent()

}</code></pre>
                 <p class="graf--p">
                  Now adding the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    MainState.kt
                   </i>
                  </b>
                  under viewstate package. This is the most important part of MVI. In this class, we are defining the states Idle, loading, users, error. Each state can be loaded on to the view by the user intents.
                 </p>
                 <pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.ui.main.viewstate

import com.mindorks.framework.mvi.data.model.User

sealed class MainState {

    object Idle : MainState()
    object Loading : MainState()
    data class Users(val user: List&lt;User&gt;) : MainState()
    data class Error(val error: String?) : MainState()

}</code></pre>
                 <p class="graf--p">
                  Create a ViewModel class - MainViewModel
                 </p>
                 <pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.ui.main.viewmodel

import androidx.lifecycle.ViewModel
import androidx.lifecycle.viewModelScope
import com.mindorks.framework.mvi.data.repository.MainRepository
import com.mindorks.framework.mvi.ui.main.intent.MainIntent
import com.mindorks.framework.mvi.ui.main.viewstate.MainState
import kotlinx.coroutines.ExperimentalCoroutinesApi
import kotlinx.coroutines.channels.Channel
import kotlinx.coroutines.flow.MutableStateFlow
import kotlinx.coroutines.flow.StateFlow
import kotlinx.coroutines.flow.collect
import kotlinx.coroutines.flow.consumeAsFlow
import kotlinx.coroutines.launch

@ExperimentalCoroutinesApi
class MainViewModel(
    private val repository: MainRepository
) : ViewModel() {

    val userIntent = Channel&lt;MainIntent&gt;(Channel.UNLIMITED)
    private val _state = MutableStateFlow&lt;MainState&gt;(MainState.Idle)
    val state: StateFlow&lt;MainState&gt;
        get() = _state

    init {
        handleIntent()
    }

    private fun handleIntent() {
        viewModelScope.launch {
            userIntent.consumeAsFlow().collect {
                when (it) {
                    is MainIntent.FetchUser -&gt; fetchUser()
                }
            }
        }
    }

    private fun fetchUser() {
        viewModelScope.launch {
            _state.value = MainState.Loading
            _state.value = try {
                MainState.Users(repository.getUsers())
            } catch (e: Exception) {
                MainState.Error(e.localizedMessage)
            }
        }
    }
}</code></pre>
                 <p class="graf--p">
                  Here in the ViewModel, we are observing on the
                  <code class="graf--code-inline">
                   userIntent
                  </code>
                  to perform the action on it.
                 </p>
                 <p class="graf--p">
                  And based on the response from the data layer, we change the state inside the
                  <code class="graf--code-inline">
                   fetchUser
                  </code>
                  method. And that state is being observed in the MainActivity.
                 </p>
                 <p class="graf--p">
                  Let us set up ViewModelFactory under the util package.
                 </p>
                 <p class="graf--p">
                  We are instantiating our viewModel in this class and we will return the instance of the ViewModel.
                 </p>
                 <pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.util

import androidx.lifecycle.ViewModel
import androidx.lifecycle.ViewModelProvider
import com.mindorks.framework.mvi.data.api.ApiHelper
import com.mindorks.framework.mvi.data.repository.MainRepository
import com.mindorks.framework.mvi.ui.main.viewmodel.MainViewModel

class ViewModelFactory(private val apiHelper: ApiHelper) : ViewModelProvider.Factory {

    override fun &lt;T : ViewModel?&gt; create(modelClass: Class&lt;T&gt;): T {
        if (modelClass.isAssignableFrom(MainViewModel::class.java)) {
            return MainViewModel(MainRepository(apiHelper)) as T
        }
        throw IllegalArgumentException("Unknown class name")
    }

}</code></pre>
                 <p class="graf--p">
                  Now, let's set up the XML layout.
                 </p>
                 <p class="graf--p">
                  In the layout folder, update the activity_main.xml with the following code:
                 </p>
                 <pre><code class="language-java graf graf--code">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".ui.main.view.MainActivity"&gt;

    &lt;androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recyclerView"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:visibility="gone" /&gt;

    &lt;ProgressBar
        android:id="@+id/progressBar"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        android:visibility="gone"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent" /&gt;

    &lt;Button
        android:id="@+id/buttonFetchUser"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/fetch_user"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent" /&gt;

&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</code></pre>
                 <p class="graf--p">
                  Add item_layout.xml in the layout folder and add the following code:
                 </p>
                 <pre><code class="language-java graf graf--code">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/container"
    android:layout_width="match_parent"
    android:layout_height="60dp"&gt;

    &lt;ImageView
        android:id="@+id/imageViewAvatar"
        android:layout_width="60dp"
        android:layout_height="0dp"
        android:padding="4dp"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent" /&gt;

    &lt;androidx.appcompat.widget.AppCompatTextView
        android:id="@+id/textViewUserName"
        style="@style/TextAppearance.AppCompat.Large"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_marginStart="8dp"
        android:layout_marginTop="4dp"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toEndOf="@+id/imageViewAvatar"
        app:layout_constraintTop_toTopOf="parent"
        tools:text="MindOrks" /&gt;

    &lt;androidx.appcompat.widget.AppCompatTextView
        android:id="@+id/textViewUserEmail"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="@+id/textViewUserName"
        app:layout_constraintTop_toBottomOf="@+id/textViewUserName"
        tools:text="MindOrks" /&gt;

&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</code></pre>
                 <p class="graf--p">
                  Add the following in strings.xml.
                 </p>
                 <pre><code class="language-java graf graf--code">&lt;string name="fetch_user"&gt;Fetch User&lt;/string&gt;</code></pre>
                 <p class="graf--p">
                  Coming to our MainAcitvity.kt class, We will be adding this under view package. This is the user-facing activity that takes input from the user, based on this MVI checks for the states mentioned in viewModel and loads the particular state in the view.
                 </p>
                 <p class="graf--p">
                  Let's see how MainActivity takes care of requesting data, handling states
                 </p>
                 <pre><code class="language-java graf graf--code">package com.mindorks.framework.mvi.ui.main.view

import android.os.Bundle
import android.view.View
import android.widget.Toast
import androidx.appcompat.app.AppCompatActivity
import androidx.lifecycle.ViewModelProviders
import androidx.lifecycle.lifecycleScope
import androidx.recyclerview.widget.DividerItemDecoration
import androidx.recyclerview.widget.LinearLayoutManager
import com.mindorks.framework.mvi.R
import com.mindorks.framework.mvi.data.api.ApiHelperImpl
import com.mindorks.framework.mvi.data.api.RetrofitBuilder
import com.mindorks.framework.mvi.data.model.User
import com.mindorks.framework.mvi.util.ViewModelFactory
import com.mindorks.framework.mvi.ui.main.adapter.MainAdapter
import com.mindorks.framework.mvi.ui.main.intent.MainIntent
import com.mindorks.framework.mvi.ui.main.viewmodel.MainViewModel
import com.mindorks.framework.mvi.ui.main.viewstate.MainState
import kotlinx.android.synthetic.main.activity_main.*
import kotlinx.coroutines.ExperimentalCoroutinesApi
import kotlinx.coroutines.flow.collect
import kotlinx.coroutines.launch

@ExperimentalCoroutinesApi
class MainActivity : AppCompatActivity() {

    private lateinit var mainViewModel: MainViewModel
    private var adapter = MainAdapter(arrayListOf())

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        setupUI()
        setupViewModel()
        observeViewModel()
        setupClicks()
    }

    private fun setupClicks() {
        buttonFetchUser.setOnClickListener {
            lifecycleScope.launch {
                mainViewModel.userIntent.send(MainIntent.FetchUser)
            }
        }
    }


    private fun setupUI() {
        recyclerView.layoutManager = LinearLayoutManager(this)
        recyclerView.run {
            addItemDecoration(
                DividerItemDecoration(
                    recyclerView.context,
                    (recyclerView.layoutManager as LinearLayoutManager).orientation
                )
            )
        }
        recyclerView.adapter = adapter
    }


    private fun setupViewModel() {
        mainViewModel = ViewModelProviders.of(
            this,
            ViewModelFactory(
                ApiHelperImpl(
                    RetrofitBuilder.apiService
                )
            )
        ).get(MainViewModel::class.java)
    }

    private fun observeViewModel() {
        lifecycleScope.launch {
            mainViewModel.state.collect {
                when (it) {
                    is MainState.Idle -&gt; {

                    }
                    is MainState.Loading -&gt; {
                        buttonFetchUser.visibility = View.GONE
                        progressBar.visibility = View.VISIBLE
                    }

                    is MainState.Users -&gt; {
                        progressBar.visibility = View.GONE
                        buttonFetchUser.visibility = View.GONE
                        renderList(it.user)
                    }
                    is MainState.Error -&gt; {
                        progressBar.visibility = View.GONE
                        buttonFetchUser.visibility = View.VISIBLE
                        Toast.makeText(this@MainActivity, it.error, Toast.LENGTH_LONG).show()
                    }
                }
            }
        }
    }

    private fun renderList(users: List&lt;User&gt;) {
        recyclerView.visibility = View.VISIBLE
        users.let { listOfUsers -&gt; listOfUsers.let { adapter.addData(it) } }
        adapter.notifyDataSetChanged()
    }
}</code></pre>
                 <p class="graf--p">
                  Here, we are sending the intent to fetch the data on button click(User Action).
                 </p>
                 <p class="graf--p">
                  Also, we are observing on the ViewModel State for the state changes. And, using "when" condition we are comparing the response intent state and loading the respective states.
                 </p>
                 <p class="graf--p">
                  Finally, add the Internet Permission in your project. Add the following in the AndroidManifest.xml:
                 </p>
                 <pre><code class="language-java graf graf--code">&lt;uses-permission android:name="android.permission.INTERNET"/&gt;</code></pre>
                 <p class="graf--p">
                  Now, build the project and run the app on the device. It should load the data into the UI.
                 </p>
                 <h4 class="graf--h3">
                  <b class="graf--bold">
                   Project Source Code and What Next?
                  </b>
                 </h4>
                 <p class="graf--p">
                  For the project source code, check
                  <b class="graf--bold">
                   <a class="markup--anchor" href="https://github.com/MindorksOpenSource/MVI-Architecture-Android-Beginners" target="_blank">
                    here
                   </a>
                  </b>
                  .
                 </p>
                 <p class="graf--p">
                  As we have done some simplifications in this project for the Beginners level, so, we can improve this project to go to the Advanced level, a few of the things which we can improve are as follows:
                 </p>
                 <ul>
                  <li>
                   Implement Dependency Inject Framework -
                   <span class="">
                    <a class="markup--anchor" href="https://blog.mindorks.com/a-complete-guide-to-learn-dagger-2-b4c7a570d99c" target="_blank">
                     Dagger
                    </a>
                   </span>
                   in the project.
                  </li>
                  <li>
                   Make ApiService Singleton and reuse the same instance for all the features.
                  </li>
                  <li>
                   Create base classes such as BaseActivity.
                  </li>
                  <li>
                   Handle all the API errors at a single place in a better way.
                  </li>
                  <li>
                   Create Interfaces for the classes wherever required.
                  </li>
                  <li>
                   Take advantage of
                   <span class="">
                    <a class="markup--anchor" href="https://blog.mindorks.com/android-ktx-android-development-with-kotlin" target="_blank">
                     Android KTX - Kotlin Extensions
                    </a>
                   </span>
                   .
                  </li>
                  <li>
                   Write Unit-Test
                  </li>
                  <li>
                   and so on.
                  </li>
                 </ul>
                 <p class="graf--p">
                  I hope you have learned the MVI architecture in Android.
                 </p>
                 <p class="graf--p">
                  <i class="graf--italic">
                   Keep Learning, Keep Exploring, Keep Growing
                  </i>
                 </p>
                 <p class="graf--p">
                  <i class="graf--italic">
                   Thank you
                  </i>
                 </p>
                </div>
               </div>
              </div>
             </section>
            </div>
           </div>
          </div>
         </article>
        </div>
       </div>
       <div class="ui divider">
       </div>
      </div>
      <div class="stretched fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui large center aligned header" style="padding-top:20px">
        Recommended for You
       </div>
      </div>
      <div class="fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui centered grid">
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/java-tutorial-for-beginners-learn-java-from-basics/">
          <img alt="Java Tutorial For Beginners - Learn Java From Basics" class="ui centered image" src="/images/java-basics.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Java Tutorial For Beginners - Learn Java From Basics
           </div>
           <div class="meta">
            8th October 2019
           </div>
           <div class="description">
            In this blog, we will learn how to get started with Java from basics.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/using-webviews-in-flutter-tutorial/">
          <img alt="Using WebViews in Flutter: Tutorial" class="ui centered image" src="/images/using-webviews-in-flutter-tutorial-banner.jpg" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Using WebViews in Flutter: Tutorial
           </div>
           <div class="meta">
            20th April 2020
           </div>
           <div class="description">
            In this blog, we will learn how to use WebViews in Flutter. WebViews are very important to open some web pages inside your application.
           </div>
          </div>
         </a>
        </div>
       </div>
      </div>
     </div>
    </div>
    <div style="background:#fff">
     <footer class="content-container">
      <div class="ui centered padded grid" style="padding-top:40px;background:linear-gradient(to right,#c4e0e0,#e5f1f1)">
       <h2 class="ui huge icon center aligned header">
        <div class="content">
         Connect With Your Mentors
        </div>
       </h2>
       <div class="centered row">
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Janishar Ali" class="ui medium circular image" src="/assets/ali.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://janisharali.com" target="_blank">
             Janishar Ali
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://janisharali.com" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/janisharali" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Amit Shekhar" class="ui medium circular image" src="/assets/amit.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://amitshekhar.me" target="_blank">
             Amit Shekhar
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://amitshekhar.me" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/amitiitbhu" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div class="ui divider" style="margin:unset">
      </div>
      <h5 class="ui header" style="padding:16px;margin:unset;color:#555">
       <i aria-hidden="true" class="copyright icon">
       </i>
       <div class="content">
        Copyright 2022, MindOrks Nextgen Private Limited
       </div>
      </h5>
     </footer>
    </div>
   </div>
  </div>
  <script type="text/javascript">
   window.hljs.initHighlightingOnLoad()
  </script>
 </body>
</html>