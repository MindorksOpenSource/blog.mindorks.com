<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title>
   Understanding ImageDecoder API in Android
  </title>
  <meta charset="utf-8"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="minimum-scale=1,initial-scale=1,width=device-width,shrink-to-fit=no" name="viewport"/>
  <link href="https://blog.mindorks.com/imagedecoder-in-android" rel="canonical"/>
  <meta content="986249072156-dabps0lf90smluddrk5rkqsdjghk3hd3.apps.googleusercontent.com" name="google-signin-client_id"/>
  <meta content="android, learn android app development, android app development courses, android blogs, android tutorial" name="keywords"/>
  <meta content="Understanding ImageDecoder API in Android" property="og:title"/>
  <meta content="website" property="og:type"/>
  <meta content="https://blog.mindorks.com/imagedecoder-in-android" property="og:url"/>
  <meta content="/images/image-decoder-banner-e9cba586f624d6a6.png" property="og:image"/>
  <meta content="In this blog, we are going to see how we can use ImageDecoder API in Android with its use-case. We will also see how to handle errors and transformations." property="og:description"/>
  <meta content="Understanding ImageDecoder API in Android" property="twitter:title"/>
  <meta content="In this blog, we are going to see how we can use ImageDecoder API in Android with its use-case. We will also see how to handle errors and transformations." name="twitter:description"/>
  <meta content="/images/image-decoder-banner-e9cba586f624d6a6.png" name="twitter:image:src"/>
  <meta content="summary_large_image" name="twitter:card"/>
  <meta content="@MindorksNextGen" name="twitter:site"/>
  <meta content="In this blog, we are going to see how we can use ImageDecoder API in Android with its use-case. We will also see how to handle errors and transformations." name="description"/>
  <meta content="1620001391374687" property="fb:app_id"/>
  <link href="/styles/vendor-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link href="/styles/app-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link as="style" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" onload='this.onload=null,this.rel="stylesheet"' rel="preload"/>
  <noscript>
   <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
  </noscript>
  <script type="text/javascript">
   window.__PRELOADED_STATE__={toastr:{toastrs:[],confirm:null},blogData:{data:{},latestBlogs:null,isFetching:!0,isFetchingLatestBlogs:!1,currentCategory:"",categories:[]},contactData:{formData:{email:"",name:"",phone:"",message:"",isWriting:!1,isNameError:!1,isEmailError:!1,isPhoneError:!1,isMessageError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSending:!1},communityData:{formData:{email:"",isEmailError:!1,isWriting:!1,isSending:!1,dismissMsg:!1},successMessage:null,errorMessage:null},blogPageData:{blogId:489,data:{id:489,title:"Understanding ImageDecoder API in Android",description:"In this blog, we are going to see how we can use ImageDecoder API in Android with its use-case. We will also see how to handle errors and transformations.",text:'<h1 class="graf--h1">Understanding ImageDecoder API in Android</h1> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/image-decoder-banner-e9cba586f624d6a6.png class=\'graf-image\' alt=\'Understanding ImageDecoder API in Android\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">In Android, we work with a lot of Bitmaps and drawables. Handling bitmap conversions requires us to write a lot of code and quite a few times we get our favorite error, &quot;<b class="graf--bold">Out of Memory</b>&quot; exception.</p><p class="graf--p">Manipulating Bitmap happens using the <code class="graf--code-inline">BitmapFactory</code>, but with Android P, we got something called <b class="graf--bold">ImageDecoder</b> which helps us convert images like PNG, JPEG, etc to Drawables or Bitmaps.</p><p class="graf--p">Welcome to MindOrks, in this blog, we are going to learn about how to use ImageDecoder to efficiently convert images.</p><p class="graf--p">While understanding ImageDecoder We are going to cover,</p><ul><li>Understanding the source and loading Images</li><li>Decoding from Drawable folder and URI</li><li>Overriding the default setting of the source</li><li>Decoding GIFs and WebP</li><li>Handling Errors</li></ul><h4 class="graf--h3"><b class="graf--bold">Understanding the source and loading Images</b></h4><p class="graf--p">To decode anything, we first need to map the image source. The source is like the accepted path required by the ImageDecoder. To create a source we use,</p><pre><code class="language-java graf graf--code">val source = ImageDecoder.createSource(file_path)</code></pre><p class="graf--p">and to use it as a drawable we just use it as,</p><pre><code class="language-java graf graf--code">val drawable: Drawable = ImageDecoder.decodeDrawable(source)</code></pre><p class="graf--p">Here, generating a source can happen at any thread. But the decoding is recommended to do in the <b class="graf--bold">background thread</b>.</p><p class="graf--p">Now, to set the image in an ImageView we use,</p><pre><code class="language-java graf graf--code">imageView.setImageDrawable(drawable)</code></pre><p class="graf--p">Here, we are getting drawable using the decodeDrawable method but if we want to get a bitmap from the defined source we will use,</p><pre><code class="language-java graf graf--code">val bitmap:Bitmap = ImageDecoder.decodeBitmap(source)</code></pre><p class="graf--p">And to set the bitmap in ImageView we use,</p><pre><code class="language-java graf graf--code">imageView.setImageBitmap(bitmap)</code></pre><p class="graf--p">This above use-case was to create a source from the file path and decode it to Drawable of Bitmap. </p><p class="graf--p">Similarly, we can create a source from ByteBuffer like,</p><pre><code class="language-java graf graf--code">val source = ImageDecoder.createSource(byte_buffer)</code></pre><h4 class="graf--h3">Decoding from Drawable folder and URI</h4><p class="graf--p">Now, consider a use case where we have PNGs or JPEGs in the drawable folder of our project. Then we can also create the source from the resource folder like,</p><pre><code class="language-java graf graf--code">val source = ImageDecoder.createSource(resources, R.drawable.ic_location)</code></pre><p class="graf--p">Here, we are pulling up the PNG icon, <b class="graf--bold">ic_location</b> from the drawable, and creating a source for it using <b class="graf--bold">ImageDecoder</b>.</p><p class="graf--p">And now we can decode the source to drawable or bitmap using,</p><pre><code class="language-java graf graf--code">val drawable: Drawable = ImageDecoder.decodeDrawable(source)</code></pre><p class="graf--p">and,</p><pre><code class="language-java graf graf--code">val bitmap:Bitmap = ImageDecoder.decodeBitmap(source)</code></pre><p class="graf--p">And these can be set to ImageView using <b class="graf--bold">setImageDrawable</b> and <b class="graf--bold">setImageBitmap</b>.</p><p class="graf--p">Similarly, if we have a URI and want to create a source from it, we use content resolver to create source like,</p><pre><code class="language-java graf graf--code">val source = ImageDecoder.createSource(contentResolver, image_uri)</code></pre><p class="graf--p">and finally, if we have to create a source from file from the asset, then we use,</p><pre><code class="language-java graf graf--code">val source = ImageDecoder.createSource(assetManager, file_from_asset)</code></pre><p class="graf--p">and like the above steps we can decode the source to bitmap and drawable.</p><h4 class="graf--h3">Overriding the default settings of the source</h4><p class="graf--p">While creating a source, we can also override the default settings we get from the Image. To override the default setting we use,</p><pre><code class="language-java graf graf--code">OnHeaderDecodedListener</code></pre><p class="graf--p">To add the onHeaderDecodedListener we use,</p><pre><code class="language-java graf graf--code">val listener: OnHeaderDecodedListener = object : OnHeaderDecodedListener {\n\n    override fun onHeaderDecoded(decoder: ImageDecoder, info: ImageInfo, source: ImageDecoder.Source) {\n     // do something here\n    }\n}\nval drawable = ImageDecoder.decodeDrawable(source, listener)</code></pre><p class="graf--p">We can do a lot of transformation using the listeners. </p><p class="graf--p"><b class="graf--bold">decoder</b> here let us do the transformations, <b class="graf--bold">info</b> contains all the details of the original image like Mime type, size, or if it is animating or not and the <b class="graf--bold">source</b>.</p><p class="graf--p">Consider, if we want to resize the image, then inside the onHeaderDecoded, we will write,</p><pre><code class="language-java graf graf--code">decoder.setTargetSize(100,100)</code></pre><p class="graf--p">It will transform the original image to a size of 100 in a square shape.</p><h4 class="graf--h3">Decoding GIFs and WebP</h4><p class="graf--p">If we have GIFs and WebP, then we can load them using ImageDecoder itself with all the animations and transitions of the frames without using any third-party library.</p><p class="graf--p">Let&#x27;s say we have a source from the assets folder which is a Gif file. So, to decode it in Drawable and start the animation we use,</p><pre><code class="language-java graf graf--code">val source = ImageDecoder.createSource(assetManager, file_from_asset)</code></pre><p class="graf--p">Then,</p><pre><code class="language-java graf graf--code">val drawable = ImageDecoder.decodeDrawable(source)\nif (drawable is AnimatedImageDrawable) {\n    drawable.start()\n}</code></pre><p class="graf--p">Here, while decoding it as drawable it is decoded as <b class="graf--bold">AnimatedImageDrawable</b>.</p><p class="graf--p">And to start the animation we call <b class="graf--bold">start()</b>.</p><h4 class="graf--h3">Handling Errors</h4><p class="graf--p">While decoding the source, we might get errors. To detect the errors we need to set the <b class="graf--bold">setOnPartialImageListener</b> to the decoder parameter in OnHeaderDecodedListener like,</p><pre><code class="language-java graf graf--code">val listener: OnHeaderDecodedListener = object : OnHeaderDecodedListener {\n\n    override fun onHeaderDecoded(decoder: ImageDecoder, info: ImageInfo, source: ImageDecoder.Source) {\n        decoder.setOnPartialImageListener {exception-&gt;\n            Log.d("ImageDecoder",exception.error.toString()))\n            true\n        }\n    }\n}</code></pre><p class="graf--p">Here, inside setOnPartialImageListener we get the exception and that is where we can log the error.</p><p class="graf--p">When we want to log the error, <b class="graf--bold">exception.error</b> might return the possible errors as following,</p><ul><li><a class="markup--anchor" target="_blank" href="https://developer.android.com/reference/android/graphics/ImageDecoder.DecodeException.html#SOURCE_EXCEPTION">SOURCE_EXCEPTION</a> — an exception in the source</li><li><a class="markup--anchor" target="_blank" href="https://developer.android.com/reference/android/graphics/ImageDecoder.DecodeException.html#SOURCE_INCOMPLETE">SOURCE_INCOMPLETE</a> —the input data was incomplete</li><li><a class="markup--anchor" target="_blank" href="https://developer.android.com/reference/android/graphics/ImageDecoder.DecodeException.html#SOURCE_MALFORMED_DATA">SOURCE_MALFORMED_DATA</a> — the encoded data contained an error and was malformed.</li></ul><blockquote class="graf--blockquote">Here, we are returning true, which tells the listeners to only display the generated image until the exception occurred. But if it returns false, it will stop executing and will return an exception.</blockquote><h4 class="graf--h3">Good to know</h4><p class="graf--p">If you want to do processing after loading the Image like setting some custom background etc,  we can do it in,</p><pre><code class="language-java graf graf--code">OnHeaderDecodedListener</code></pre><p class="graf--p">To do processing we use it like,</p><pre><code class="language-java graf graf--code">val listener: OnHeaderDecodedListener = object : OnHeaderDecodedListener {\n\n    override fun onHeaderDecoded(decoder: ImageDecoder, info: ImageInfo, source: ImageDecoder.Source) {\n        decoder.setPostProcessor { canvas -&gt;\n            \n        }\n    }\n}</code></pre><p class="graf--p">Here, inside <b class="graf--bold">setOnProcessor</b> we get the <b class="graf--bold">canvas</b> on which we will do our transformations and will apply custom effects that will be applied to the canvas after the Image is decoded and loaded.</p><p class="graf--p">This is how you can use ImageDecoder in your application. It requires Android Pie and above to run in your project.</p><p class="graf--p">Happy learning.</p><p class="graf--p"><b class="graf--bold">Team MindOrks :)</b></p>',author:9959,img_url:"/images/image-decoder-banner-e9cba586f624d6a6.png",blog_url:"imagedecoder-in-android",likes:0,rank:0,category:1,published_at:"24th June 2020"},author:{id:9959,name:"Himanshu Singh",google_profile_pic:"https://lh3.googleusercontent.com/a-/AOh14Ghy8H-FJrgWB2TcxHCOKWxWEQB4AiklYADGTydu4nE=s96-c?sz=300",fb_profile_pic:null,profile_tagline:null,fb_profile_url:"https://www.facebook.com/scorpiey",google_plus_profile_url:null,twitter_profile_url:"https://twitter.com/hi_man_shoe",github_profile_url:"https://github.com/hi-manshu",linkedin_profile_url:"https://www.linkedin.com/in/himanshoe-singh/"},isFetching:!1,similarBlogs:[{id:392,title:"Understanding Canvas API in Android",description:"In this blog, we will see how we can use canvas to draw our own custom shape and drawings .",author:9959,img_url:"/images/canvas-api-banner.png",blog_url:"understanding-canvas-api-in-android",likes:0,rank:0,category:1,published_at:"17th February 2020",score:2.306637763977051},{id:304,title:"Color Palette API in Android",description:"In this blog, we will learn about the Color Palette API in Android. Here we will see how can we generate dynamic colors based on an image.",author:9959,img_url:"/images/color-pallete-api.png",blog_url:"color-palette-in-android",likes:0,rank:0,category:1,published_at:"24th July 2019",score:1.7772136926651},{id:312,title:"Easy SMS Verification in Android: SMS User Consent API",description:"In this blog, we will learn how to implement SMS verification using the SMS User Consent API in Android. This API is used to read only the message containing the verification code and will automatically extract the code from the message by taking permission from the user with the help of a prompt. ",author:14897,img_url:"/images/easy-sms-verification-android-sms-user-consent-api-banner.png",blog_url:"easy-sms-verification-in-android-sms-user-consent-api",likes:0,rank:0,category:1,published_at:"9th August 2019",score:1.7772136926651},{id:352,title:"Securing API Keys using Android NDK (Native Development Kit)",description:"In this blog, we will learn how to secure our API Keys that are used in Android applications using the Android NDK (Native Development Kit). We have created a detailed blog of securing the API Keys.",author:17146,img_url:"/images/securing-api-keys-using-android-ndk-banner.png",blog_url:"securing-api-keys-using-android-ndk",likes:0,rank:0,category:1,published_at:"2nd October 2019",score:1.7772136926651},{id:466,title:"Auto Backup API in Android",description:"Android provides a very handy API to deal with user's local data backups. We'll learn how to enable, customize, use and test Android's Auto Backup API.",author:18510,img_url:"/images/android-auto-backup-banner-70b0b8fb204b0731.png",blog_url:"android-auto-backup-api",likes:0,rank:0,category:1,published_at:"3rd June 2020",score:1.7772136926651},{id:269,title:"Using Fused Location API To Fetch Current Location",description:"In this blog, we will learn how to update the location using the GPS of a mobile device. We will perform an example to check the current location of the user.",author:14897,img_url:"/images/using-gps-location-manager-in-android-android-tutorial-banner.jpg",blog_url:"using-gps-location-manager-in-android-android-tutorial",likes:0,rank:0,category:1,published_at:"7th June 2019",score:1.768036127090454}],isSimilarBlogsFetching:!1},loginData:{data:null,isLoggingIn:!1,isLoggingOut:!1,loginState:!1,isForcedLogout:!1,isTokenRefreshed:!1,isRedirectHome:!1,message:""},updatesData:{news:null,inspirations:null,isNewsFetching:!0,isInspirationsFetching:!0},blogEditorData:{blogId:null,blogDetailsFormData:{title:"",description:"",imgUrl:"",blogUrl:"",category:"",categories:[],isWriting:!1,isTitleError:!1,isDescriptionError:!1,isImgUrlError:!1,isBlogUrlError:!1,isCategoryError:!1,isUploadingImage:!1,uploadedImageUrl:null},editorState:null,editorText:null,successMessage:null,errorMessage:null,isSending:!1,isMsgToShow:!1,isPublished:!1,isSubmitted:!1,isDraft:!0,isEditOfExistingBlog:!1,isFetchingBlogCategories:!1,isUploadingImage:!1,uploadedImageUrl:null},myBlogsData:{data:null,isSubmittedBlogsFetching:!0,isDraftBlogsFetching:!0,isPublishedBlogsFetching:!0,successMessage:null,errorMessage:null,isMsgToShow:!1,tabNames:["drafts","submissions","published"],selectedTab:"drafts",isFetchingBlog:!1,isDeletingBlog:!1,openEditorPage:!1},profilePreviewData:{profile:null,blogs:null,isFetchingProfile:!1,isFetchingAuthorBlogs:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,isUserNotRegistered:!1,redirectToMyProfileEdit:!1},profileEditableData:{userId:null,name:null,fbProfilePicUrl:null,googleProfilePicUrl:null,profileFormData:{tagline:"",fbProfileUrl:"",googlePlusProfileUrl:"",twitterProfileUrl:"",githubProfileUrl:"",linkedinProfileUrl:"",isWriting:!1,isTaglineError:!1,isFbProfileUrlError:!1,isGooglePlusProfileUrlError:!1,isTwitterProfileUrlError:!1,isGithubProfileUrlError:!1,isLinkedinProfileUrlError:!1},isSavingProfile:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,redirectToProfilePreview:!1},submitBlogData:{formData:{email:"",name:"",link:"",isWriting:!1,isNameError:!1,isEmailError:!1,isLinkError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSubmitting:!1},advertisementsData:{data:{},isLoading:!1},recaptchaData:{verified:!1,successMessage:null,errorMessage:null},blogSearchData:{searches:null,isSearching:!1}}
  </script>
  <script async="" src="https://www.google-analytics.com/analytics.js" type="text/javascript">
  </script>
  <script type="text/javascript">
   window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-91686131-1","auto"),ga("require","cleanUrlTracker"),ga("require","eventTracker"),ga("require","impressionTracker"),ga("require","outboundLinkTracker"),ga("require","urlChangeTracker"),ga("require","maxScrollTracker"),ga("require","mediaQueryTracker"),ga("require","outboundFormTracker"),ga("require","outboundLinkTracker"),ga("require","pageVisibilityTracker"),ga("require","socialWidgetTracker"),ga("require","urlChangeTracker"),ga("send","pageview")
  </script>
  <script defer="defer" src="/assets/autotrack.js" type="text/javascript">
  </script>
  <script src="/assets/highlight.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/vendor-bundle-1.8.6.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/app-bundle-1.8.6.js" type="text/javascript">
  </script>
 </head>
 <body>
  <div id="root">
   <div class="screen app-load-content" data-reactroot="">
    <div class="ui centered grid">
     <div class="row" style="padding:0">
      <div class="ui fixed menu navbar huge borderless grid" style="background-color:#fff;height:60px">
      </div>
     </div>
     <div class="centered computer only row" style="padding:0">
      <div class="ui fixed top menu navbar huge borderless grid header-container" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="right menu">
        <a class="item" href="https://janisharali.com" target="_blank">
         Mentor Ali
        </a>
        <a class="item" href="https://amitshekhar.me" target="_blank">
         Mentor Amit
        </a>
       </div>
      </div>
     </div>
     <div class="tablet only mobile only row" style="padding:0">
      <div class="ui fixed top navbar huge menu borderless" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="item">
       </div>
      </div>
     </div>
    </div>
    <div class="header-height">
    </div>
    <div aria-live="assertive" class="redux-toastr">
     <div>
      <div class="top-left">
      </div>
      <div class="top-right">
      </div>
      <div class="top-center">
      </div>
      <div class="bottom-left">
      </div>
      <div class="bottom-right">
      </div>
      <div class="bottom-center">
      </div>
     </div>
    </div>
    <div class="content-container theme">
     <div class="ui centered one column grid" style="padding-bottom:80px;background-color:#fff">
      <div class="ten wide computer fifteen wide mobile fifteen wide tablet column" style="margin-top:50px">
       <div>
        <div class="blog-page-author">
         <div class="ui small header">
          <img alt="Himanshu Singh" class="ui circular image" src="https://lh3.googleusercontent.com/a-/AOh14Ghy8H-FJrgWB2TcxHCOKWxWEQB4AiklYADGTydu4nE=s96-c?sz=300"/>
          <div class="content">
           Himanshu Singh
           <div class="sub header" style="margin-top:5px">
            24th June 2020
           </div>
          </div>
         </div>
        </div>
        <div id="content">
         <article class="template">
          <div class="postContent">
           <div class="notesSource">
            <div class="postField postField--body" id="editor">
             <section class="section--first section--last">
              <div class="section-divider layoutSingleColumn-template">
               <hr class="section-divider"/>
              </div>
              <div class="section-content">
               <div class="section-inner layoutSingleColumn-template">
                <div>
                 <h1 class="graf--h1">
                  Understanding ImageDecoder API in Android
                 </h1>
                 <div class="graf-image graf-caption">
                  <img alt="Understanding ImageDecoder API in Android" class="graf-image" src="/images/image-decoder-banner-e9cba586f624d6a6.png"/>
                 </div>
                 <p class="graf--p">
                  In Android, we work with a lot of Bitmaps and drawables. Handling bitmap conversions requires us to write a lot of code and quite a few times we get our favorite error, "
                  <b class="graf--bold">
                   Out of Memory
                  </b>
                  " exception.
                 </p>
                 <p class="graf--p">
                  Manipulating Bitmap happens using the
                  <code class="graf--code-inline">
                   BitmapFactory
                  </code>
                  , but with Android P, we got something called
                  <b class="graf--bold">
                   ImageDecoder
                  </b>
                  which helps us convert images like PNG, JPEG, etc to Drawables or Bitmaps.
                 </p>
                 <p class="graf--p">
                  Welcome to MindOrks, in this blog, we are going to learn about how to use ImageDecoder to efficiently convert images.
                 </p>
                 <p class="graf--p">
                  While understanding ImageDecoder We are going to cover,
                 </p>
                 <ul>
                  <li>
                   Understanding the source and loading Images
                  </li>
                  <li>
                   Decoding from Drawable folder and URI
                  </li>
                  <li>
                   Overriding the default setting of the source
                  </li>
                  <li>
                   Decoding GIFs and WebP
                  </li>
                  <li>
                   Handling Errors
                  </li>
                 </ul>
                 <h4 class="graf--h3">
                  <b class="graf--bold">
                   Understanding the source and loading Images
                  </b>
                 </h4>
                 <p class="graf--p">
                  To decode anything, we first need to map the image source. The source is like the accepted path required by the ImageDecoder. To create a source we use,
                 </p>
                 <pre><code class="language-java graf graf--code">val source = ImageDecoder.createSource(file_path)</code></pre>
                 <p class="graf--p">
                  and to use it as a drawable we just use it as,
                 </p>
                 <pre><code class="language-java graf graf--code">val drawable: Drawable = ImageDecoder.decodeDrawable(source)</code></pre>
                 <p class="graf--p">
                  Here, generating a source can happen at any thread. But the decoding is recommended to do in the
                  <b class="graf--bold">
                   background thread
                  </b>
                  .
                 </p>
                 <p class="graf--p">
                  Now, to set the image in an ImageView we use,
                 </p>
                 <pre><code class="language-java graf graf--code">imageView.setImageDrawable(drawable)</code></pre>
                 <p class="graf--p">
                  Here, we are getting drawable using the decodeDrawable method but if we want to get a bitmap from the defined source we will use,
                 </p>
                 <pre><code class="language-java graf graf--code">val bitmap:Bitmap = ImageDecoder.decodeBitmap(source)</code></pre>
                 <p class="graf--p">
                  And to set the bitmap in ImageView we use,
                 </p>
                 <pre><code class="language-java graf graf--code">imageView.setImageBitmap(bitmap)</code></pre>
                 <p class="graf--p">
                  This above use-case was to create a source from the file path and decode it to Drawable of Bitmap.
                 </p>
                 <p class="graf--p">
                  Similarly, we can create a source from ByteBuffer like,
                 </p>
                 <pre><code class="language-java graf graf--code">val source = ImageDecoder.createSource(byte_buffer)</code></pre>
                 <h4 class="graf--h3">
                  Decoding from Drawable folder and URI
                 </h4>
                 <p class="graf--p">
                  Now, consider a use case where we have PNGs or JPEGs in the drawable folder of our project. Then we can also create the source from the resource folder like,
                 </p>
                 <pre><code class="language-java graf graf--code">val source = ImageDecoder.createSource(resources, R.drawable.ic_location)</code></pre>
                 <p class="graf--p">
                  Here, we are pulling up the PNG icon,
                  <b class="graf--bold">
                   ic_location
                  </b>
                  from the drawable, and creating a source for it using
                  <b class="graf--bold">
                   ImageDecoder
                  </b>
                  .
                 </p>
                 <p class="graf--p">
                  And now we can decode the source to drawable or bitmap using,
                 </p>
                 <pre><code class="language-java graf graf--code">val drawable: Drawable = ImageDecoder.decodeDrawable(source)</code></pre>
                 <p class="graf--p">
                  and,
                 </p>
                 <pre><code class="language-java graf graf--code">val bitmap:Bitmap = ImageDecoder.decodeBitmap(source)</code></pre>
                 <p class="graf--p">
                  And these can be set to ImageView using
                  <b class="graf--bold">
                   setImageDrawable
                  </b>
                  and
                  <b class="graf--bold">
                   setImageBitmap
                  </b>
                  .
                 </p>
                 <p class="graf--p">
                  Similarly, if we have a URI and want to create a source from it, we use content resolver to create source like,
                 </p>
                 <pre><code class="language-java graf graf--code">val source = ImageDecoder.createSource(contentResolver, image_uri)</code></pre>
                 <p class="graf--p">
                  and finally, if we have to create a source from file from the asset, then we use,
                 </p>
                 <pre><code class="language-java graf graf--code">val source = ImageDecoder.createSource(assetManager, file_from_asset)</code></pre>
                 <p class="graf--p">
                  and like the above steps we can decode the source to bitmap and drawable.
                 </p>
                 <h4 class="graf--h3">
                  Overriding the default settings of the source
                 </h4>
                 <p class="graf--p">
                  While creating a source, we can also override the default settings we get from the Image. To override the default setting we use,
                 </p>
                 <pre><code class="language-java graf graf--code">OnHeaderDecodedListener</code></pre>
                 <p class="graf--p">
                  To add the onHeaderDecodedListener we use,
                 </p>
                 <pre><code class="language-java graf graf--code">val listener: OnHeaderDecodedListener = object : OnHeaderDecodedListener {

    override fun onHeaderDecoded(decoder: ImageDecoder, info: ImageInfo, source: ImageDecoder.Source) {
     // do something here
    }
}
val drawable = ImageDecoder.decodeDrawable(source, listener)</code></pre>
                 <p class="graf--p">
                  We can do a lot of transformation using the listeners.
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   decoder
                  </b>
                  here let us do the transformations,
                  <b class="graf--bold">
                   info
                  </b>
                  contains all the details of the original image like Mime type, size, or if it is animating or not and the
                  <b class="graf--bold">
                   source
                  </b>
                  .
                 </p>
                 <p class="graf--p">
                  Consider, if we want to resize the image, then inside the onHeaderDecoded, we will write,
                 </p>
                 <pre><code class="language-java graf graf--code">decoder.setTargetSize(100,100)</code></pre>
                 <p class="graf--p">
                  It will transform the original image to a size of 100 in a square shape.
                 </p>
                 <h4 class="graf--h3">
                  Decoding GIFs and WebP
                 </h4>
                 <p class="graf--p">
                  If we have GIFs and WebP, then we can load them using ImageDecoder itself with all the animations and transitions of the frames without using any third-party library.
                 </p>
                 <p class="graf--p">
                  Let's say we have a source from the assets folder which is a Gif file. So, to decode it in Drawable and start the animation we use,
                 </p>
                 <pre><code class="language-java graf graf--code">val source = ImageDecoder.createSource(assetManager, file_from_asset)</code></pre>
                 <p class="graf--p">
                  Then,
                 </p>
                 <pre><code class="language-java graf graf--code">val drawable = ImageDecoder.decodeDrawable(source)
if (drawable is AnimatedImageDrawable) {
    drawable.start()
}</code></pre>
                 <p class="graf--p">
                  Here, while decoding it as drawable it is decoded as
                  <b class="graf--bold">
                   AnimatedImageDrawable
                  </b>
                  .
                 </p>
                 <p class="graf--p">
                  And to start the animation we call
                  <b class="graf--bold">
                   start()
                  </b>
                  .
                 </p>
                 <h4 class="graf--h3">
                  Handling Errors
                 </h4>
                 <p class="graf--p">
                  While decoding the source, we might get errors. To detect the errors we need to set the
                  <b class="graf--bold">
                   setOnPartialImageListener
                  </b>
                  to the decoder parameter in OnHeaderDecodedListener like,
                 </p>
                 <pre><code class="language-java graf graf--code">val listener: OnHeaderDecodedListener = object : OnHeaderDecodedListener {

    override fun onHeaderDecoded(decoder: ImageDecoder, info: ImageInfo, source: ImageDecoder.Source) {
        decoder.setOnPartialImageListener {exception-&gt;
            Log.d("ImageDecoder",exception.error.toString()))
            true
        }
    }
}</code></pre>
                 <p class="graf--p">
                  Here, inside setOnPartialImageListener we get the exception and that is where we can log the error.
                 </p>
                 <p class="graf--p">
                  When we want to log the error,
                  <b class="graf--bold">
                   exception.error
                  </b>
                  might return the possible errors as following,
                 </p>
                 <ul>
                  <li>
                   <a class="markup--anchor" href="https://developer.android.com/reference/android/graphics/ImageDecoder.DecodeException.html#SOURCE_EXCEPTION" target="_blank">
                    SOURCE_EXCEPTION
                   </a>
                   — an exception in the source
                  </li>
                  <li>
                   <a class="markup--anchor" href="https://developer.android.com/reference/android/graphics/ImageDecoder.DecodeException.html#SOURCE_INCOMPLETE" target="_blank">
                    SOURCE_INCOMPLETE
                   </a>
                   —the input data was incomplete
                  </li>
                  <li>
                   <a class="markup--anchor" href="https://developer.android.com/reference/android/graphics/ImageDecoder.DecodeException.html#SOURCE_MALFORMED_DATA" target="_blank">
                    SOURCE_MALFORMED_DATA
                   </a>
                   — the encoded data contained an error and was malformed.
                  </li>
                 </ul>
                 <blockquote class="graf--blockquote">
                  Here, we are returning true, which tells the listeners to only display the generated image until the exception occurred. But if it returns false, it will stop executing and will return an exception.
                 </blockquote>
                 <h4 class="graf--h3">
                  Good to know
                 </h4>
                 <p class="graf--p">
                  If you want to do processing after loading the Image like setting some custom background etc,  we can do it in,
                 </p>
                 <pre><code class="language-java graf graf--code">OnHeaderDecodedListener</code></pre>
                 <p class="graf--p">
                  To do processing we use it like,
                 </p>
                 <pre><code class="language-java graf graf--code">val listener: OnHeaderDecodedListener = object : OnHeaderDecodedListener {

    override fun onHeaderDecoded(decoder: ImageDecoder, info: ImageInfo, source: ImageDecoder.Source) {
        decoder.setPostProcessor { canvas -&gt;
            
        }
    }
}</code></pre>
                 <p class="graf--p">
                  Here, inside
                  <b class="graf--bold">
                   setOnProcessor
                  </b>
                  we get the
                  <b class="graf--bold">
                   canvas
                  </b>
                  on which we will do our transformations and will apply custom effects that will be applied to the canvas after the Image is decoded and loaded.
                 </p>
                 <p class="graf--p">
                  This is how you can use ImageDecoder in your application. It requires Android Pie and above to run in your project.
                 </p>
                 <p class="graf--p">
                  Happy learning.
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Team MindOrks :)
                  </b>
                 </p>
                </div>
               </div>
              </div>
             </section>
            </div>
           </div>
          </div>
         </article>
        </div>
       </div>
       <div class="ui divider">
       </div>
      </div>
      <div class="stretched fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui large center aligned header" style="padding-top:20px">
        Recommended for You
       </div>
      </div>
      <div class="fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui centered grid">
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/understanding-canvas-api-in-android/">
          <img alt="Understanding Canvas API in Android" class="ui centered image" src="/images/canvas-api-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Understanding Canvas API in Android
           </div>
           <div class="meta">
            17th February 2020
           </div>
           <div class="description">
            In this blog, we will see how we can use canvas to draw our own custom shape and drawings .
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/color-palette-in-android/">
          <img alt="Color Palette API in Android" class="ui centered image" src="/images/color-pallete-api.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Color Palette API in Android
           </div>
           <div class="meta">
            24th July 2019
           </div>
           <div class="description">
            In this blog, we will learn about the Color Palette API in Android. Here we will see how can we generate dynamic colors based on an image.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/easy-sms-verification-in-android-sms-user-consent-api/">
          <img alt="Easy SMS Verification in Android: SMS User Consent API" class="ui centered image" src="/images/easy-sms-verification-android-sms-user-consent-api-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Easy SMS Verification in Android: SMS User Consent API
           </div>
           <div class="meta">
            9th August 2019
           </div>
           <div class="description">
            In this blog, we will learn how to implement SMS verification using the SMS User Consent API in Android. This API is used to read only the message containing the verification code and will automatically extract the code from the message by taking permission from the user with the help of a prompt.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/securing-api-keys-using-android-ndk/">
          <img alt="Securing API Keys using Android NDK (Native Development Kit)" class="ui centered image" src="/images/securing-api-keys-using-android-ndk-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Securing API Keys using Android NDK (Native Development Kit)
           </div>
           <div class="meta">
            2nd October 2019
           </div>
           <div class="description">
            In this blog, we will learn how to secure our API Keys that are used in Android applications using the Android NDK (Native Development Kit). We have created a detailed blog of securing the API Keys.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/android-auto-backup-api/">
          <img alt="Auto Backup API in Android" class="ui centered image" src="/images/android-auto-backup-banner-70b0b8fb204b0731.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Auto Backup API in Android
           </div>
           <div class="meta">
            3rd June 2020
           </div>
           <div class="description">
            Android provides a very handy API to deal with user's local data backups. We'll learn how to enable, customize, use and test Android's Auto Backup API.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card" href="/using-gps-location-manager-in-android-android-tutorial/">
          <img alt="Using Fused Location API To Fetch Current Location" class="ui centered image" src="/images/using-gps-location-manager-in-android-android-tutorial-banner.jpg" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Using Fused Location API To Fetch Current Location
           </div>
           <div class="meta">
            7th June 2019
           </div>
           <div class="description">
            In this blog, we will learn how to update the location using the GPS of a mobile device. We will perform an example to check the current location of the user.
           </div>
          </div>
         </a>
        </div>
       </div>
      </div>
     </div>
    </div>
    <div style="background:#fff">
     <footer class="content-container">
      <div class="ui centered padded grid" style="padding-top:40px;background:linear-gradient(to right,#c4e0e0,#e5f1f1)">
       <h2 class="ui huge icon center aligned header">
        <div class="content">
         Connect With Your Mentors
        </div>
       </h2>
       <div class="centered row">
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Janishar Ali" class="ui medium circular image" src="/assets/ali.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://janisharali.com" target="_blank">
             Janishar Ali
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://janisharali.com" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/janisharali" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Amit Shekhar" class="ui medium circular image" src="/assets/amit.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://amitshekhar.me" target="_blank">
             Amit Shekhar
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://amitshekhar.me" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/amitiitbhu" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div class="ui divider" style="margin:unset">
      </div>
      <h5 class="ui header" style="padding:16px;margin:unset;color:#555">
       <i aria-hidden="true" class="copyright icon">
       </i>
       <div class="content">
        Copyright 2022, MindOrks Nextgen Private Limited
       </div>
      </h5>
     </footer>
    </div>
   </div>
  </div>
  <script type="text/javascript">
   window.hljs.initHighlightingOnLoad()
  </script>
 </body>
</html>