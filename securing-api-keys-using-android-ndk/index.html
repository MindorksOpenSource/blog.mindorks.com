<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title>
   Securing API Keys using Android NDK (Native Development Kit)
  </title>
  <meta charset="utf-8"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="minimum-scale=1,initial-scale=1,width=device-width,shrink-to-fit=no" name="viewport"/>
  <link href="https://blog.mindorks.com/securing-api-keys-using-android-ndk" rel="canonical"/>
  <meta content="986249072156-dabps0lf90smluddrk5rkqsdjghk3hd3.apps.googleusercontent.com" name="google-signin-client_id"/>
  <meta content="android, learn android app development, android app development courses, android blogs, android tutorial" name="keywords"/>
  <meta content="Securing API Keys using Android NDK (Native Development Kit)" property="og:title"/>
  <meta content="website" property="og:type"/>
  <meta content="https://blog.mindorks.com/securing-api-keys-using-android-ndk" property="og:url"/>
  <meta content="/images/securing-api-keys-using-android-ndk-banner.png" property="og:image"/>
  <meta content="In this blog, we will learn how to secure our API Keys that are used in Android applications using the Android NDK (Native Development Kit). We have created a detailed blog of securing the API Keys." property="og:description"/>
  <meta content="Securing API Keys using Android NDK (Native Development Kit)" property="twitter:title"/>
  <meta content="In this blog, we will learn how to secure our API Keys that are used in Android applications using the Android NDK (Native Development Kit). We have created a detailed blog of securing the API Keys." name="twitter:description"/>
  <meta content="/images/securing-api-keys-using-android-ndk-banner.png" name="twitter:image:src"/>
  <meta content="summary_large_image" name="twitter:card"/>
  <meta content="@MindorksNextGen" name="twitter:site"/>
  <meta content="In this blog, we will learn how to secure our API Keys that are used in Android applications using the Android NDK (Native Development Kit). We have created a detailed blog of securing the API Keys." name="description"/>
  <meta content="1620001391374687" property="fb:app_id"/>
  <link href="/styles/vendor-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link href="/styles/app-1.8.6.css" rel="stylesheet" type="text/css"/>
  <link as="style" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" onload='this.onload=null,this.rel="stylesheet"' rel="preload"/>
  <noscript>
   <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
  </noscript>
  <script type="text/javascript">
   window.__PRELOADED_STATE__={toastr:{toastrs:[],confirm:null},blogData:{data:{},latestBlogs:null,isFetching:!0,isFetchingLatestBlogs:!1,currentCategory:"",categories:[]},contactData:{formData:{email:"",name:"",phone:"",message:"",isWriting:!1,isNameError:!1,isEmailError:!1,isPhoneError:!1,isMessageError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSending:!1},communityData:{formData:{email:"",isEmailError:!1,isWriting:!1,isSending:!1,dismissMsg:!1},successMessage:null,errorMessage:null},blogPageData:{blogId:352,data:{id:352,title:"Securing API Keys using Android NDK (Native Development Kit)",description:"In this blog, we will learn how to secure our API Keys that are used in Android applications using the Android NDK (Native Development Kit). We have created a detailed blog of securing the API Keys.",text:'<h1 class="graf--h1">Securing API Keys using Android NDK (Native Development Kit)</h1> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/securing-api-keys-using-android-ndk-banner.png class=\'graf-image\' alt=\'Securing API Keys using Android NDK (Native Development Kit)\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">If you are reading this blog then you must be an awesome Android developer or you are going to be one in the future. As an Android developer, we make Android applications and use several third-parties libraries (SDK tools) because it is not possible to develop everything by ourself. May be you have to use Google maps service or any Google play services. Most of these services are paid and it becomes an important task to secure the API keys of these libraries in our application’s code. Some of you might have used the XML or gradle approach to secure the API keys but these can be easily exposed by reverse engineering.</p><blockquote class="graf--blockquote">If you reveal your secrets to the wind, you should not blame the wind for revealing them to the trees.</blockquote><p class="graf--p">So, in this blog, you will learn how to secure API keys using the Android Native Development Kit. To make it easier to understand, I have divided the whole blog into the following topics:</p><ul><li>Current Problem</li><li>Proposed Solution</li><li>How to do this in Android? (three ways)</li><li>Closing Note</li></ul><p class="graf--p">Even after using the Android NDK approach to secure the API keys, by doing the reverse engineering thing, you can still get those API keys but the fact here is that we are just making extra layers for securing the API keys because something is better than nothing and we have everything ;) So, let’s get started.</p><h4 class="graf--h3">Current Problem</h4><p class="graf--p">While developing Android applications, we use various third-parties libraries that make the development of our application fast. In these libraries, we just call some functions according to our need and we don’t know the code of these functions and we don’t care about that. But to call these functions, we need API keys that are different for different users. Some of these libraries are paid and if somehow, someone gets your API key then you might land to high payment bills and many other problems. During the starting days to Android development, we put our API keys either in strings.xml file or in gradle file. Following is an example of storing an API key in strings.xml file:</p><pre><code class="language-java graf graf--code">&lt;resources&gt;\n    &lt;string name="app_name"&gt;SecureAPI&lt;/string&gt;\n    &lt;string name="MyAPIKey"&gt;YOU_AWESOME_API_KEY_HERE&lt;/string&gt;\n&lt;/resources&gt;</code></pre><p class="graf--p">The problem with approach is that anyone can get the API key by reverse engineering. </p><p class="graf--p">Another approach that was used is the <b class="graf--bold">gradle</b> file approach. Here we add the API key in the <b class="graf--bold"><i class="graf--italic">gradle.properties</i></b> file:</p><pre><code class="language-java graf graf--code">#gradle.properties file\n\n#API Key\nMyAwesomeKey = "YOUR_AWESOME_API_KEY_HERE"</code></pre><p class="graf--p">After that, import the API key as <i class="graf--italic">buildConfigField</i> in the <i class="graf--italic"><b class="graf--bold">build.gradle</b></i> file.</p><pre><code class="language-java graf graf--code">buildTypes {\n    debug {\n        buildConfigField \'String\', "ApiKey", MyAwesomeKey\n        resValue \'string\', "api_key", MyAwesomeKey\n    }\n    ...\n}</code></pre><p class="graf--p">But still anyone can get the API key by reverse engineering your code.</p><p class="graf--p">So, both methods failed to secure the API keys. We need a certain concrete method that can be used so that even after reverse-engineering the code, no one can get the desired API key. Let’s find a solution.</p><h4 class="graf--h3">Proposed Solution</h4><p class="graf--p">We have discussed the problem in the previous section. So, what should we do so that even after reverse engineering no one can get the API key?</p><p class="graf--p">One solution to the above problem can be the use of native language in our application code. In the native languages like in C or C++, the Android Native Development Kit(NDK) compiles the code to <b class="graf--bold">.<i class="graf--italic">so</i></b> file. The benefit with this <b class="graf--bold"><i class="graf--italic">.so</i></b> file is that it contains binary numbers i.e. in the form of 0s and 1s. So, even after reverse engineering, you will get 0s and 1s and it is very difficult to identify what is written in the form of 0s and 1s.</p><p class="graf--p">No doubt, there are methods to get the code from 0s and 1s also, but as I said earlier, we are just providing some extra security layers to our code.</p><h4 class="graf--h3">How to do this in Android? (three ways)</h4><p class="graf--p">In Android, we have the support of Native languages with the help of the Android Native Development Kit (NDK). Also, there is JNI(Java Native Interface) in Android. JNI defines a way for the bytecode that is generated from the Java or Kotlin code to interact with the native code i.e. code written in C or C++.</p><p class="graf--p">So, with the help of Android NDK, we can secure the API keys. Based on the versions of Android Studio, we have three approaches to secure our API keys:</p><ol><li>Using the Native C++ template</li><li>Using CMake</li><li>Using ndk-build</li></ol><p class="graf--p">But before moving on to these approaches, there are some prerequisites. </p><h4 class="graf--h3">Prerequisites</h4><p class="graf--p">In this blog, you will be learning three different ways of securing API keys using the Android NDK. So, before moving onto that, you have to download some tools. Follow the below steps:</p><ol><li>In your Android Studio, click on <b class="graf--bold"><i class="graf--italic">Tools &gt; SDK Manager &gt; SDK Tools</i></b>.</li><li>Select <i class="graf--italic">LLBD</i>, <i class="graf--italic">NDK</i>, and <i class="graf--italic">CMake</i>.</li><li>Click on <b class="graf--bold">Apply</b> and after downloading and installing click on <b class="graf--bold">OK</b>.</li></ol> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/securing-api-keys-using-android-ndk-downloading-llbd-ndk-cmake.jpg class=\'graf-image\' alt=\'Securing API Keys using Android NDK (Native Development Kit)\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p"><b class="graf--bold">LLBD:</b> It is used by Android Studio to debug the native code present in your project.</p><p class="graf--p"><b class="graf--bold">NDK:</b> Native Development Kit(NDK) is used to code in C and C++ i.e. native languages for Android.</p><p class="graf--p"><b class="graf--bold">CMake:</b> It is an open-source system that manages the build process in an operating system and a compiler-independent manner.</p><p class="graf--p">Now, we done with downloading the tools, let’s quickly move on to the approaches of securing the API keys.</p><h4 class="graf--h3">Using the Native C++ template</h4><p class="graf--p">In the latest versions of Android Studio, we have support for native code i.e. for the C and C++. Follow the below steps to add Native C++ in your project:</p><p class="graf--p"><b class="graf--bold">Step1:</b> Create a new project in Android studio with <b class="graf--bold">Native C++</b> template.</p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/securing-api-keys-using-android-ndk-native-cpp-step1.jpg class=\'graf-image\' alt=\'Securing API Keys using Android NDK (Native Development Kit)\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p"><b class="graf--bold">Step2:</b> Add the details of the project and click on Next.</p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/securing-api-keys-using-android-ndk-native-cpp-step2.jpg class=\'graf-image\' alt=\'Securing API Keys using Android NDK (Native Development Kit)\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p"><b class="graf--bold">Step3:</b> Keep the settings to default and click on Finish.</p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/securing-api-keys-using-android-ndk-native-cpp-step3.jpg class=\'graf-image\' alt=\'Securing API Keys using Android NDK (Native Development Kit)\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p"><b class="graf--bold">Step4:</b> You can find that by default you will be having <b class="graf--bold"><i class="graf--italic">native-lib.cpp</i></b> file and the <b class="graf--bold"><i class="graf--italic">CMakeLists.txt</i></b> file added to your project under the cpp directory.</p> <div class=\'graf-image graf-caption\'>\n\t\t\t\t\t\t\t\t\t<img src=/images/securing-api-keys-using-android-ndk-project-structure.png class=\'graf-image\' alt=\'Securing API Keys using Android NDK (Native Development Kit)\' />\n\t\t\t\t\t\t\t\t</div ><p class="graf--p">The <b class="graf--bold"><i class="graf--italic">native-lib.cpp</i></b> file is the file that contains your API keys. You can add your API keys in the file as below:</p><pre><code class="language-java graf graf--code">#include &lt;jni.h&gt;\n#include &lt;string&gt;\n\nextern "C" JNIEXPORT jstring JNICALL\nJava_com_mindorks_myapplication_APIKeyLibrary_getAPIKey(JNIEnv* env, jobject /* this */) {\n    std::string api_key = "YOUR_AWESOME_API_KEY_GOES_HERE";\n    return env-&gt;NewStringUTF(api_key.c_str());\n}</code></pre><p class="graf--p">Following is the description of the above code:</p><ul><li>Here, you have to follow the combination of <i class="graf--italic">PackageName_ActivityName_MethodName</i>.</li><li>In the above example, com_mindorks_myapplication is the package name, APIKeyLibrary is the file name and getAPIKey is the method that is used to get the API keys from the native code.</li><li>You can directly return the API key but normally people use some encryption technique to encrypt the API key. So, the <i class="graf--italic">NewStringUTF()</i> method is used to do the UTF-8 encoding.</li></ul><p class="graf--p"><b class="graf--bold">Step5:</b> Now, to use your API key in the Activity or in any file, go to the Activity or the file where you want to use your API keys. To load the native code that you have written, you need to call the <i class="graf--italic">System.loadLibrary(“native-lib”)</i> method in the init block.</p><pre><code class="language-java graf graf--code">init {\n        System.loadLibrary("native-lib")\n}</code></pre><p class="graf--p"><b class="graf--bold">Step6:</b> Now, declare a Kotlin external function with the same name as used in the native code.</p><pre><code class="language-java graf graf--code">external fun getAPIKey(): String</code></pre><p class="graf--p"><b class="graf--bold">Step7:</b> Finally, you can get the API key by calling:</p><pre><code class="language-java graf graf--code">APIKeyLibrary.getAPIKey()</code></pre><p class="graf--p">That’s all! You have secured your API key :)</p><blockquote class="graf--blockquote">So far so good</blockquote><p class="graf--p">If you are having an older version of Android Studio that doesn’t have the support of the Native C++ template. Then you can make use of <b class="graf--bold">CMake</b>. The difference between these two approaches is that in the CMake approach you have to add the files manually while in the previous approach everything is added by default.</p><h4 class="graf--h3">Using CMake</h4><p class="graf--p">Apart from using the <i class="graf--italic">Native C++ template</i>, we can use the <b class="graf--bold">CMake</b> to secure the API keys i.e we can add the files manually to our project.</p><blockquote class="graf--blockquote">CMake is used to control the software compilation process using simple platform and compiler independent configuration files, and generate native makefiles and workspaces that can be used in the compiler environment of your choice.</blockquote><p class="graf--p">For more information on CMake, you can visit its <a class="markup--anchor" target="_blank" href="https://cmake.org/">official website</a>.</p><p class="graf--p">Following are steps that can be followed to secure API keys using CMake:</p><p class="graf--p"><b class="graf--bold">Step1:</b> Install the required tools that are mentioned in the prerequisite part of this blog.</p><p class="graf--p"><b class="graf--bold">Step2:</b> Under the <b class="graf--bold"><i class="graf--italic">app/src/main</i></b> directory, create a directory named <b class="graf--bold"><i class="graf--italic">cpp</i></b>.</p><p class="graf--p"><b class="graf--bold">Step3:</b> In the cpp directory, create a native file where you want to store your API keys. So, create a file named <b class="graf--bold"><i class="graf--italic">api-keys.cpp</i></b> and add the below code:</p><pre><code class="language-java graf graf--code">#include &lt;jni.h&gt;\n#include &lt;string&gt;\n\nextern "C" JNIEXPORT jstring JNICALL\nJava_com_mindorks_myapplication_APIKeyLibrary_getAPIKey(JNIEnv* env, jobject /* this */) {\n    std::string api_key = "YOUR_AWESOME_API_KEY_GOES_HERE";\n    return env-&gt;NewStringUTF(api_key.c_str());\n}</code></pre><p class="graf--p"><b class="graf--bold">Step4:</b> In your <b class="graf--bold"><i class="graf--italic">app/</i></b> directory, you need to add one text file named <b class="graf--bold"><i class="graf--italic">CMakeLists.txt</i></b> file. It is a CMake build script. Add the below content into it:</p><pre><code class="language-java graf graf--code"># For more information about using CMake with Android Studio, read the\n# documentation: https://d.android.com/studio/projects/add-native-code.html\n\n# Sets the minimum version of CMake required to build the native library.\n\ncmake_minimum_required(VERSION 3.4.1)\n\n# Creates and names a library, sets it as either STATIC\n# or SHARED, and provides the relative paths to its source code.\n# You can define multiple libraries, and CMake builds them for you.\n# Gradle automatically packages shared libraries with your APK.\n\nadd_library( # Sets the name of the library.\napi-keys\n\n# Sets the library as a shared library.\n        SHARED\n\n# Provides a relative path to your source file(s).\nsrc/main/cpp/api-keys.cpp )\n\n# Searches for a specified prebuilt library and stores the path as a\n# variable. Because CMake includes system libraries in the search path by\n# default, you only need to specify the name of the public NDK library\n# you want to add. CMake verifies that the library exists before\n# completing its build.\n\nfind_library( # Sets the name of the path variable.\nlog-lib\n\n# Specifies the name of the NDK library that\n# you want CMake to locate.\n        log )\n\n# Specifies libraries CMake should link to your target library. You\n# can link multiple libraries, such as libraries you define in this\n# build script, prebuilt third-party libraries, or system libraries.\n\ntarget_link_libraries( # Specifies the target library.\nnative-lib\n\n# Links the target library to the log library\n# included in the NDK.\n        ${log-lib} )</code></pre><p class="graf--p"><b class="graf--bold">Step5:</b> Now, you have to specify the path of your CMakeLists file in the <b class="graf--bold"><i class="graf--italic">build.gradle</i></b> file. So, add the below code in <b class="graf--bold"><i class="graf--italic">build.gradle</i></b> file:</p><pre><code class="language-java graf graf--code">android {\n    ...\n    defaultConfig {\n        ...\n    }\n    buildTypes {\n        ...\n    }\n    externalNativeBuild {\n        cmake {\n            path \'CMakeLists.txt\'\n        }\n    }\n}</code></pre><p class="graf--p">Now, to access the API keys from your Activity or file, you can follow the same steps(<i class="graf--italic">Steps 5, 6, and 7</i>) as followed in the previous approach i.e. the Native C++ template approach.</p><p class="graf--p">If your Android Studio version doesn’t have the support of CMake then also you can use the NDK to secure your API keys. Here, you can use the ndk-build process. Let’s see how to do this.</p><h4 class="graf--h3">Using ndk-build</h4><p class="graf--p">To compile the native code present in the project, Android Studio supports the <i class="graf--italic">ndk-build</i>. Here, you will be having an <i class="graf--italic"><b class="graf--bold">Android.mk</b></i> build file that is used by <i class="graf--italic">ndk-build</i>.</p><p class="graf--p">The <i class="graf--italic">Android.mk</i> file is present inside the <i class="graf--italic"><b class="graf--bold">jni/</b></i> directory. It describes your sources and shared libraries to the build system. The basic purpose of the <i class="graf--italic">Android.mk</i> file is to define project-wide settings that are not defined by the build system or by Application.mk or by environment variables. Also, the syntax of the <i class="graf--italic">Android.mk</i> file allows you to group your sources into modules.</p><p class="graf--p">Follow the below steps to use ndk-build:</p><p class="graf--p"><b class="graf--bold">Step1:</b> Under the <b class="graf--bold"><i class="graf--italic">app/src/main</i></b> directory, create a directory named <b class="graf--bold">jni</b>. Here we will be having our <i class="graf--italic">.mk</i> files and the native code file.</p><p class="graf--p"><b class="graf--bold">Step2:</b> In the <b class="graf--bold">jni</b> directory that you have created in the previous step, add one file named <i class="graf--italic">Android.mk </i>and add the below lines of code to it:</p><pre><code class="language-java graf graf--code">LOCAL_PATH := $(call my-dir)\n\ninclude $(CLEAR_VARS)\n\nLOCAL_MODULE    := api-keys\nLOCAL_SRC_FILES := api-keys.c\n\ninclude $(BUILD_SHARED_LIBRARY)</code></pre><p class="graf--p">Following is the description of the above code:</p><ul><li>The LOCAL_PATH variable indicates the location of the source file. <b class="graf--bold"><i class="graf--italic">my-dir</i></b> is a macro function provided by the build system to return the current directory.</li><li>The CLEAR_VARS is used to clear many LOCAL_XXX variables for you like LOCAL_MODULE, LOCAL_SRC_FILES, etc. It doesn’t clear LOCAL_PATH.</li><li>The LOCAL_MODULE variable stores the name of the module that you want to build. The module name must be unique and you shouldn’t use any space in the module name.</li><li>The LOCAL_SRC_FILES variable contains a list of C or C++ files that are present in the module.</li><li>The BUILD_SHARED_LIBRARY variable is used to tie everything together. It determines what to build, and how to do it. It collects the information that you defined in LOCAL_XXX variables since the most recent <b class="graf--bold">include</b>.</li></ul><p class="graf--p"><b class="graf--bold">Step3:</b> In the <b class="graf--bold">jni</b> directory, create another file named <b class="graf--bold"><i class="graf--italic">Application.mk</i></b> file and add the below code:</p><pre><code class="language-java graf graf--code">APP_ABI := all</code></pre><p class="graf--p">The <i class="graf--italic">Application.mk</i> file is used to specify the project-wide settings for the ndk-build.</p><p class="graf--p">The variable APP_ABI is used to specify the ABIs whose code should be generated by the build system. By default, the build system generates the code for all non-deprecated ABIs.</p><p class="graf--p"><b class="graf--bold">Step4:</b> The last file to be added in the <b class="graf--bold"><i class="graf--italic">jni</i></b> directory is your native code file. So, in the jni directory, add one file named <b class="graf--bold"><i class="graf--italic">api-keys.c</i></b> and add the below code into it:</p><pre><code class="language-java graf graf--code">#include &lt;jni.h&gt;\n\n//For first API key\nJNIEXPORT jstring JNICALL\nJava_com_mindorks_myapplication_APIKeyLibrary_getAPIKey(JNIEnv *env, jobject instance) {\n\n    return (*env)-&gt;  NewStringUTF(env, "YOUR_AWESOME_API_GOES_HERE");\n\n}</code></pre><p class="graf--p"><b class="graf--bold">Step5:</b> After adding the required files in your <b class="graf--bold"><i class="graf--italic">jni</i></b> directory, our next aim is to provide the path of our <i class="graf--italic">Android.mk</i> file in the <i class="graf--italic">build.gradle</i> file.</p><pre><code class="language-java graf graf--code">android {\n    ...\n    defaultConfig {\n        ...\n    }\n    buildTypes {\n        ...\n    }\n    externalNativeBuild {\n        ndkBuild {\n            path \'src/main/jni/Android.mk\'\n        }\n    }\n}</code></pre><p class="graf--p">Now, to access the API keys from your Activity or file, you can follow the same steps(<i class="graf--italic">Steps 5, 6, and 7</i>) as followed in the previous approach i.e. the Native C++ template approach.</p><h4 class="graf--h3">Closing Note</h4><p class="graf--p">In this blog, we learned how to secure our API keys with the help of the Android Native Development Kit. We saw three methods of doing so i.e. the ndk-build method, the CMake method and the easiest one i.e. using the native c++ template in our project.</p><p class="graf--p">Hope you learned something new today.</p><p class="graf--p">Do share this blog with your fellow developers to spread the knowledge. You can read more blogs on Android on our <a class="markup--anchor" target="_blank" href="https://blog.mindorks.com/">blogging website</a>.</p><p class="graf--p"><b class="graf--bold"><a class="markup--anchor" target="_blank" href="https://bootcamp.mindorks.com/">Apply Now: MindOrks Android Online Course and Learn Advanced Android</a></b></p><p class="graf--p">Happy Learning :)</p><p class="graf--p"><b class="graf--bold">Team MindOrks!</b></p>',author:17146,img_url:"/images/securing-api-keys-using-android-ndk-banner.png",blog_url:"securing-api-keys-using-android-ndk",likes:0,rank:0,category:1,published_at:"2nd October 2019"},author:{id:17146,name:"Sumit Mishra",google_profile_pic:"https://lh3.googleusercontent.com/a-/AOh14GiHP4JrkmlLjuz_uG1g4E0MhTUClSNytqB8o-pxCA=s96-c?sz=300",fb_profile_pic:null,profile_tagline:"Software Development Engineer at MindOrks",fb_profile_url:"https://www.facebook.com/mishra3452",google_plus_profile_url:null,twitter_profile_url:"https://twitter.com/hiii_sumit",github_profile_url:"https://github.com/mishra3452",linkedin_profile_url:"https://www.linkedin.com/in/sumit-mishra-a15499135/"},isFetching:!1,similarBlogs:[{id:411,title:"Using local.properties file to avoid API Keys check-in into Version Control System",description:"This blog describes how to use the local.properties file in the Android Gradle system to avoid local or user-specific information such as API keys to be checked into the Version Control System.",author:3003,img_url:"/images/using-localproperties-banner-image.png",blog_url:"using-local-properties-file-to-avoid-api-keys-check-in-into-version-control-system",likes:0,rank:0,category:1,published_at:"3rd April 2020",score:6.372191429138184},{id:422,title:"Navigate between pages in a React Native App",description:"In this blog, we are going to learn how can we navigate inside a react native application and how navigation works. We will learn how to implement the navigation in our app.",author:9959,img_url:"/images/react-navigation-banner.png",blog_url:"navigate-between-pages-in-a-react-native-app",likes:0,rank:0,category:9,published_at:"21st April 2020",score:4.2850565910339355},{id:357,title:"Getting started with Android NDK: Android Tutorial",description:"In this blog, we will learn how to use Android NDK. We will learn the use of native codes i.e. C and C++ in Android development. So, let's learn about Android development in a native way.",author:14897,img_url:"/images/getting-started-with-android-ndk-android-tutorial-banner.png",blog_url:"getting-started-with-android-ndk-android-tutorial",likes:0,rank:0,category:1,published_at:"9th October 2019",score:3.605388879776001},{id:269,title:"Using Fused Location API To Fetch Current Location",description:"In this blog, we will learn how to update the location using the GPS of a mobile device. We will perform an example to check the current location of the user.",author:14897,img_url:"/images/using-gps-location-manager-in-android-android-tutorial-banner.jpg",blog_url:"using-gps-location-manager-in-android-android-tutorial",likes:0,rank:0,category:1,published_at:"7th June 2019",score:2.08713436126709},{id:304,title:"Color Palette API in Android",description:"In this blog, we will learn about the Color Palette API in Android. Here we will see how can we generate dynamic colors based on an image.",author:9959,img_url:"/images/color-pallete-api.png",blog_url:"color-palette-in-android",likes:0,rank:0,category:1,published_at:"24th July 2019",score:1.7772136926651},{id:312,title:"Easy SMS Verification in Android: SMS User Consent API",description:"In this blog, we will learn how to implement SMS verification using the SMS User Consent API in Android. This API is used to read only the message containing the verification code and will automatically extract the code from the message by taking permission from the user with the help of a prompt. ",author:14897,img_url:"/images/easy-sms-verification-android-sms-user-consent-api-banner.png",blog_url:"easy-sms-verification-in-android-sms-user-consent-api",likes:0,rank:0,category:1,published_at:"9th August 2019",score:1.7772136926651}],isSimilarBlogsFetching:!1},loginData:{data:null,isLoggingIn:!1,isLoggingOut:!1,loginState:!1,isForcedLogout:!1,isTokenRefreshed:!1,isRedirectHome:!1,message:""},updatesData:{news:null,inspirations:null,isNewsFetching:!0,isInspirationsFetching:!0},blogEditorData:{blogId:null,blogDetailsFormData:{title:"",description:"",imgUrl:"",blogUrl:"",category:"",categories:[],isWriting:!1,isTitleError:!1,isDescriptionError:!1,isImgUrlError:!1,isBlogUrlError:!1,isCategoryError:!1,isUploadingImage:!1,uploadedImageUrl:null},editorState:null,editorText:null,successMessage:null,errorMessage:null,isSending:!1,isMsgToShow:!1,isPublished:!1,isSubmitted:!1,isDraft:!0,isEditOfExistingBlog:!1,isFetchingBlogCategories:!1,isUploadingImage:!1,uploadedImageUrl:null},myBlogsData:{data:null,isSubmittedBlogsFetching:!0,isDraftBlogsFetching:!0,isPublishedBlogsFetching:!0,successMessage:null,errorMessage:null,isMsgToShow:!1,tabNames:["drafts","submissions","published"],selectedTab:"drafts",isFetchingBlog:!1,isDeletingBlog:!1,openEditorPage:!1},profilePreviewData:{profile:null,blogs:null,isFetchingProfile:!1,isFetchingAuthorBlogs:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,isUserNotRegistered:!1,redirectToMyProfileEdit:!1},profileEditableData:{userId:null,name:null,fbProfilePicUrl:null,googleProfilePicUrl:null,profileFormData:{tagline:"",fbProfileUrl:"",googlePlusProfileUrl:"",twitterProfileUrl:"",githubProfileUrl:"",linkedinProfileUrl:"",isWriting:!1,isTaglineError:!1,isFbProfileUrlError:!1,isGooglePlusProfileUrlError:!1,isTwitterProfileUrlError:!1,isGithubProfileUrlError:!1,isLinkedinProfileUrlError:!1},isSavingProfile:!1,successMessage:null,errorMessage:null,isMsgToShow:!1,redirectToProfilePreview:!1},submitBlogData:{formData:{email:"",name:"",link:"",isWriting:!1,isNameError:!1,isEmailError:!1,isLinkError:!1,dismissMsg:!1},successMessage:null,errorMessage:null,isSubmitting:!1},advertisementsData:{data:{},isLoading:!1},recaptchaData:{verified:!1,successMessage:null,errorMessage:null},blogSearchData:{searches:null,isSearching:!1}}
  </script>
  <script async="" src="https://www.google-analytics.com/analytics.js" type="text/javascript">
  </script>
  <script type="text/javascript">
   window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-91686131-1","auto"),ga("require","cleanUrlTracker"),ga("require","eventTracker"),ga("require","impressionTracker"),ga("require","outboundLinkTracker"),ga("require","urlChangeTracker"),ga("require","maxScrollTracker"),ga("require","mediaQueryTracker"),ga("require","outboundFormTracker"),ga("require","outboundLinkTracker"),ga("require","pageVisibilityTracker"),ga("require","socialWidgetTracker"),ga("require","urlChangeTracker"),ga("send","pageview")
  </script>
  <script defer="defer" src="/assets/autotrack.js" type="text/javascript">
  </script>
  <script src="/assets/highlight.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/vendor-bundle-1.8.6.js" type="text/javascript">
  </script>
  <script defer="defer" src="/js/app-bundle-1.8.6.js" type="text/javascript">
  </script>
 </head>
 <body>
  <div id="root">
   <div class="screen app-load-content" data-reactroot="">
    <div class="ui centered grid">
     <div class="row" style="padding:0">
      <div class="ui fixed menu navbar huge borderless grid" style="background-color:#fff;height:60px">
      </div>
     </div>
     <div class="centered computer only row" style="padding:0">
      <div class="ui fixed top menu navbar huge borderless grid header-container" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="right menu">
        <a class="item" href="https://janisharali.com" target="_blank">
         Mentor Ali
        </a>
        <a class="item" href="https://amitshekhar.me" target="_blank">
         Mentor Amit
        </a>
       </div>
      </div>
     </div>
     <div class="tablet only mobile only row" style="padding:0">
      <div class="ui fixed top navbar huge menu borderless" style="background-color:#fff;height:60px">
       <a class="item brand" href="/">
        <img alt="MindOrks" src="/assets/mindorks-logo.svg"/>
        <div class="header item" style="font-size:20px;padding:0;margin-left:10px">
         MindOrks
        </div>
       </a>
       <div class="item">
       </div>
      </div>
     </div>
    </div>
    <div class="header-height">
    </div>
    <div aria-live="assertive" class="redux-toastr">
     <div>
      <div class="top-left">
      </div>
      <div class="top-right">
      </div>
      <div class="top-center">
      </div>
      <div class="bottom-left">
      </div>
      <div class="bottom-right">
      </div>
      <div class="bottom-center">
      </div>
     </div>
    </div>
    <div class="content-container theme">
     <div class="ui centered one column grid" style="padding-bottom:80px;background-color:#fff">
      <div class="ten wide computer fifteen wide mobile fifteen wide tablet column" style="margin-top:50px">
       <div>
        <div class="blog-page-author">
         <div class="ui small header">
          <img alt="Sumit Mishra" class="ui circular image" src="https://lh3.googleusercontent.com/a-/AOh14GiHP4JrkmlLjuz_uG1g4E0MhTUClSNytqB8o-pxCA=s96-c?sz=300"/>
          <div class="content">
           Sumit Mishra
           <div class="sub header" style="margin-top:5px">
            2nd October 2019
           </div>
          </div>
         </div>
        </div>
        <div id="content">
         <article class="template">
          <div class="postContent">
           <div class="notesSource">
            <div class="postField postField--body" id="editor">
             <section class="section--first section--last">
              <div class="section-divider layoutSingleColumn-template">
               <hr class="section-divider"/>
              </div>
              <div class="section-content">
               <div class="section-inner layoutSingleColumn-template">
                <div>
                 <h1 class="graf--h1">
                  Securing API Keys using Android NDK (Native Development Kit)
                 </h1>
                 <div class="graf-image graf-caption">
                  <img alt="Securing API Keys using Android NDK (Native Development Kit)" class="graf-image" src="/images/securing-api-keys-using-android-ndk-banner.png"/>
                 </div>
                 <p class="graf--p">
                  If you are reading this blog then you must be an awesome Android developer or you are going to be one in the future. As an Android developer, we make Android applications and use several third-parties libraries (SDK tools) because it is not possible to develop everything by ourself. May be you have to use Google maps service or any Google play services. Most of these services are paid and it becomes an important task to secure the API keys of these libraries in our application’s code. Some of you might have used the XML or gradle approach to secure the API keys but these can be easily exposed by reverse engineering.
                 </p>
                 <blockquote class="graf--blockquote">
                  If you reveal your secrets to the wind, you should not blame the wind for revealing them to the trees.
                 </blockquote>
                 <p class="graf--p">
                  So, in this blog, you will learn how to secure API keys using the Android Native Development Kit. To make it easier to understand, I have divided the whole blog into the following topics:
                 </p>
                 <ul>
                  <li>
                   Current Problem
                  </li>
                  <li>
                   Proposed Solution
                  </li>
                  <li>
                   How to do this in Android? (three ways)
                  </li>
                  <li>
                   Closing Note
                  </li>
                 </ul>
                 <p class="graf--p">
                  Even after using the Android NDK approach to secure the API keys, by doing the reverse engineering thing, you can still get those API keys but the fact here is that we are just making extra layers for securing the API keys because something is better than nothing and we have everything ;) So, let’s get started.
                 </p>
                 <h4 class="graf--h3">
                  Current Problem
                 </h4>
                 <p class="graf--p">
                  While developing Android applications, we use various third-parties libraries that make the development of our application fast. In these libraries, we just call some functions according to our need and we don’t know the code of these functions and we don’t care about that. But to call these functions, we need API keys that are different for different users. Some of these libraries are paid and if somehow, someone gets your API key then you might land to high payment bills and many other problems. During the starting days to Android development, we put our API keys either in strings.xml file or in gradle file. Following is an example of storing an API key in strings.xml file:
                 </p>
                 <pre><code class="language-java graf graf--code">&lt;resources&gt;
    &lt;string name="app_name"&gt;SecureAPI&lt;/string&gt;
    &lt;string name="MyAPIKey"&gt;YOU_AWESOME_API_KEY_HERE&lt;/string&gt;
&lt;/resources&gt;</code></pre>
                 <p class="graf--p">
                  The problem with approach is that anyone can get the API key by reverse engineering.
                 </p>
                 <p class="graf--p">
                  Another approach that was used is the
                  <b class="graf--bold">
                   gradle
                  </b>
                  file approach. Here we add the API key in the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    gradle.properties
                   </i>
                  </b>
                  file:
                 </p>
                 <pre><code class="language-java graf graf--code">#gradle.properties file

#API Key
MyAwesomeKey = "YOUR_AWESOME_API_KEY_HERE"</code></pre>
                 <p class="graf--p">
                  After that, import the API key as
                  <i class="graf--italic">
                   buildConfigField
                  </i>
                  in the
                  <i class="graf--italic">
                   <b class="graf--bold">
                    build.gradle
                   </b>
                  </i>
                  file.
                 </p>
                 <pre><code class="language-java graf graf--code">buildTypes {
    debug {
        buildConfigField 'String', "ApiKey", MyAwesomeKey
        resValue 'string', "api_key", MyAwesomeKey
    }
    ...
}</code></pre>
                 <p class="graf--p">
                  But still anyone can get the API key by reverse engineering your code.
                 </p>
                 <p class="graf--p">
                  So, both methods failed to secure the API keys. We need a certain concrete method that can be used so that even after reverse-engineering the code, no one can get the desired API key. Let’s find a solution.
                 </p>
                 <h4 class="graf--h3">
                  Proposed Solution
                 </h4>
                 <p class="graf--p">
                  We have discussed the problem in the previous section. So, what should we do so that even after reverse engineering no one can get the API key?
                 </p>
                 <p class="graf--p">
                  One solution to the above problem can be the use of native language in our application code. In the native languages like in C or C++, the Android Native Development Kit(NDK) compiles the code to
                  <b class="graf--bold">
                   .
                   <i class="graf--italic">
                    so
                   </i>
                  </b>
                  file. The benefit with this
                  <b class="graf--bold">
                   <i class="graf--italic">
                    .so
                   </i>
                  </b>
                  file is that it contains binary numbers i.e. in the form of 0s and 1s. So, even after reverse engineering, you will get 0s and 1s and it is very difficult to identify what is written in the form of 0s and 1s.
                 </p>
                 <p class="graf--p">
                  No doubt, there are methods to get the code from 0s and 1s also, but as I said earlier, we are just providing some extra security layers to our code.
                 </p>
                 <h4 class="graf--h3">
                  How to do this in Android? (three ways)
                 </h4>
                 <p class="graf--p">
                  In Android, we have the support of Native languages with the help of the Android Native Development Kit (NDK). Also, there is JNI(Java Native Interface) in Android. JNI defines a way for the bytecode that is generated from the Java or Kotlin code to interact with the native code i.e. code written in C or C++.
                 </p>
                 <p class="graf--p">
                  So, with the help of Android NDK, we can secure the API keys. Based on the versions of Android Studio, we have three approaches to secure our API keys:
                 </p>
                 <ol>
                  <li>
                   Using the Native C++ template
                  </li>
                  <li>
                   Using CMake
                  </li>
                  <li>
                   Using ndk-build
                  </li>
                 </ol>
                 <p class="graf--p">
                  But before moving on to these approaches, there are some prerequisites.
                 </p>
                 <h4 class="graf--h3">
                  Prerequisites
                 </h4>
                 <p class="graf--p">
                  In this blog, you will be learning three different ways of securing API keys using the Android NDK. So, before moving onto that, you have to download some tools. Follow the below steps:
                 </p>
                 <ol>
                  <li>
                   In your Android Studio, click on
                   <b class="graf--bold">
                    <i class="graf--italic">
                     Tools &gt; SDK Manager &gt; SDK Tools
                    </i>
                   </b>
                   .
                  </li>
                  <li>
                   Select
                   <i class="graf--italic">
                    LLBD
                   </i>
                   ,
                   <i class="graf--italic">
                    NDK
                   </i>
                   , and
                   <i class="graf--italic">
                    CMake
                   </i>
                   .
                  </li>
                  <li>
                   Click on
                   <b class="graf--bold">
                    Apply
                   </b>
                   and after downloading and installing click on
                   <b class="graf--bold">
                    OK
                   </b>
                   .
                  </li>
                 </ol>
                 <div class="graf-image graf-caption">
                  <img alt="Securing API Keys using Android NDK (Native Development Kit)" class="graf-image" src="/images/securing-api-keys-using-android-ndk-downloading-llbd-ndk-cmake.jpg"/>
                 </div>
                 <p class="graf--p">
                  <b class="graf--bold">
                   LLBD:
                  </b>
                  It is used by Android Studio to debug the native code present in your project.
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   NDK:
                  </b>
                  Native Development Kit(NDK) is used to code in C and C++ i.e. native languages for Android.
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   CMake:
                  </b>
                  It is an open-source system that manages the build process in an operating system and a compiler-independent manner.
                 </p>
                 <p class="graf--p">
                  Now, we done with downloading the tools, let’s quickly move on to the approaches of securing the API keys.
                 </p>
                 <h4 class="graf--h3">
                  Using the Native C++ template
                 </h4>
                 <p class="graf--p">
                  In the latest versions of Android Studio, we have support for native code i.e. for the C and C++. Follow the below steps to add Native C++ in your project:
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step1:
                  </b>
                  Create a new project in Android studio with
                  <b class="graf--bold">
                   Native C++
                  </b>
                  template.
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="Securing API Keys using Android NDK (Native Development Kit)" class="graf-image" src="/images/securing-api-keys-using-android-ndk-native-cpp-step1.jpg"/>
                 </div>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step2:
                  </b>
                  Add the details of the project and click on Next.
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="Securing API Keys using Android NDK (Native Development Kit)" class="graf-image" src="/images/securing-api-keys-using-android-ndk-native-cpp-step2.jpg"/>
                 </div>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step3:
                  </b>
                  Keep the settings to default and click on Finish.
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="Securing API Keys using Android NDK (Native Development Kit)" class="graf-image" src="/images/securing-api-keys-using-android-ndk-native-cpp-step3.jpg"/>
                 </div>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step4:
                  </b>
                  You can find that by default you will be having
                  <b class="graf--bold">
                   <i class="graf--italic">
                    native-lib.cpp
                   </i>
                  </b>
                  file and the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    CMakeLists.txt
                   </i>
                  </b>
                  file added to your project under the cpp directory.
                 </p>
                 <div class="graf-image graf-caption">
                  <img alt="Securing API Keys using Android NDK (Native Development Kit)" class="graf-image" src="/images/securing-api-keys-using-android-ndk-project-structure.png"/>
                 </div>
                 <p class="graf--p">
                  The
                  <b class="graf--bold">
                   <i class="graf--italic">
                    native-lib.cpp
                   </i>
                  </b>
                  file is the file that contains your API keys. You can add your API keys in the file as below:
                 </p>
                 <pre><code class="language-java graf graf--code">#include &lt;jni.h&gt;
#include &lt;string&gt;

extern "C" JNIEXPORT jstring JNICALL
Java_com_mindorks_myapplication_APIKeyLibrary_getAPIKey(JNIEnv* env, jobject /* this */) {
    std::string api_key = "YOUR_AWESOME_API_KEY_GOES_HERE";
    return env-&gt;NewStringUTF(api_key.c_str());
}</code></pre>
                 <p class="graf--p">
                  Following is the description of the above code:
                 </p>
                 <ul>
                  <li>
                   Here, you have to follow the combination of
                   <i class="graf--italic">
                    PackageName_ActivityName_MethodName
                   </i>
                   .
                  </li>
                  <li>
                   In the above example, com_mindorks_myapplication is the package name, APIKeyLibrary is the file name and getAPIKey is the method that is used to get the API keys from the native code.
                  </li>
                  <li>
                   You can directly return the API key but normally people use some encryption technique to encrypt the API key. So, the
                   <i class="graf--italic">
                    NewStringUTF()
                   </i>
                   method is used to do the UTF-8 encoding.
                  </li>
                 </ul>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step5:
                  </b>
                  Now, to use your API key in the Activity or in any file, go to the Activity or the file where you want to use your API keys. To load the native code that you have written, you need to call the
                  <i class="graf--italic">
                   System.loadLibrary(“native-lib”)
                  </i>
                  method in the init block.
                 </p>
                 <pre><code class="language-java graf graf--code">init {
        System.loadLibrary("native-lib")
}</code></pre>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step6:
                  </b>
                  Now, declare a Kotlin external function with the same name as used in the native code.
                 </p>
                 <pre><code class="language-java graf graf--code">external fun getAPIKey(): String</code></pre>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step7:
                  </b>
                  Finally, you can get the API key by calling:
                 </p>
                 <pre><code class="language-java graf graf--code">APIKeyLibrary.getAPIKey()</code></pre>
                 <p class="graf--p">
                  That’s all! You have secured your API key :)
                 </p>
                 <blockquote class="graf--blockquote">
                  So far so good
                 </blockquote>
                 <p class="graf--p">
                  If you are having an older version of Android Studio that doesn’t have the support of the Native C++ template. Then you can make use of
                  <b class="graf--bold">
                   CMake
                  </b>
                  . The difference between these two approaches is that in the CMake approach you have to add the files manually while in the previous approach everything is added by default.
                 </p>
                 <h4 class="graf--h3">
                  Using CMake
                 </h4>
                 <p class="graf--p">
                  Apart from using the
                  <i class="graf--italic">
                   Native C++ template
                  </i>
                  , we can use the
                  <b class="graf--bold">
                   CMake
                  </b>
                  to secure the API keys i.e we can add the files manually to our project.
                 </p>
                 <blockquote class="graf--blockquote">
                  CMake is used to control the software compilation process using simple platform and compiler independent configuration files, and generate native makefiles and workspaces that can be used in the compiler environment of your choice.
                 </blockquote>
                 <p class="graf--p">
                  For more information on CMake, you can visit its
                  <a class="markup--anchor" href="https://cmake.org/" target="_blank">
                   official website
                  </a>
                  .
                 </p>
                 <p class="graf--p">
                  Following are steps that can be followed to secure API keys using CMake:
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step1:
                  </b>
                  Install the required tools that are mentioned in the prerequisite part of this blog.
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step2:
                  </b>
                  Under the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    app/src/main
                   </i>
                  </b>
                  directory, create a directory named
                  <b class="graf--bold">
                   <i class="graf--italic">
                    cpp
                   </i>
                  </b>
                  .
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step3:
                  </b>
                  In the cpp directory, create a native file where you want to store your API keys. So, create a file named
                  <b class="graf--bold">
                   <i class="graf--italic">
                    api-keys.cpp
                   </i>
                  </b>
                  and add the below code:
                 </p>
                 <pre><code class="language-java graf graf--code">#include &lt;jni.h&gt;
#include &lt;string&gt;

extern "C" JNIEXPORT jstring JNICALL
Java_com_mindorks_myapplication_APIKeyLibrary_getAPIKey(JNIEnv* env, jobject /* this */) {
    std::string api_key = "YOUR_AWESOME_API_KEY_GOES_HERE";
    return env-&gt;NewStringUTF(api_key.c_str());
}</code></pre>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step4:
                  </b>
                  In your
                  <b class="graf--bold">
                   <i class="graf--italic">
                    app/
                   </i>
                  </b>
                  directory, you need to add one text file named
                  <b class="graf--bold">
                   <i class="graf--italic">
                    CMakeLists.txt
                   </i>
                  </b>
                  file. It is a CMake build script. Add the below content into it:
                 </p>
                 <pre><code class="language-java graf graf--code"># For more information about using CMake with Android Studio, read the
# documentation: https://d.android.com/studio/projects/add-native-code.html

# Sets the minimum version of CMake required to build the native library.

cmake_minimum_required(VERSION 3.4.1)

# Creates and names a library, sets it as either STATIC
# or SHARED, and provides the relative paths to its source code.
# You can define multiple libraries, and CMake builds them for you.
# Gradle automatically packages shared libraries with your APK.

add_library( # Sets the name of the library.
api-keys

# Sets the library as a shared library.
        SHARED

# Provides a relative path to your source file(s).
src/main/cpp/api-keys.cpp )

# Searches for a specified prebuilt library and stores the path as a
# variable. Because CMake includes system libraries in the search path by
# default, you only need to specify the name of the public NDK library
# you want to add. CMake verifies that the library exists before
# completing its build.

find_library( # Sets the name of the path variable.
log-lib

# Specifies the name of the NDK library that
# you want CMake to locate.
        log )

# Specifies libraries CMake should link to your target library. You
# can link multiple libraries, such as libraries you define in this
# build script, prebuilt third-party libraries, or system libraries.

target_link_libraries( # Specifies the target library.
native-lib

# Links the target library to the log library
# included in the NDK.
        ${log-lib} )</code></pre>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step5:
                  </b>
                  Now, you have to specify the path of your CMakeLists file in the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    build.gradle
                   </i>
                  </b>
                  file. So, add the below code in
                  <b class="graf--bold">
                   <i class="graf--italic">
                    build.gradle
                   </i>
                  </b>
                  file:
                 </p>
                 <pre><code class="language-java graf graf--code">android {
    ...
    defaultConfig {
        ...
    }
    buildTypes {
        ...
    }
    externalNativeBuild {
        cmake {
            path 'CMakeLists.txt'
        }
    }
}</code></pre>
                 <p class="graf--p">
                  Now, to access the API keys from your Activity or file, you can follow the same steps(
                  <i class="graf--italic">
                   Steps 5, 6, and 7
                  </i>
                  ) as followed in the previous approach i.e. the Native C++ template approach.
                 </p>
                 <p class="graf--p">
                  If your Android Studio version doesn’t have the support of CMake then also you can use the NDK to secure your API keys. Here, you can use the ndk-build process. Let’s see how to do this.
                 </p>
                 <h4 class="graf--h3">
                  Using ndk-build
                 </h4>
                 <p class="graf--p">
                  To compile the native code present in the project, Android Studio supports the
                  <i class="graf--italic">
                   ndk-build
                  </i>
                  . Here, you will be having an
                  <i class="graf--italic">
                   <b class="graf--bold">
                    Android.mk
                   </b>
                  </i>
                  build file that is used by
                  <i class="graf--italic">
                   ndk-build
                  </i>
                  .
                 </p>
                 <p class="graf--p">
                  The
                  <i class="graf--italic">
                   Android.mk
                  </i>
                  file is present inside the
                  <i class="graf--italic">
                   <b class="graf--bold">
                    jni/
                   </b>
                  </i>
                  directory. It describes your sources and shared libraries to the build system. The basic purpose of the
                  <i class="graf--italic">
                   Android.mk
                  </i>
                  file is to define project-wide settings that are not defined by the build system or by Application.mk or by environment variables. Also, the syntax of the
                  <i class="graf--italic">
                   Android.mk
                  </i>
                  file allows you to group your sources into modules.
                 </p>
                 <p class="graf--p">
                  Follow the below steps to use ndk-build:
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step1:
                  </b>
                  Under the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    app/src/main
                   </i>
                  </b>
                  directory, create a directory named
                  <b class="graf--bold">
                   jni
                  </b>
                  . Here we will be having our
                  <i class="graf--italic">
                   .mk
                  </i>
                  files and the native code file.
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step2:
                  </b>
                  In the
                  <b class="graf--bold">
                   jni
                  </b>
                  directory that you have created in the previous step, add one file named
                  <i class="graf--italic">
                   Android.mk
                  </i>
                  and add the below lines of code to it:
                 </p>
                 <pre><code class="language-java graf graf--code">LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE    := api-keys
LOCAL_SRC_FILES := api-keys.c

include $(BUILD_SHARED_LIBRARY)</code></pre>
                 <p class="graf--p">
                  Following is the description of the above code:
                 </p>
                 <ul>
                  <li>
                   The LOCAL_PATH variable indicates the location of the source file.
                   <b class="graf--bold">
                    <i class="graf--italic">
                     my-dir
                    </i>
                   </b>
                   is a macro function provided by the build system to return the current directory.
                  </li>
                  <li>
                   The CLEAR_VARS is used to clear many LOCAL_XXX variables for you like LOCAL_MODULE, LOCAL_SRC_FILES, etc. It doesn’t clear LOCAL_PATH.
                  </li>
                  <li>
                   The LOCAL_MODULE variable stores the name of the module that you want to build. The module name must be unique and you shouldn’t use any space in the module name.
                  </li>
                  <li>
                   The LOCAL_SRC_FILES variable contains a list of C or C++ files that are present in the module.
                  </li>
                  <li>
                   The BUILD_SHARED_LIBRARY variable is used to tie everything together. It determines what to build, and how to do it. It collects the information that you defined in LOCAL_XXX variables since the most recent
                   <b class="graf--bold">
                    include
                   </b>
                   .
                  </li>
                 </ul>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step3:
                  </b>
                  In the
                  <b class="graf--bold">
                   jni
                  </b>
                  directory, create another file named
                  <b class="graf--bold">
                   <i class="graf--italic">
                    Application.mk
                   </i>
                  </b>
                  file and add the below code:
                 </p>
                 <pre><code class="language-java graf graf--code">APP_ABI := all</code></pre>
                 <p class="graf--p">
                  The
                  <i class="graf--italic">
                   Application.mk
                  </i>
                  file is used to specify the project-wide settings for the ndk-build.
                 </p>
                 <p class="graf--p">
                  The variable APP_ABI is used to specify the ABIs whose code should be generated by the build system. By default, the build system generates the code for all non-deprecated ABIs.
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step4:
                  </b>
                  The last file to be added in the
                  <b class="graf--bold">
                   <i class="graf--italic">
                    jni
                   </i>
                  </b>
                  directory is your native code file. So, in the jni directory, add one file named
                  <b class="graf--bold">
                   <i class="graf--italic">
                    api-keys.c
                   </i>
                  </b>
                  and add the below code into it:
                 </p>
                 <pre><code class="language-java graf graf--code">#include &lt;jni.h&gt;

//For first API key
JNIEXPORT jstring JNICALL
Java_com_mindorks_myapplication_APIKeyLibrary_getAPIKey(JNIEnv *env, jobject instance) {

    return (*env)-&gt;  NewStringUTF(env, "YOUR_AWESOME_API_GOES_HERE");

}</code></pre>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Step5:
                  </b>
                  After adding the required files in your
                  <b class="graf--bold">
                   <i class="graf--italic">
                    jni
                   </i>
                  </b>
                  directory, our next aim is to provide the path of our
                  <i class="graf--italic">
                   Android.mk
                  </i>
                  file in the
                  <i class="graf--italic">
                   build.gradle
                  </i>
                  file.
                 </p>
                 <pre><code class="language-java graf graf--code">android {
    ...
    defaultConfig {
        ...
    }
    buildTypes {
        ...
    }
    externalNativeBuild {
        ndkBuild {
            path 'src/main/jni/Android.mk'
        }
    }
}</code></pre>
                 <p class="graf--p">
                  Now, to access the API keys from your Activity or file, you can follow the same steps(
                  <i class="graf--italic">
                   Steps 5, 6, and 7
                  </i>
                  ) as followed in the previous approach i.e. the Native C++ template approach.
                 </p>
                 <h4 class="graf--h3">
                  Closing Note
                 </h4>
                 <p class="graf--p">
                  In this blog, we learned how to secure our API keys with the help of the Android Native Development Kit. We saw three methods of doing so i.e. the ndk-build method, the CMake method and the easiest one i.e. using the native c++ template in our project.
                 </p>
                 <p class="graf--p">
                  Hope you learned something new today.
                 </p>
                 <p class="graf--p">
                  Do share this blog with your fellow developers to spread the knowledge. You can read more blogs on Android on our
                  <a class="markup--anchor" href="https://blog.mindorks.com/" target="_blank">
                   blogging website
                  </a>
                  .
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   <a class="markup--anchor" href="https://bootcamp.mindorks.com/" target="_blank">
                    Apply Now: MindOrks Android Online Course and Learn Advanced Android
                   </a>
                  </b>
                 </p>
                 <p class="graf--p">
                  Happy Learning :)
                 </p>
                 <p class="graf--p">
                  <b class="graf--bold">
                   Team MindOrks!
                  </b>
                 </p>
                </div>
               </div>
              </div>
             </section>
            </div>
           </div>
          </div>
         </article>
        </div>
       </div>
       <div class="ui divider">
       </div>
      </div>
      <div class="stretched fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui large center aligned header" style="padding-top:20px">
        Recommended for You
       </div>
      </div>
      <div class="fourteen wide computer fifteen wide mobile fifteen wide tablet column">
       <div class="ui centered grid">
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card">
          <img alt="Using local.properties file to avoid API Keys check-in into Version Control System" class="ui centered image" src="/images/using-localproperties-banner-image.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Using local.properties file to avoid API Keys check-in into Version Control System
           </div>
           <div class="meta">
            3rd April 2020
           </div>
           <div class="description">
            This blog describes how to use the local.properties file in the Android Gradle system to avoid local or user-specific information such as API keys to be checked into the Version Control System.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card">
          <img alt="Navigate between pages in a React Native App" class="ui centered image" src="/images/react-navigation-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Navigate between pages in a React Native App
           </div>
           <div class="meta">
            21st April 2020
           </div>
           <div class="description">
            In this blog, we are going to learn how can we navigate inside a react native application and how navigation works. We will learn how to implement the navigation in our app.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card">
          <img alt="Getting started with Android NDK: Android Tutorial" class="ui centered image" src="/images/getting-started-with-android-ndk-android-tutorial-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Getting started with Android NDK: Android Tutorial
           </div>
           <div class="meta">
            9th October 2019
           </div>
           <div class="description">
            In this blog, we will learn how to use Android NDK. We will learn the use of native codes i.e. C and C++ in Android development. So, let's learn about Android development in a native way.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card">
          <img alt="Using Fused Location API To Fetch Current Location" class="ui centered image" src="/images/using-gps-location-manager-in-android-android-tutorial-banner.jpg" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Using Fused Location API To Fetch Current Location
           </div>
           <div class="meta">
            7th June 2019
           </div>
           <div class="description">
            In this blog, we will learn how to update the location using the GPS of a mobile device. We will perform an example to check the current location of the user.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card">
          <img alt="Color Palette API in Android" class="ui centered image" src="/images/color-pallete-api.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Color Palette API in Android
           </div>
           <div class="meta">
            24th July 2019
           </div>
           <div class="description">
            In this blog, we will learn about the Color Palette API in Android. Here we will see how can we generate dynamic colors based on an image.
           </div>
          </div>
         </a>
        </div>
        <div class="stretched five wide computer sixteen wide mobile eight wide tablet column">
         <a class="ui fluid card">
          <img alt="Easy SMS Verification in Android: SMS User Consent API" class="ui centered image" src="/images/easy-sms-verification-android-sms-user-consent-api-banner.png" style="max-height:300px"/>
          <div class="content">
           <div class="header">
            Easy SMS Verification in Android: SMS User Consent API
           </div>
           <div class="meta">
            9th August 2019
           </div>
           <div class="description">
            In this blog, we will learn how to implement SMS verification using the SMS User Consent API in Android. This API is used to read only the message containing the verification code and will automatically extract the code from the message by taking permission from the user with the help of a prompt.
           </div>
          </div>
         </a>
        </div>
       </div>
      </div>
     </div>
    </div>
    <div style="background:#fff">
     <footer class="content-container">
      <div class="ui centered padded grid" style="padding-top:40px;background:linear-gradient(to right,#c4e0e0,#e5f1f1)">
       <h2 class="ui huge icon center aligned header">
        <div class="content">
         Connect With Your Mentors
        </div>
       </h2>
       <div class="centered row">
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Janishar Ali" class="ui medium circular image" src="/assets/ali.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://janisharali.com" target="_blank">
             Janishar Ali
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://janisharali.com" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/janisharali" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
        <div class="five wide computer sixteen wide mobile eight wide tablet column">
         <div class="ui centered padded one column grid">
          <div class="ui centered grid">
           <div class="column">
            <div class="ui circular segment" style="width:175px;height:175px;padding:0">
             <img alt="Amit Shekhar" class="ui medium circular image" src="/assets/amit.jpg"/>
            </div>
           </div>
          </div>
          <div class="column">
           <div class="ui large center aligned header">
            <a class="content" href="https://amitshekhar.me" target="_blank">
             Amit Shekhar
             <div class="sub header" style="padding:5px;color:#000">
              Founder | IIT-BHU | 10 Yrs Exp.
             </div>
            </a>
           </div>
          </div>
          <div class="ui centered grid">
           <div class="column">
            <a class="ui black huge circular icon button" href="https://amitshekhar.me" role="button" target="_blank">
             <i aria-hidden="true" class="linkify icon">
             </i>
            </a>
            <a class="ui twitter huge circular icon button" href="https://twitter.com/amitiitbhu" role="button" target="_blank">
             <i aria-hidden="true" class="twitter icon">
             </i>
            </a>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div class="ui divider" style="margin:unset">
      </div>
      <h5 class="ui header" style="padding:16px;margin:unset;color:#555">
       <i aria-hidden="true" class="copyright icon">
       </i>
       <div class="content">
        Copyright 2022, MindOrks Nextgen Private Limited
       </div>
      </h5>
     </footer>
    </div>
   </div>
  </div>
  <script type="text/javascript">
   window.hljs.initHighlightingOnLoad()
  </script>
 </body>
</html>